/*!
 * ParamQuery Pro v8.4.0
 * 
 * Copyright (c) 2012-2022 Paramvir Dhindsa (http://paramquery.com)
 * Released under Commercial license
 * http://paramquery.com/pro/license
 * 
*/ var t,jQuery,pq,JSZip,is_japanese=!1;window.addEventListener("keydown",e=>{is_japanese=!!e.isComposing||"Process"===e.key||229===e.keyCode}),"function"==typeof require?(jQuery=require("jquery-ui-pack"),pq={},JSZip=require("jszip"),module.exports=pq):(jQuery=window.jQuery,pq=window.pq=window.pq||{},JSZip=window.JSZip),(pq.mixin={render:{getRenderVal:function(e,n,i){var r=e.column,o=r.exportRender;return(n&&!1!==o||o)&&(r.render||r._render||r.format||r._renderG)?i.renderCell(e):[e.rowData[e.dataIndx],""]},getTitle:function(e,n){var i=e.title;return null!=i?"function"==typeof i&&(i=i.call(this.that,{colIndx:n,column:e,dataIndx:e.dataIndx,Export:!0})):i="",i}}}).GrpTree={buildCache:function(){for(var e,n,i=this,r=i.that.options,o=i.isTree,a=o?r.dataModel.data:i.that.pdata,l=i.cache={},s=i.id,d=0,c=a.length;d<c;d++)if(e=a[d],o||e.pq_gtitle){if(null==(n=e[s]))throw"unknown id of row";l[n]=e}},cascadeInit:function(){if(this.getCascadeInit()){for(var e,n=this,i=[],r=n.cbId,o=n.that,a=n.Model.select,l=o.pdata,s=0,d=l.length;s<d;s++)(e=l[s])[r]?n.isEditable(e)?(i.push(e),delete e[r]):a&&(e.pq_rowselect=!0):null===e[r]&&delete e[r];i.length&&n.checkNodes(i,null,null,!0)}},cascadeNest:function(e){for(var n,i,r,o=this,a=o.cbId,l=o.prop,s=o.childstr,d=e.length,c=0;c<d;c++)(i=e[c])[l]&&(n=!0,o.eachChild(i,o.chkEachChild(a,i[a],l)),delete i[l]),(r=i[s])&&r.length&&o.cascadeNest(r);n&&o.hasParent(i)&&o.eachParent(i,o.chkEachParent(a))},checkAll:function(e,n){var i=this.that;return this.checkNodes(i.pdata,e=null==e||e,n,null,!0)},checkNodes:function(e,n,i,r,o){for(var a,l,s,d=0,c=e.length,u=[],h={check:n=null==n||n},f=this,p=f.that,g=p.riOffset,m=f.cbId,v=f.prop,$=f.Model,x=!o&&f.isCascade($),o=r&&$.eventForInit||!r,$=$.select;d<c;d++)a=e[d],this.isEditable(a)&&(l=a.pq_ri,u.push({rowData:a,rowIndx:l,rowIndxPage:l-g}));if(h.rows=u,h.dataIndx=f.colUI.dataIndx,r&&(h.init=r),!1!==(s=o?p._trigger("beforeCheck",i,h):s)&&(c=(u=h.rows).length)){for(var w=this.chkRows=[],d=0;d<c;d++)a=u[d].rowData,x&&(a[v]=!0),w.push({rd:a,val:n,oldVal:a[m]}),a[m]=n;x&&f.cascadeNest(f.getRoots()),$&&this.selectRows(),x&&(h.getCascadeList=f.getCascadeList(f)),o&&p._trigger("check",i,h),w.length=0}f.setValCBox(),r||p.refresh({header:!1})},chkEachChild:function(e,n,i){return function(r){var o;!this.isEditable(r)||i&&r[i]||(o=r[e],null!==n&&o!==n&&(this.chkRows.push({rd:r,val:n,oldVal:o}),r[e]=n))}},chkEachParent:function(e){var n=this.childstr;return function(i){if(this.isEditable(i)){for(var r,o,a=i[n],l=0,s=0,d=i[e],c=0,u=a.length;c<u;c++)if(o=a[c],this.isEditable(o)){if(o=o[e])l++;else{if(null===o){r=null;break}s++}if(l&&s){r=null;break}}d!==(r=void 0===r?!!l:r)&&(this.chkRows.push({rd:i,val:r,oldVal:d}),i[e]=r)}}},eachChild:function(e,n,i){n.call(this,e,i);for(var r,o=this.childstr,a=e[o]||[],l=0,s=a.length;l<s;l++)(r=a[l])[o]?this.eachChild(r,n,e):n.call(this,r,e)},eachParent:function(e,n){for(;e=this.getParent(e);)n.call(this,e)},_flatten:function(e,n,i,r){for(var o,a,l=e.length,s=this.id,d=this.parentId,c=0,u=this.childstr;c<l;c++)(o=e[c]).pq_level=i,r.push(o),n&&(o[d]=s?n[s]:n),(a=o[u])&&this._flatten(a,o,i+1,r)},flatten:function(e){var n=[];return this._flatten(e,null,0,n),n},getUniqueNodes:function(e){var n=[],i={},r=this.parentId,o=this.id;return e.forEach(function(e){null!=e[o]&&(i[e[o]]=1)}),e.forEach(function(e){i[e[r]]||n.push(e)}),n},getCascadeInit:function(){var e=this._cascadeInit;return this._cascadeInit=!0,e},getNode:function(e){return this.cache[e]},getParent:function(e){return e=e[this.parentId],this.cache[e]},fillState:function(e){var n,i,r=this.childstr,o=this.cache;for(n in o)(i=o[n])[r]&&(e[n]=i.pq_close||!1);return e},hasParent:function(e){return null!=e[this.parentId]},getRoots:function(e){for(var n,i=this.that,r=e||i.pdata||[],o=r.length,a=0,l=[];a<o;a++)0!==(n=r[a]).pq_level||n.pq_gsummary||l.push(n);return o&&!l.length?r:l},setCascadeInit:function(e){this._cascadeInit=e},getCascadeList:function(e){var n=[];return function(){if(!n.length)for(var i=e.chkRows,r=0,o=e.cbId,a=i.length;r<a;r++){var l=i[r],s=l.rd,d=s.pq_ri,c={},u={};c[o]=l.val,u[o]=l.oldVal,n.push({rowIndx:d,rowData:s,newRow:c,oldRow:u})}return n}},getChildren:function(e){return(e?e[this.childstr]:this.getRoots())||[]},getChildrenAll:function(e,n){for(var i,r=this.childstr,o=e[r]||[],a=o.length,l=0,s=n||[];l<a;l++)i=o[l],s.push(i),i[r]&&this.getChildrenAll(i,s);return s},getSummary:function(e){return e.pq_child_sum},isAncestor:function(e,n){for(var i=e;i=this.getParent(i);)if(i==n)return!0},isEmpty:function(e){return!(e[this.childstr]||[]).length},isCascade:function(e){return e.cascade&&e.checkbox&&!e.maxCheck},isEditable:function(e){if(e.pq_gsummary)return!1;var n=this.that,i=this.colCB;return!i||!(i=i.editable)||("function"==typeof i?i.call(n,{rowData:e}):i)},isFolder:function(e){return null!=e.pq_close||!!e[this.childstr]},onCheckbox:function(e,n){return function(i,r){n.checkbox&&e.colUI==r.column&&e.checkNodes([r.rowData],r.input.checked,i)}},onCMInit:function(){var e,n,i=this,r=i.that,o=r.columns,a=i.isTree,r=r.colModel,l=i.Model;l.titleInFirstCol&&r&&(r=r.find(function(e){return!e.hidden}),l.titleIndx=r.dataIndx=(null==r.dataIndx?Math.random():r.dataIndx).toString()),l.checkbox&&o&&((n=o[l.cbId]||{dataIndx:l.cbId}).cb={check:!0,uncheck:!1,select:l.select,header:l.checkboxHead,maxCheck:l.maxCheck},e=a?o[l.dataIndx]:o[l.titleIndx]),i.colCB=n,i.colUI=e,o&&a&&i.setCellRender()},onCustomSortTree:function(e,n){var i=this.getRoots(n.data);return this.sort(i,n.sort_composite),n.data=this.flatten(i),!1},onRefresh:function(e,n){return function(){if(n.checkbox)for(var e=this.$cont.find(".pq_indeter"),i=e.length;i--;)e[i].indeterminate=!0}},refreshView:function(e){this.that.refreshView({header:!1,source:e})},renderCB:function(e,n,i){if(n.pq_gsummary)return"";var r,o=this.that,a="",l="",s="";return(e="function"==typeof e?e.call(o,n):e)?(n[i]&&(a="checked"),this.isEditable(n)||(l="disabled",r="pq_disable"),["<input type='checkbox' "+(s=null===n[i]?"class='pq_indeter'":s)+" "+a+" "+l+"/>",r]):void 0},selectRows:function(){for(var e=0,n=this.chkRows,i=n.length;e<i;e++){var r=n[e],o=r.rd,r=r.val;o.pq_rowselect=r}},sort:function(e,n){function i(e){return"function"==typeof n?n:n[e]}var r=this.childstr;!function e(n,o){var a,l=n.length,s=0;if(l)for(o&&n.sort(o),o=i(n[0].pq_level+1);s<l;s++)(a=n[s][r])&&e(a,o)}(e,i(0))},copyArray:function(e,n){for(var i=0,r=n.length;i<r;i++)e.push(n[i])},_summaryT:function(e,n,i,r,o,a,l){for(var s,d,c,u,h,f=this,p=f.childstr,g=f.isGroup,m=f.isTree,v=a.summaryInTitleRow,$=a.showSummary,x=!a.skipSingleSummary,w=a.titleIndx,y=0,C=e.length,_=0,b={},I={},q=f.id,R=f.parentId,D=g&&l?a.dataIndx[l.pq_level]:"",M=[],T=i.length,k=pq.aggregate;_<T;_++)b[h=i[_]]=[];for(;y<C;y++){if(d=e[y],n.push(d),c=d[p]){for(s=f._summaryT(c,n,i,r,o,a,d),_=0;_<T;_++)h=i[_],f.copyArray(b[h],s[1][h]);f.copyArray(M,s[2])}if(m&&(!v||!f.isFolder(d))||g&&!d.pq_gtitle){for(_=0;_<T;_++)b[h=i[_]].push(d[h]);M.push(d)}}for(I.pq_level=l?l.pq_level:0,a.grandSummary&&(I.pq_grandsummary=!0),l&&(m&&!v||g&&$[l.pq_level])&&(I[R]=l[q],(x||1<C)&&n.push(I),(l.pq_child_sum=I).pq_hidden=l.pq_close),_=0;_<T;_++)h=i[_],u=(u=r[_])[D]||u.type,I[h]=k[u](b[h],o[_],M,I),v&&l&&h!=w&&(l[h]=I[h]);return I.pq_gsummary=!0,[I,b,M]},summaryT:function(){for(var e,n,i=this,r=i.that,o=r.options,a=i.Model,l=i.getRoots(),s=[],d=[],c=[],u=[],h=0,f=r.colModel,p=f.length;h<p;h++)(n=(e=f[h]).summary)&&n.type&&(c.push(e.dataIndx),u.push(e),d.push(n));l=i._summaryT(l,s,c,d,u,a)[0],a.grandSummary?i.summaryData=o.summaryData=[l]:(i.summaryData||[]).length=0,r.pdata=s}},function(e){var n=pq.mixin,i=!0;e(document).one("pq:ready",function(){var n=e("<input type='checkbox' style='position:fixed;left:-50px;top:-50px;'/>").appendTo(document.body);n[0].indeterminate=!0,n.on("change",function(){i=!1}),n.click(),n.remove()}),n.ChkGrpTree={onCellKeyDown:function(e,n){if(n.dataIndx==this.colUI.dataIndx&&32==e.keyCode)return this.that.getCell(n).find("input").click(),!1},getCheckedNodes:function(e){var n,i=this.that,r=e?i.getData():i.options.dataModel.data,o=r.length,a=0,l=[],e=this.colCB||{},s=(e.cb||{}).check,d=e.dataIndx;if(null!=d)for(;a<o;a++)(n=r[a])[d]===s&&l.push(n);return l},hasCboxHead:function(){return((this.colCB||{}).cb||{}).header},isHeadChecked:function(){return this.inpVal},onBeforeCheck:function(e,n){var i,r,o,a,l,s,d;n.check&&this.colCB&&(r=(i=(s=this.colCB).cb).select,(o=i.maxCheck)&&this.colUI.dataIndx==n.dataIndx&&(d=(a=n.rows.slice(0,o)).length,l=s.dataIndx,0<(d=d+(s=this.getCheckedNodes(!0)).length-o)&&s.slice(0,d).forEach(function(e){e[l]=i.uncheck,r&&delete e.pq_rowselect}),n.rows=a))},onHeaderChange:function(e){!1===this.checkAll(e.target.checked,e)&&this.refreshHeadVal()},onRefreshHeader:function(){var e,n=this,r=n.that;n.hasCboxHead()&&("groupModel"!=n.model||r.options[n.model].on)&&((e=(r=r.getCellHeader({dataIndx:n.colUI.dataIndx})).find("input")).length||(r.find(".pq-title-span").prepend('<input type="checkbox" />'),e=r.find("input")),n.$inp&&e[0]==n.$inp[0]||(n.$inp=e,n.refreshHeadVal(),i&&e.on("click",function(i){null==e.data("pq_value")&&(e[0].checked=!0,e.data("pq_value",!0),n.onHeaderChange(i))}),e.on("change",function(e){n.onHeaderChange(e)})))},refreshHeadVal:function(){this.$inp&&this.$inp.pqval({val:this.inpVal})},setValCBox:function(){if(this.hasCboxHead()){var e,n=this.that,i=n.options,r=this.colCB,o=r.dataIndx,a=n.colIndxs[o],l=r.cb,s=l.all,d="remote"!=i.pageModel.type&&s?0:n.riOffset,c=s?i.dataModel.data:n.pdata,s=null,u=0,h=0,f=0;if(c){for(var p=0,g=c.length;p<g;p++)(e=c[p]).pq_gsummary||e.pq_gtitle||!this.isEditable(e,r,p+d,a,o)||(h++,e[o]===l.check?u++:f++);u==h&&h?s=!0:f==h&&(s=!1),this.inpVal=s,this.refreshHeadVal()}}},unCheckAll:function(){this.checkAll(!1)},unCheckNodes:function(e,n){this.checkNodes(e,!1,n)}}}(jQuery),function(e){function n(e,n,i,r){for(var o=n.slice(),a=0,l=o.length,s=[];a<l;a++){var d=o[a],c=d.cb,u=d.one;if(u){if(d._oncerun)continue;d._oncerun=!0}if(!1===c.call(e,i,r)&&(i.preventDefault(),i.stopPropagation()),u&&s.push(a),i.isImmediatePropagationStopped())break}if(l=s.length)for(a=l-1;0<=a;a--)o.splice(s[a],1)}var i=e.paramquery=e.paramquery||{},i=(i._trigger=function(i,r,o){var a,l,s=this,d=s.listeners,c=d[i],u=s.options,h=u.allEvents,f=u.bubble,p=s.element,g=u[i];if(o=o||{},(r=e.Event(r)).type=s.widgetName+":"+i,r.target=p[0],l=r.originalEvent)for(a in l)a in r||(r[a]=l[a]);return h&&"function"==typeof h&&h.call(s,r,o),c&&c.length&&(n(s,c,r,o),r.isImmediatePropagationStopped())||u.trigger&&(p[f?"trigger":"triggerHandler"](r,o),r.isImmediatePropagationStopped())||(g&&!1===g.call(s,r,o)&&(r.preventDefault(),r.stopPropagation()),(c=d[i+"Done"])&&c.length&&n(s,c,r,o)),!r.isDefaultPrevented()},i.on=function(){for(var e,n,i,r,o,a,l,s,d=arguments,c=(r="boolean"==typeof d[0]?(e=d[0],n=d[1],i=d[2],d[3]):(n=d[0],i=d[1],d[2]),n.split(" ")),u=0;u<c.length;u++){var h=c[u];h&&(a=i,l=r,s=e,((o=this).listeners[h]||(o.listeners[h]=[]))[s?"unshift":"push"]({cb:a,one:l}))}return this},i.one=function(){for(var e=arguments.length,n=[],i=0;i<e;i++)n[i]=arguments[i];return n[e]=!0,this.on.apply(this,n)},i.off=function(e,n){for(var i=e.split(" "),r=0;r<i.length;r++){var o=i[r];if(o){u=c=d=s=void 0;var a=this,l=n;if(l){var s=a.listeners[o];if(s){for(var d=[],c=0,u=s.length;c<u;c++)l==s[c].cb&&d.push(c);if(d.length)for(c=d.length-1;0<=c;c--)s.splice(d[c],1)}}else delete a.listeners[o]}}return this},{options:{items:".pq-grid-cell.pq-has-tooltip,.pq-grid-cell[title]",position:{my:"center top",at:"center bottom"},content:function(){var n=e(this),i=n.closest(".pq-grid").pqGrid("instance"),r=i.getCellIndices({$td:n}),o=r.rowIndx,r=r.dataIndx,i=i.data({rowIndx:o,dataIndx:r,data:"pq_valid"}).data;return i?(""==(o=i.icon)?"":"<span class='ui-icon "+o+" pq-tooltip-icon'></span>")+(r=null!=(r=i.msg)?r:""):n.attr("title")}}});i._create=function(){this._super();var n=this.element,i=this.eventNamespace;n.on("pqtooltipopen"+i,function(n,i){var r,o,a=e(n.target),n=e(n.originalEvent.target);n.on("remove.pqtt",function(e){a.pqTooltip("close",e,!0)}),a.is(".pq-grid")&&(o=(n=(r=a.pqGrid("instance")).getCellIndices({$td:n})).rowIndx,n=n.dataIndx,(r=r.getRowData({rowIndx:o}))&&(r=r.pq_celldata)&&(r=r[n])&&(r=r.pq_valid)&&(n=(o=r).style,r=o.cls,i.tooltip.addClass(r),o=i.tooltip.attr("style"),i.tooltip.attr("style",o+";"+n)))}),n.on("pqtooltipclose"+i,function(n,i){e(n.target),e(n.originalEvent.target).off(".pqtt")})},e.widget("paramquery.pqTooltip",e.ui.tooltip,i)}(jQuery),function(e){var n,i,r,o,a,l,s,d,c,u,h,f=e.paramquery,p=Array.prototype,g=(p.find||(p.find=function(e,n){for(var i,r=0,o=this.length;r<o;r++)if(i=this[r],e.call(n,i,r,this))return i}),p.findIndex||(p.findIndex=function(e,n){for(var i,r=0,o=this.length;r<o;r++)if(i=this[r],e.call(n,i,r,this))return r;return -1}),e.extend(pq,{arrayUnique:function(e,n){for(var i,r,o=[],a=e.length,l={},s=0;s<a;s++)i=e[s],1!=l[r=n?i[n]:i]&&(l[r]=1,o.push(i));return o},cap1:function(e){return e&&e.length?e[0].toUpperCase()+e.slice(1):""},elementFromXY:function(n){var i,r=n.clientX,n=n.clientY,o=e(document.elementFromPoint(r,n));return o.closest(".ui-draggable-dragging").length&&((i=o).hide(),o=e(document.elementFromPoint(r,n)),i.show()),o},getFocusEle:function(n){var i=["a","textarea","button","input","select","[tabindex]"].map(function(e){return e+':not([disabled],[tabindex="-1"])'}).join(","),r=document.activeElement;if(r){var i=[].filter.call(e(i),function(e){return 0<e.offsetWidth||0<e.offsetHeight||e==r}),o=i.indexOf(r);if(-1<(o=-1==o?i.indexOf(e(r).closest("[tabindex=0]")[0]):o))return n?i[o-1]:i[o+1]}},focusEle:function(e){return(e=this.getFocusEle(e))&&e.focus(),e},escapeHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},excelToJui:(s={},function(e){var n=s[e];return n||(n=e.replace(/yy/g,"y").replace(/dddd/g,"DD").replace(/ddd/g,"D").replace(/mmmm/g,"MM").replace(/mmm/g,"M"),s[e]=n),n}),excelToNum:(l={},function(e){var n=l[e];return n||(n=e.replace(/\\/g,""),l[e]=n),n}),extend:function(e,n,i){function r(){}r.prototype=e.prototype;var o,a=n.prototype=new r,l=e.prototype;for(o in i){var s=l[o],d=i[o];a[o]=s?function(e,n){return function(){var i,r=this._super;return this._super=function(){return e.apply(this,arguments)},i=n.apply(this,arguments),this._super=r,i}}(s,d):d}a.constructor=n,a._base=e,a._bp=function(e){var n=arguments;return Array.prototype.shift.call(n),l[e].apply(this,n)}},copyObj:function(n,i,r){var o,a,l=pq.objectify(r);for(o in i)l[o]||(a=i[o],n[o]=e.isPlainObject(a)?e.extend(!0,{},a):a);return n},extendT:function(n,i){var r,o;for(r in i)void 0===n[r]&&((o=Object.getOwnPropertyDescriptor(i,r)).get||o.set?Object.defineProperty(n,r,o):(o=i[r],n[r]=o&&"object"==typeof o?e.extend(!0,{},o):o));return n},flatten:function(e,n){var i,r=0,o=e.length;for(n=n||[];r<o;r++)null!=(i=e[r])&&(i.push?pq.flatten(i,n):n.push(i));return n},toRC:function(e){var n,e=e.match(/([A-Z]*)(\d*)/),i=pq.toNumber(e[1]);return[n=e[2]?e[2]-1:n,i]},formatEx:function(e,n,i,r){return i&&(r=r||pq.getDataType(e),pq.filter.conditions[i][r])?this.format(e,n,r):n},format:function(n,i,r){var o=n.format;if(o&&null!=i){if("function"==typeof o)return o(i);if("date"==(r=r||pq.getDataType(n)))try{var a=new Date(i);a&&!isNaN(a.getTime())&&(i=e.datepicker.formatDate(o,a))}catch(l){}else i=pq.formatNumber(i,o)}return i},onResize:function(n,i){n.attachEvent?n.attachEvent("onresize",i):window.ResizeObserver?new window.ResizeObserver(i).observe(n):window.addResizeListener?window.addResizeListener(n,i):e(n).resize(i)},fileRead:function(e,n,i){var r=new FileReader;r[n](e),r.onload=function(){i(r.result)}},fileToBase:function(e,n){pq.fileRead(e,"readAsDataURL",n)},xmlhttp:function(e,n,i){var r=new XMLHttpRequest;r.onload=function(){i(r.response)},r.open("GET",e),r.responseType=n,r.send()},urlToBase:function(e,n){pq.xmlhttp(e,"blob",function(e){pq.fileToBase(e,n)})},objectAttr:function(e){e&&e.split(" ")},deFormat:function(n,i,r){if(i){var o,a,l=n.format;if(l&&(a=pq.getDataType(n),!r||pq.filter.conditions[r][a]))try{"function"==typeof l?i=n.deFormat(i):"date"==a?(o=n.formatRaw||"mm/dd/yy")!=l&&(i=e.datepicker.parseDate(l,i),i=e.datepicker.formatDate(o,i)):i=pq.deFormatNumber(i,l)}catch(s){i=null}}return i},fakeEvent:function(e,n,i){var r;"timeout"==n&&e.off(n="keyup change").on(n,function(){clearTimeout(r),r=setTimeout(function(){e.triggerHandler("timeout")},i)})},getAddress:function(e){var n,i,e=e.split(":"),r=this.toRC(e[0]),o=r[0],r=r[1],e=this.toRC(e[1]||e[0]),a=e[0],e=e[1];return{r1:o,c1:r,rc:n=isNaN(a)?n:a-o+1,cc:i=isNaN(e)?i:e-r+1,r2:a,c2:e}},getClsVal:function(e,n){return(e=e.match(RegExp("\\b"+n+"(\\S+)\\b")))?e[1]:null},getDataType:function(e){var n,e=e.dataType;return"bool"==e?n="bool":"float"==e||"integer"==e?n="number":"date"==e&&(n="date"),n||"string"},getFn:(a={},function(e){var n=e;return"string"!=typeof e||(n=a[e])||(n=window,e.split(".").forEach(function(e){n=n[e]}),a[e]=n),n}),isCtrl:function(e){return e.ctrlKey||e.metaKey},isDateFormat:(o={},function(e){var n=o[e];return null==n?o[e]=/^[mdy\s-\/\.,]*$/i.test(e):n}),isEmpty:function(e){for(var n in e)return!1;return!0},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},juiToExcel:(r={},function(e){var n=r[e];return n||(n=e.replace(/y/g,"yy").replace(/DD/g,"dddd").replace(/D/g,"ddd").replace(/MM/g,"mmmm").replace(/M/g,"mmm"),r[e]=n),n}),makePopup:function(n,i,r){function o(n){n&&s&&document.body.contains(i)?d.hide():(d.remove(),e(document).off(l),r&&r())}var a=(Math.random()+"").replace(".",""),l="mousedown.pq"+a+" keydown.pq"+a,a=i?(i.nodeName||"").toLowerCase():"",s="input"==a||"textarea"==a,d=e(n);d.addClass("pq-popup").on("keydown",function(n){n.keyCode==e.ui.keyCode.ESCAPE&&o(!0)}),e(i).one("remove",function(){o()}),requestAnimationFrame(function(){e(document).on(l,function(r){var a=e(r.target);n.contains(a[0])||pq.isCtrl(r)||a.closest(".ui-datepicker").length||a.closest(i).length||o(!0)})})},moveItem:function(e,n,i,r){return r<i?(n.splice(i,1),n.splice(r++,0,e)):i==r?r++:(n.splice(r,0,e),n.splice(i,1)),r},newLine:function(e){return isNaN(e)&&"string"==typeof e?e.replace(/(\r\n|\r|\n)/g,"<br>"):e},numToExcel:(i={},function(e){var n=i[e];return n||(n=e.replace(/[^#0,.@%]/g,function(e){return"\\"+e}),i[e]=n),n}),objectify:function(e){for(var n={},i=e.length;i--;)n[e[i]]=1;return n},styleObj:function(e){var n;return"string"==typeof e&&(n=e.split(";"),e={},n.forEach(function(i){i&&(n=i.split(":"))[0]&&n[1]&&(e[n[0].trim()]=n[1].trim())})),e},styleStr:function(e){if("string"!=typeof e){var n,i,r=[];for(n in e)(i=e[n])&&r.push(n+":"+i);e=r.length?r.join(";")+";":""}return e},escapeXml:function(e){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};return e&&(e+"").replace(/(&|\<|\>|"|')/g,function(e,i){return n[i]})},unescapeXml:(n={amp:"&",lt:"<",gt:">",quot:'"',apos:"'"},function(e){return e.replace(/&(amp|lt|gt|quot|apos);/g,function(e,i){return n[i]})})}),f.select=function(e){var n,i=e.attr,r=e.options,o=e.groupIndx,a=e.labelIndx,l=e.valueIndx,s=null!=a&&null!=l,d=null!=o,c=e.prepend,u=e.dataMap,h=["<select ",i," >"];if(c)for(var f in c)h.push('<option value="',f,'">',c[f],"</option>");if(r&&r.length){for(var p=0,g=r.length;p<g;p++){var m=r[p];if(s){var v,$,x,w=m[l],y=m.pq_disabled?'disabled="disabled" ':"",C=m.pq_selected?'selected="selected" ':"";null!=w&&(x=u?function(){for(var e={},n=0;n<u.length;n++){var i=u[n];e[i]=m[i]}return"data-map='"+JSON.stringify(e)+"'"}():"",d&&($=m.pq_disabled_group?'disabled="disabled" ':"",n!=(v=m[o])&&(null!=n&&h.push("</optgroup>"),h.push('<optgroup label="',v,'" ',$," >"),n=v)),a==l?h.push("<option ",C,y,x,">",w,"</option>"):($=m[a],h.push("<option ",C,y,x,' value="',w,'">',$,"</option>")))}else if("object"==typeof m)for(var f in m)h.push('<option value="',f,'">',m[f],"</option>");else h.push("<option>",m,"</option>")}d&&h.push("</optgroup>")}return h.push("</select>"),h.join("")},e.fn.pqval=function(e){var n;return e?e.incr?(n=this.data("pq_value"),this.prop("indeterminate",!1),n?this.prop("checked",n=!1):!1===n?(this.prop("indeterminate",(n=null,!0)),this.prop("checked",!1)):this.prop("checked",n=!0),this.data("pq_value",n),n):(n=e.val,this.data("pq_value",n),this.prop("indeterminate",!1),null===n?(this.prop("indeterminate",!0),this.prop("checked",!1)):n?this.prop("checked",!0):this.prop("checked",!1),this):this.data("pq_value")},f.xmlToArray=function(n,i){var r=i.itemParent,o=i.itemNames,a=[];return e(n).find(r).each(function(n,i){var r=e(i),l=[];e(o).each(function(e,n){l.push(r.find(n).text().replace(/\r|\n|\t/g,""))}),a.push(l)}),a},f.xmlToJson=function(n,i){var r=i.itemParent,o=i.itemNames,a=[];return e(n).find(r).each(function(n,i){for(var r=e(i),l={},s=0,d=o.length;s<d;s++){var c=o[s];l[c]=r.find(c).text().replace(/\r|\n|\t/g,"")}a.push(l)}),a},f.tableToArray=function(n){var n=e(n),i=[],r=[],n=n.children("tbody").children("tr"),o=n.length?e(n[0]):e(),a=1<n.length?e(n[1]):e();return o.children("th,td").each(function(n,r){var r=e(r),o="left",r={title:r.html(),width:r.width(),dataType:"string",align:o=a.length&&a.find("td:eq("+n+")").attr("align")||o,dataIndx:n};i.push(r)}),n.each(function(n,i){var o;0!=n&&(n=e(i),o=[],n.children("td").each(function(n,i){o.push(e.trim(e(i).html()))}),r.push(o))}),{data:r,colModel:i}},c={},function(e,n){var i;if(e){if(i=e.split(":"),i=c[e=n&&1<i.length?i[1]:i[0]])return i;d=d||/^([^#0]*|&#[^#0]*)?[\,\.#0]*?([\,\s\.]?)([#0]*)(([\,\s\.])([0]+))?([^#^0]*|&#[^#]*)?$/,(n=e.match(d))&&n.length&&(i={symbol:n[1]||"",thouSep:n[2],thousand:n[3].length,decSep:n[5]||"",decimal:(n[6]||[]).length,symbolEnd:n[7]||""},c[e]=i)}return i||{symbol:"",symbolEnd:"",thouSep:",",thousand:3,decSep:".",decimal:2}}),m=(f.formatCurrency=function(e,n){if(!n||"@"==n)return e+"";if(e=parseFloat(e),!isNaN(e)&&"Infinity"!=e){0<(n||"").indexOf("%")&&(e*=100);for(var i=e<0,n=g(n,i),r=n.symbol,o=n.symbolEnd,a=n.thousand,l=n.thouSep,s=n.decSep,n=n.decimal,d=(e=e.toFixed(n)).length,n=n+s.length,c=e.substring(0,d-n),e=e.substring(d-n+s.length,d),u=c.match(/\d/g).reverse(),h=[],f=0;f<u.length;f++)0<f&&f%a==0&&h.push(l),h.push(u[f]);return(i?"-":"")+r+(c=(h=h.reverse()).join(""))+s+e+o}},pq.formatNumber=f.formatCurrency,pq.deFormatNumber=function(e,n){var n=g(n,e<0),i=n.symbol,r=n.symbolEnd,o=n.thouSep,n=n.decSep,o="."===o?"\\.":o;return e=e.replace(i,"").replace(r,"").replace(RegExp(o,"g"),""),e=n?+e.replace(n,"."):e},pq.valid={isFloat:function(e){var n=+e;return!isNaN(n)&&n==e},isInt:function(e){var n=parseInt(e);return!isNaN(n)&&n==e},isDate:function(e){return!isNaN(Date.parse(e))}},[]),v={},$=pq.toLetter=function(e){var n,i,r=m[e];return r||(i=++e%26,n=e/26|0,i=i?String.fromCharCode(64+i):(--n,"Z"),r=n?$(n-1)+i:i,m[--e]=r,v[r]=e),r};function x(n){var i=n.rtl;return null==i?n.rtl="rtl"==e(n).css("direction"):i}pq.toNumber=function(e){var n,i,r=v[e];if(null==r&&e){for(n=e.length,r=-1,i=0;i<n;i++)r+=(e[i].charCodeAt(0)-64)*Math.pow(26,n-i-1);m[r]=e,v[e]=r}return r},pq.generateData=function(e,n){for(var i=[],r=0;r<n;r++)i[r]=$(r);for(var o=[],r=0;r<e;r++)for(var a=o[r]=[],l=0;l<n;l++)a[l]=i[l]+(r+1);return o},u="w",h="scrollLeft",e(document).one("pq:ready",function(){var n=e("<div dir='rtl' style='visibilty:hidden;height:4px;width:4px;overflow:auto;'>rtl</div>").appendTo("body"),i=n[0];0==i[h]&&(i[h]=100,u=0==i[h]?"g":"i"),n.remove()}),pq.scrollTop=function(e){return e.scrollTop},pq[h+"Val"]=function(e,n){return e=x(e)?"w"==u?e.scrollWidth-e.clientWidth-n:"g"==u?-1*n:n:n},pq[h]=function(e,n){var i,r=x(e);if(null==n){if(i=e[h],r){if("w"==u)return e.scrollWidth-e.clientWidth-i;if("g"==u)return -1*i}return i}e[h]=pq[h+"Val"](e,n)}}(jQuery),function(e){pq.validations={minLen:function(e,n,i){if(e=i(e),n=i(n),e.length>=n)return!0},nonEmpty:function(e){if(null!=e&&""!==e)return!0},maxLen:function(e,n,i){if(e=i(e),n=i(n),e.length<=n)return!0},gt:function(e,n,i){if(e=i(e),(n=i(n))<e)return!0},gte:function(e,n,i){if(e=i(e),(n=i(n))<=e)return!0},lt:function(e,n,i){if((e=i(e))<(n=i(n)))return!0},lte:function(e,n,i){if((e=i(e))<=(n=i(n)))return!0},neq:function(e,n,i){if((e=i(e))!==(n=i(n)))return!0},regexp:function(e,n){if(RegExp(n).test(e))return!0}};var n=e.paramquery;n.cValid=function(e){this.that=e},n.cValid.prototype={_isValidCell:function(e){var n=this.that,i=e.column,r=i.validations;if(!r||!r.length)return{valid:!0};function o(e){return n.getValueFromDataType(e,l,!0)}var a=e.value,l=i.dataType,s=e.rowData;if(!s)throw"rowData required.";for(var d=0;d<r.length;d++){var c=r[d],u=c.on,h=c.type,f=!1,p=c.msg,g=c.value;if(!1!==u&&((u=pq.validations[h])?f=null!=a&&u(a,g,o):h&&(u={column:i,value:a,rowData:s,msg:p},!1===n.callFn(h,u))?(f=!1,p=u.msg):f=!0,!f))return{valid:!1,msg:p,column:i,warn:c.warn,dataIndx:i.dataIndx,validation:c}}return{valid:!0}},onScrollCell:function(e,n,i,r,o,a){var l=this.that,s=l.options.bootstrap;if(e||(d=l.getEditCell())&&d.$cell){var l=e||d.$cell,e=(l.attr("title",n),"tooltip"),d="open";s.on&&s.tooltip&&(e=s.tooltip,d="show");try{l[e]("destroy")}catch(c){}l[e]({trigger:"manual",position:{my:"left center+5",at:"right center"},content:function(){return(""==i?"":"<span class='ui-icon "+i+" pq-tooltip-icon'></span>")+n},open:function(e,n){var i,n=n.tooltip;r&&n.addClass(r),a&&(i=n.attr("style"),n.attr("style",i+";"+a)),o&&n.tooltip.css(o)}})[e](d)}},isValidCell:function(n){var i=this,r=i.that,o=n.rowData,a=n.rowIndx,l=n.value,s=n.valueDef,d=n.column,c=n.focusInvalid,u=r.options,h=(u.bootstrap,n.allowInvalid),f=d.dataIndx,p=u.validation,g=u.warning,m=u.editModel,v=m.invalidClass,m=m.warnClass,$=document.activeElement;if(n.checkEditable&&0==r.isEditable({rowIndx:a,rowData:o,column:d,dataIndx:f}))return{valid:!0};var x,w,y,C,n=this._isValidCell({column:d,value:l,rowData:o}),d=n.valid,l=n.warn,_=n.msg;if(d?r.data({rowData:o,dataIndx:f,data:"pq_valid"})&&(r.removeClass({rowData:o,rowIndx:a,dataIndx:f,cls:m+" "+v}),r.removeData({rowData:o,dataIndx:f,data:"pq_valid"})):(x=(g=e.extend({},l?g:p,n.validation)).css,w=g.cls,y=g.icon,C=g.style),h||l)return d?{valid:!0}:(r.addClass({rowData:o,rowIndx:a,dataIndx:f,cls:l?m:v}),r.data({rowData:o,dataIndx:f,data:{pq_valid:{css:x,icon:y,style:C,msg:_,cls:w}}}),n);if(!d){if(null==a&&(null==(a=(p=r.getRowIndx({rowData:o,dataUF:!0})).rowIndx)||p.uf))return n.uf=p.uf,n;if(c){if(s){if(e($).hasClass("pq-editor-focus")&&(g=u.editModel.indices)){if(h=g.rowIndx,l=g.dataIndx,null!=a&&a!=h)throw"incorrect usage of isValid rowIndx: "+a;if(f!=l)throw"incorrect usage of isValid dataIndx: "+f;r.editCell({rowIndx:h,dataIndx:f})}}else{r.goToPage({rowIndx:a});var b=r.normalize({rowIndx:a,dataIndx:f}),I=r.getCell(b);r.scrollCell(b,function(){i.onScrollCell(I,_,y,w,x,C),r.focus(b)})}this.onScrollCell(I,_,y,w,x,C)}return n}if(s&&(m=r.getEditCell())&&m.$cell){(v=m.$cell).removeAttr("title");try{v.tooltip("destroy")}catch(q){}}return{valid:!0}},isValid:function(e){var n,i=this.that,r=(e=e||{}).allowInvalid,o=e.focusInvalid,a=e.checkEditable,r=null!=r&&r;if(null!=(f=e.dataIndx))return h=i.columns[f],l=e.rowData||i.getRowData(e),g=(n=e.hasOwnProperty("value"))?e.value:l[f],(p=this.isValidCell({rowData:l,checkEditable:a,rowIndx:e.rowIndx,value:g,valueDef:n,column:h,allowInvalid:r,focusInvalid:o})).valid||p.warn?{valid:!0}:p;if(null!=e.rowIndx||null!=e.rowIndxPage||null!=e.rowData){for(var l=e.rowData||i.getRowData(e),s=i.colModel,d=[],c=0,u=s.length;c<u;c++)if(!(h=s[c]).hidden){var h,f,p,g=l[f=h.dataIndx];if(!(p=this.isValidCell({rowData:l,value:g,column:h,rowIndx:e.rowIndx,checkEditable:a,allowInvalid:r,focusInvalid:o})).valid&&!p.warn){if(!r)return p;d.push({rowData:l,dataIndx:f,column:h})}}return r&&d.length?{cells:d,valid:!1}:{valid:!0}}var m=e.data||i.options.dataModel.data,d=[];if(!m)return null;for(c=0,u=m.length;c<u;c++){var l=m[c],v=this.isValid({rowData:l,rowIndx:void 0,checkEditable:a,allowInvalid:r,focusInvalid:o}),$=v.cells;if(!1===r){if(!v.valid)return v}else $&&$.length&&(d=d.concat($))}return r&&d.length?{cells:d,valid:!1}:{valid:!0}}}}(jQuery),function(e){var n={options:{curPage:0,totalPages:0,totalRecords:0,msg:"",rPPOptions:[10,20,30,40,50,100],rPP:20,layout:["first","prev","|","strPage","|","next","last","|","strRpp","|","refresh","|","strDisplay"]},_create:function(){var e=this,n=e.options,i=n.rtl,r=e.element,o={first:e.initButton(n.strFirstPage,"seek-"+(i?"end":"first"),"first"),"|":"<td><span class='pq-separator'></span></td>",next:e.initButton(n.strNextPage,"seek-"+(i?"prev":"next"),"next"),prev:e.initButton(n.strPrevPage,"seek-"+(i?"next":"prev"),"prev"),last:e.initButton(n.strLastPage,"seek-"+(i?"first":"end"),"last"),strPage:e.getPageOf(),strRpp:e.getRppOptions(),refresh:e.initButton(n.strRefresh,"refresh","refresh"),strDisplay:"<td><span class='pq-page-display'>"+e.getDisplay()+"</span></td>"},i=n.layout.map(function(e){return o[e]}).join("");e.listeners={},r.html("<table style='border-collapse:collapse;'><tr>"+i+"</tr></table>"),r.addClass("pq-pager"),e.$first=r.find(".pq-page-first"),e.bindButton(e.$first,function(i){1<n.curPage&&e.onChange(i,1)}),e.$prev=r.find(".pq-page-prev"),e.bindButton(e.$prev,function(i){var r;1<n.curPage&&(r=n.curPage-1,e.onChange(i,r))}),e.$next=r.find(".pq-page-next"),e.bindButton(e.$next,function(i){var r;n.curPage<n.totalPages&&(r=n.curPage+1,e.onChange(i,r))}),e.$last=r.find(".pq-page-last"),e.bindButton(e.$last,function(i){var r;n.curPage!==n.totalPages&&(r=n.totalPages,e.onChange(i,r))}),e.$refresh=r.find(".pq-page-refresh"),e.bindButton(e.$refresh,function(n){if(!1===e._trigger("beforeRefresh",n))return!1;e._trigger("refresh",n)}),e.$display=r.find(".pq-page-display"),e.$select=r.find(".pq-page-select").val(n.rPP).on("change",e.onChangeSelect.bind(e)),e.$totalPages=r.find(".pq-page-total"),e.$curPage=r.find(".pq-page-current"),e.bindCurPage(e.$curPage)},_destroy:function(){this.element.empty().removeClass("pq-pager").enableSelection(),this._trigger("destroy")},_setOption:function(e,n){this._super(e,n="curPage"!=e&&"totalPages"!=e?n:+n)},_setOptions:function(n){var i,r=!1,o=this.options;for(i in n){var a=n[i],l=typeof a;"string"!=l&&"number"!=l&&("function"==typeof a.splice||e.isPlainObject(a))?JSON.stringify(a)!=JSON.stringify(o[i])&&(this._setOption(i,a),r=!0):a!=o[i]&&(this._setOption(i,a),r=!0)}return r&&this._refresh(),this}},n=(e.widget("paramquery.pqPager",n),pq.pager=function(n,i){return(n=e(n).pqPager(i)).data("paramqueryPqPager")||n.data("paramquery-pqPager")},e.paramquery),i=n.pqPager;i.regional={},i.defaults=i.prototype.options,e.extend(i.prototype,{bindButton:function(n,i){n.bind("click keydown",function(n){if("click"==n.type||n.keyCode==e.ui.keyCode.ENTER)return i.call(this,n)})},bindCurPage:function(n){var i=this,r=this.options;n.bind("keydown",function(n){n.keyCode===e.ui.keyCode.ENTER&&e(this).trigger("change")}).bind("change",function(n){var o=e(this),a=o.val();return isNaN(a)||a<1||(a=parseInt(a))!==r.curPage&&(a>r.totalPages||!1===i.onChange(n,a))?(o.val(r.curPage),!1):void 0})},initButton:function(e,n,i){return"<td><span class='pq-ui-button ui-widget-header pq-page-"+i+"' tabindex='0' title='"+e+"'><span class='ui-icon ui-icon-"+n+"'></span></span></td>"},onChange:function(e,n){var i={curPage:n};if(!1===this._trigger("beforeChange",e,i))return!1;this.options.curPage=n,this._trigger("change",e,i)},onChangeSelect:function(n){var i=e(n.target),r=+i.val(),o={rPP:r};if(!1===this._trigger("beforeChange",n,o))return i.val(this.options.rPP),!1;this.options.rPP=r,this._trigger("change",n,o)},refresh:function(){this._destroy(),this._create()},format:function(e){var n=e.format;return function(e){return n?pq.formatNumber(e,n):e}},_refresh:function(){var e=this,n=e.options,i=n.curPage>=n.totalPages;e.setDisable(e.$next,i),e.setDisable(e.$last,i),i=n.curPage<=1,e.setDisable(e.$first,i),e.setDisable(e.$prev,i),e.$totalPages.text(e.format(n)(n.totalPages)),e.$curPage.val(n.curPage),e.$select.val(n.rPP),e.$display.html(this.getDisplay()),e._trigger("refreshView")},getDisplay:function(){var e,n,i,r=this.options,o=this.format(r),a=0<r.totalRecords?(e=r.rPP,a=r.strDisplay||"",n=r.curPage,(r=r.totalRecords)<(i=n*e)&&(i=r),(a=(a=a.replace("{0}",o(1+(n-1)*e))).replace("{1}",o(i))).replace("{2}",o(r))):"";return a},getPageOf:function(){var e=this.options;return"<td><span>"+(e.strPage||"").replace("{0}","<input type='text' value='"+e.curPage+"' tabindex='0' class='pq-page-current ui-corner-all' />").replace("{1}","<span class='pq-page-total'>"+this.format(e)(e.totalPages)+"</span>")+"</span></td>"},getRppOptions:function(){var e,n,i,r,o=this.options,a=o.rPPOptions,l=0,s=a.length,d=this.format(o),o=o.strRpp||"";if(o&&-1!=o.indexOf("{0}")){for(r=["<select class='ui-corner-all pq-page-select' >"];l<s;l++)n=+(n=a[l])==n?d(e=n):n[e=Object.keys(n)[0]],r.push('<option value="',e,'">',n,"</option>");r.push("</select>"),i=r.join(""),o=o.replace("{0}",i)+"</span>"}return"<td><span class='pq-page-rppoptions'>"+o+"</span></td>"},getInstance:function(){return{pager:this}},_trigger:n._trigger,on:n.on,one:n.one,off:n.off,setDisable:function(e,n){e[n?"addClass":"removeClass"]("disabled").css("pointer-events",n?"none":"").attr("tabindex",n?"":"0")}})}(jQuery),function(e){function n(){}n.prototype={belongs:function(e){if(e.target==this.that.element[0])return!0},setTimer:function(e,n){clearTimeout(this._timeID),this._timeID=setTimeout(function(){e()},n)}};var i=e.paramquery,r=(i.cClass=n,{widgetEventPrefix:"pqgrid"}),o=(r._createWidget=function(n,i){return this.origOptions=n,e(document).triggerHandler("pq:ready"),e.Widget.prototype._createWidget.apply(this,arguments)},r._create=function(){var n=this,r=n.options,o=n.element,a=n.eventNamespace,l=r.bootstrap,s=l.on,d=r.roundCorners&&!s,c=r.summaryOnTop,u="<div class='pq-summary-outer' ></div>",h=r.ui,f=(e(document).triggerHandler("pqGrid:bootup",{instance:this}),n.BS_on=s,r.collapsible||(r.collapsible={on:!1,collapsed:!1}),r.flexHeight&&(r.height="flex"),r.flexWidth&&(r.width="flex"),n.iRefresh=new i.cRefresh(n),n.iKeyNav=new i.cKeyNav(n),n.iValid=new i.cValid(n),n.tables=[],n.$tbl=null,n.iCols=new i.cColModel(n),n.iSort=new i.cSort(n),o.on("scroll"+a,function(){this.scrollLeft=0,this.scrollTop=0}).on("mousedown"+a,n._mouseDown.bind(n)),(s?l:h).grid),p=s?"":h.header_o,g=s?"":h.bottom,s=(s?l:h).top,l=(o.empty().attr({role:"grid",dir:r.rtl?"rtl":"ltr"}).addClass("pq-grid pq-theme "+f+" "+(d?" ui-corner-all":"")).html(["<div class='pq-grid-top ",s," ",d?" ui-corner-top":"","'>","<div class='pq-grid-title",d?" ui-corner-top":"","'>&nbsp;</div>","</div>","<div class='pq-grid-center-o'>","<div class='pq-tool-panel' style='display:",r.toolPanel.show?"":"none",";'></div>","<div class='pq-tool-panel-rules' style='display:",r.toolPanelRules.show?"":"none",";'></div>","<div class='pq-grid-center' >","<div class='pq-header-outer ",p,"' tabindex='0'></div>",c?u:"","<div class='pq-body-outer' tabindex='0' ></div>",c?"":u,"</div>","<div style='clear:both;'></div>","</div>","<div class='pq-grid-bottom ",g," ",d?" ui-corner-bottom":"","'>","<div class='pq-grid-footer'></div>","</div>"].join("")),n.setLocale(),n.$bottom=e(".pq-grid-bottom",o),n.$summary=e(".pq-summary-outer",o),n.$toolPanel=o.find(".pq-tool-panel"),n.$toolPanelRules=o.find(".pq-tool-panel-rules"),n.$top=e("div.pq-grid-top",o),r.showTop||n.$top.css("display","none"),n.$title=e("div.pq-grid-title",o),r.showTitle||n.$title.css("display","none"),n.$grid_center=e(".pq-grid-center",o).on("scroll",function(){this.scrollTop=0}));n.$header=e(".pq-header-outer",l).on("scroll",function(){this.scrollTop=0,this.scrollLeft=0}).on("focus",function(e){n.onfocusHeader(e)}),n.$footer=e(".pq-grid-footer",o),h=n.$cont=e(".pq-body-outer",l),l.on("mousedown",n._onGCMouseDown.bind(n)),n.iRenderB=new pq.cRenderBody(n,{$center:l,$b:h,$sum:n.$summary,header:!0,$h:n.$header}),n._trigger("render",null,{dataModel:n.options.dataModel,colModel:n.colModel}),"ontouchend"in document&&(n.addTouch(),n.contextIOS(o)),o.on("contextmenu"+a,n.onContext.bind(n)),h.on("click",".pq-grid-cell,.pq-grid-number-cell",function(i){if(!0!==e.data(i.target,n.widgetName+".preventClickEvent"))return n.evtBelongs(i)?n._onClickCell(i):void 0}).on("dblclick",".pq-grid-cell",function(e){if(n.evtBelongs(e))return n._onDblClickCell(e)}),h.on("focusout",function(){n.onblur()}).on("focus",function(e){n.onfocus(e)}).on("mousedown",n._onMouseDown.bind(n)).on("change",n._onChange(n)).on("mouseenter",".pq-grid-cell,.pq-grid-number-cell",n._onCellMouseEnter(n)).on("mouseenter",".pq-grid-row",n._onRowMouseEnter(n)).on("mouseleave",".pq-grid-cell",n._onCellMouseLeave(n)).on("mouseleave",".pq-grid-row",n._onRowMouseLeave(n)).on("keyup",n._onKeyUp(n)),r.selectionModel.native||this.disableSelection(),l.bind("keydown.pq-grid",n._onKeyDown(n)),this._refreshTitle(),n.iRows=new i.cRows(n),n.generateLoading(),n._initPager(),n._refreshResizable(),n._refreshDraggable(),n.iResizeColumns=new i.cResizeColumns(n),this._mouseInit()},r.contextIOS=function(n){var i,r,o,a="contextmenu";n.on("touchstart",function(l){i=1,setTimeout(function(){var n;i&&1==(o=l.originalEvent.touches).length&&(n=o[0],n=e.Event(a,n),e(l.target).trigger(n),r=1)},600),n.one(a,function(){i=0})}).on("touchmove touchend",function(e){i=0,r&&(r=0,e.preventDefault())})},r.addTouch=function(){var n,i,r=this.$grid_center[0];r.addEventListener("touchstart",function(e){var r,o,a=e.target,e=e.changedTouches[0];n?a&&a==n.target&&12>=Math.sqrt((r=n.x-e.pageX)*r+(o=n.y-e.pageY)*o)&&(i=n,setTimeout(function(){i=null},500)):(n={x:e.pageX,y:e.pageY,target:a},setTimeout(function(){n=null},400))},!0),r.addEventListener("touchend",function(n){var r=n.target;i&&r==i.target&&e(r).trigger("dblclick",n)})},r._mouseDown=function(n){var i=this;e(n.target).closest(".pq-editor-focus").length&&(this._blurEditMode=!0,window.setTimeout(function(){i._blurEditMode=!1},0))},r.destroy=function(){for(var n in this._trigger("destroy"),this._super(),e(window).off("resize"+this.eventNamespace),this)delete this[n];this.options=void 0,e.fragments={}},r.setLocale=function(){var n=this.options,r=n.locale;n.strLocal!=r&&(e.extend(!0,n,i.pqGrid.regional[r]),e.extend(n.pageModel,i.pqPager.regional[r]))},r._setOption=function(e,n){function i(){l[e]=n}function r(e){return e?"addClass":"removeClass"}var o,a=this,l=a.options,s=a.pageI,d=a.iRenderB,c=a.iRenderSum,u=a.iRenderHead,h=l.dataModel;if(!a.$title)return i(),a;if("height"===e)i(),a._refreshResizable();else if("locale"==e||"pageModel"==e)i(),"locale"==e&&a.setLocale(),s&&s.destroy();else if("width"===e)i(),a._refreshResizable();else if("title"==e)i(),a._refreshTitle();else if("roundCorners"==e){i();var f=r(n);a.element[f]("ui-corner-all"),a.$top[f]("ui-corner-top"),a.$bottom[f]("ui-corner-bottom")}else if("freezeCols"==e)n=parseInt(n),!isNaN(n)&&0<=n&&n<=a.colModel.length-2&&i();else if("freezeRows"==e)n=parseInt(n),!isNaN(n)&&0<=n&&i();else if("resizable"==e)i(),a._refreshResizable();else if("draggable"==e)i(),a._refreshDraggable();else if("dataModel"==e)n.data!==h.data&&h.dataUF&&(h.dataUF.length=0),i();else{if("groupModel"==e)throw"use groupOption() to set groupModel options.";if("treeModel"==e)throw"use treeOption() to set treeModel options.";"colModel"===e||"columnTemplate"==e?(i(),a.iCols.init()):"disabled"===e?(a._super(e,n),!0===n?a._disable():a._enable()):"strLoading"===e?(i(),a._refreshLoadingString()):"showTop"===e?(i(),a.$top.css("display",n?"":"none")):"showTitle"===e?(i(),a.$title.css("display",n?"":"none")):"showToolbar"===e?(i(),a._toolbar.widget().css("display",n?"":"none")):"collapsible"===e?(i(),a._createCollapse()):"showBottom"===e?(i(),a.$bottom.css("display",n?"":"none")):"wrap"==e||"hwrap"==e?(i(),("wrap"==e?d.$tbl.add(c.$tbl):u.$tbl)[r(!n)]("pq-no-wrap")):"rowBorders"===e?(i(),f=r(n),d.$tbl[f](o="pq-td-border-top"),c.$tbl[f](o)):"columnBorders"===e?(i(),f=r(n),d.$tbl[f](o="pq-td-border-right"),c.$tbl[f](o)):"strNoRows"===e?(i(),a.$cont.find(".pq-grid-norows").text(n)):i()}return a},r.options={cancel:"input,textarea,button,select,option,.pq-no-capture,.ui-resizable-handle",trigger:!1,bootstrap:{on:!1,thead:"table table-striped table-condensed table-bordered",tbody:"table table-condensed",grid:"panel panel-default",top:"",btn:"btn btn-default",groupModel:{icon:["glyphicon-triangle-bottom","glyphicon-triangle-right"]},header_active:"active"},ui:{on:!0,grid:"ui-widget ui-widget-content",top:"ui-widget-header",bottom:"",header_o:"ui-widget-header",header:"ui-state-default",header_active:""},format:function(e,n,i,r){var o="format";return i[o]||r[o]||n[o]},cellDatatype:function(e,n){return n.dataType},collapsible:{on:!0,toggle:!0,collapsed:!1,_collapsed:!1,refreshAfterExpand:!0,css:{zIndex:1e3}},colModel:null,columnBorders:!0,dataModel:{data:[],dataUF:[],cache:!1,dataType:"JSON",location:"local",sorting:"local",sortDir:"up",method:"GET"},direction:"",draggable:!1,editable:!0,editModel:{pressToEdit:!0,charsAllow:["0123456789.-=eE+","0123456789-=eE+"],clicksToEdit:2,filterKeys:!0,reInt:/^([-]?[1-9][0-9]*|[-]?[0-9]?)(e[-+]?)?[0-9]*$/i,reFloat:/^[-]?[0-9]*\.?[0-9]*(e[-+]?)?[0-9]*$/i,onBlur:"validate",saveKey:e.ui.keyCode.ENTER,onSave:"nextFocus",onTab:"nextFocus",allowInvalid:!1,invalidClass:"pq-cell-red-tr pq-has-tooltip",warnClass:"pq-cell-blue-tr pq-has-tooltip",validate:!0},editor:{select:!1,type:"contenteditable"},summaryOptions:{number:"avg,max,min,stdev,stdevp,sum",date:"count,max,min",string:"count"},summaryTitle:{avg:"Avg: {0}",count:"Count: {0}",max:"Max: {0}",min:"Min: {0}",stdev:"Stdev: {0}",stdevp:"Stdevp: {0}",sum:"Sum: {0}"},validation:{icon:"ui-icon-alert",cls:"ui-state-error",style:"padding:3px 10px;"},warning:{icon:"ui-icon-info",cls:"",style:"padding:3px 10px;"},freezeCols:0,freezeRows:0,freezeBorders:!0,calcDataIndxFromColIndx:!0,height:400,hoverMode:"null",locale:"en",maxColWidth:2e3,minColWidth:50,minWidth:100,menuUI:{tabs:["hideCols","filter"],buttons:["clear","ok"],gridOptions:{autoRow:!1,copyModel:{render:!0},editable:function(e){return!e.rowData.pq_disabled},fillHandle:"",filterModel:{header:!0,on:!0},hoverMode:"row",hwrap:!1,rowBorders:!1,rowHt:24,rowHtHead:23,scrollModel:{autoFit:!0},showTop:!1,height:300,wrap:!1}},mergeCells:[],numberCell:{width:30,title:"",resizable:!0,minWidth:30,maxWidth:100,show:!0},pageModel:{curPage:1,totalPages:0,rPP:10,rPPOptions:[10,20,50,100]},refreshCompareBy:"value",resizable:!1,rowBorders:!0,rowResize:!0,autoRow:!0,scrollModel:{autoFit:!1},selectionModel:{column:!0,type:"cell",onTab:"nextFocus",row:!0,mode:"block"},showBottom:!0,showHeader:!0,showTitle:!0,showToolbar:!0,showTop:!0,sortable:!0,sql:!1,stringify:!0,stripeRows:!0,title:"&nbsp;",toolPanelRules:{},treeModel:null,width:"auto",wrap:!0,hwrap:!0},e.widget("paramquery._pqGrid",e.ui.mouse,r),i._pqGrid.prototype);function a(e){return"<span class='btn btn-xs glyphicon glyphicon-"+e+"' ></span>"}function l(e){return"<span class='ui-widget-header pq-ui-button'><span class='ui-icon ui-icon-"+e+"'></span></span>"}o.setData=function(e){var n=this.options,i=n.groupModel.pivot,n=n.reactive,r=this.Group();i&&r.option({pivot:!1}),this.option("dataModel.data",e),n||this.refreshDataAndView(),i&&r.option({pivot:!0})},o.refreshCM=function(e,n){e&&(this.options.colModel=e),this.iCols.init(n)},o.evtBelongs=function(n){return e(n.target).closest(".pq-grid")[0]==this.element[0]},o.readCell=function(e,n,i,r,o){if(!i||!1!==i.isRootCell(r,o,"o"))return e[n.dataIndx]},o.saveCell=function(e,n,i){e[n.dataIndx]=i},o._destroyResizable=function(){var e=this.element,n=e.data();(n.resizable||n.uiResizable||n["ui-resizable"])&&e.resizable("destroy")},o._disable=function(){null==this.$disable&&(this.$disable=e("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},o._enable=function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},o._destroy=function(){var n=this.eventNamespace;this.loading&&this.xhr.abort(),this._destroyResizable(),this._destroyDraggable(),this.element.off(n),e(window).unbind(n),e(document).unbind(n),this.element.empty().css("height","").css("width","").removeClass("pq-grid ui-widget ui-widget-content ui-corner-all").removeData()},o._onKeyUp=function(e){return function(n){e.evtBelongs(n)&&e._trigger("keyUp",n,null)}},o.onKeyDown=function(n){if(e(n.target).closest(".pq-header-outer").length)return this._trigger("headerKeyDown",n,null);!1!==this.iKeyNav.bodyKeyDown(n)&&this._trigger("keyDown",n,null)},o._onKeyDown=function(e){return function(n){e.evtBelongs(n)&&e.onKeyDown(n,e)}},o.collapse=function(e){function n(){r.css("overflow","hidden"),a.addClass("ui-icon-circle-triangle-s").removeClass("ui-icon-circle-triangle-n"),r.hasClass("ui-resizable")&&r.resizable("destroy"),i._toolbar&&i._toolbar.disable(),o.collapsed=o._collapsed=!0,o.animating=!1,i._trigger("collapse")}e=e||{};var i=this,r=i.element,o=i.options.collapsible,a=o.$collapse.children("span");if(o._collapsed)return!1;o.htCapture=r.height(),!1===e.animate?(r.height(23),n()):(o.animating=!0,i.disable(),r.animate({height:"23px"},function(){n()}))},o.expand=function(e){function n(){r.css("overflow",""),o._collapsed=o.collapsed=!1,i._refreshResizable(),o.refreshAfterExpand&&i.refresh(),l.addClass("ui-icon-circle-triangle-n").removeClass("ui-icon-circle-triangle-s"),i._toolbar&&i._toolbar.enable(),i.enable(),o.animating=!1,i._trigger("expand")}var i=this,r=i.element,o=i.options.collapsible,a=o.htCapture,l=o.$collapse.children("span");if(!1===o._collapsed)return!1;!1===(e=e||{}).animate?(r.height(a),n()):(o.animating=!0,r.animate({height:a},function(){n()}))},o._createCollapse=function(){var n=this,i=this.$top,r=this.options,o=this.BS_on,s=r.collapsible;s.$stripe||(r=e("<div class='pq-slider-icon pq-no-capture'  ></div>").appendTo(i),s.$stripe=r),s.on?s.$collapse||(s.$collapse=e(o?a("collapse-down"):l("circle-triangle-n")).appendTo(s.$stripe).click(function(){s.collapsed?n.expand():n.collapse()})):s.$collapse&&(s.$collapse.remove(),delete s.$collapse),s.collapsed&&!s._collapsed?n.collapse({animate:!1}):!s.collapsed&&s._collapsed&&n.expand({animate:!1}),s.toggle?s.$toggle||(s.$toggle=e(o?a("fullscreen"):l("arrow-4-diag")).prependTo(s.$stripe).click(function(){n.toggle()})):s.$toggle&&(s.$toggle.remove(),delete s.$toggle),s.toggled&&!s.state&&this.toggle()},o.toggle=function(n){n=n||{};var i,r,o=this.options,a=o.collapsible,l=this.element,s=a.state,d=s?"min":"max",c=e("html"),u=e(window),h=e(document.body);if(!1===this._trigger("beforeToggle",null,{state:d}))return!1;"min"==d?(i=s.grid,r=s.doc,this.option({height:i.height,width:i.width,maxHeight:i.maxHeight,maxWidth:i.maxWidth}),l[0].style.cssText=i.cssText,h[0].style.cssText=r.cssText,c.css({overflow:"visible"}),window.scrollTo(r.scrollLeft,r.scrollTop),a.state=null):(i={height:o.height,width:o.width,cssText:l[0].style.cssText,maxHeight:o.maxHeight,maxWidth:o.maxWidth},this.option({height:"100%",width:"100%",maxHeight:null,maxWidth:null}),l.css(e.extend({position:"fixed",left:0,top:0,margin:0},a.css)),r={scrollLeft:u.scrollLeft(),scrollTop:u.scrollTop(),cssText:h[0].style.cssText},h.css({height:0,width:0,overflow:"hidden",position:"static"}),c.css({overflow:"hidden"}),window.scrollTo(0,0),a.state={grid:i,doc:r}),a.toggled=!!a.state,n.refresh||(this._trigger("toggle",null,{state:d}),this._refreshResizable(),this.refresh(),u.trigger("resize",{$grid:l,state:d}))},o._onDblClickCell=function(n){var i=this,r=e(n.currentTarget),o=i.getCellIndices({$td:r});o.$td=r,0!=i._trigger("cellDblClick",n,o)&&(1<i.options.editModel.clicksToEdit&&i.isEditable(o)&&i.editCell(o),o.$tr=r.closest(".pq-grid-row"),i._trigger("rowDblClick",n,o))},o.getValueFromDataType=function(n,i,r){var o;if("="==(n+"")[0])return n;if("date"==i)return isNaN(o=Date.parse(n))?void 0:r?o:n;if("integer"==i)o=parseInt(n);else{if("float"!=i)return"bool"==i?null==n?n:0==(o=e.trim(n).toLowerCase()).length?null:"true"==o||"yes"==o||"1"==o||"false"!=o&&"no"!=o&&"0"!=o&&Boolean(o):"object"==i||null==n?n:e.trim(n);o=parseFloat(n)}return isNaN(o)||null==o?null==n?n:null:o},o.isValid=function(e){return this.iValid.isValid(e)},o.isValidChange=function(e){e=e||{};var n=this.getChanges(),i=n.addList,n=n.updateList.concat(i);return e.data=n,this.isValid(e)},o.isEditableCell=function(e){var n,i=e,r=e.rowData;return null==(n=(r=e.column&&r?r:(i=this.normalize(e)).rowData)&&(r=r.pq_cellprop)?(r[i.dataIndx]||{}).edit:n)&&null!=(r=i.column.editable)?"function"==typeof r?(i=i||this.normalize(e),this.callFn(r,i)):r:n},o.isEditableRow=function(e){var n=this.options.editable,i=e.rowData,i=i&&(i.pq_rowprop||{}).edit;return null==i?"function"==typeof n?n.call(this,this.normalize(e)):n:i},o.isEditable=function(e){var n=this.isEditableCell(e);return null==n?this.isEditableRow(e):n},o._onMouseDownCont=function(){var e=this.pdata;e&&e.length||((e=this.$cont[0]).setAttribute("tabindex",0),e.focus())},o._onGCMouseDown=function(){var n=this;n._mousePQUpDelegate=function(i){e(document).unbind("mouseup"+n.eventNamespace,n._mousePQUpDelegate),n._trigger("mousePQUp",i,null)},e(document).bind("mouseup"+n.eventNamespace,n._mousePQUpDelegate)},o._onMouseDown=function(n){var i,r;n.which&&1!=n.which||!this.evtBelongs(n)||(r=(i=e(n.target)).closest(".pq-grid-cell,.pq-grid-number-cell"),i.is("a")||(r.length&&(n.currentTarget=r[0],this._onMouseDownCell(n)),n.isPropagationStopped()||((r=i.closest(".pq-grid-row")).length&&(n.currentTarget=r[0],this._onMouseDownRow(n)),n.isPropagationStopped()||this._onMouseDownCont(n))))},o._onMouseDownCell=function(n){var i=e(n.currentTarget),r=this.getCellIndices({$td:i});null!=r.rowIndx&&((r=this.iMerge.getRootCellO(r.rowIndx,r.colIndx,!0)).$td=i,this._trigger("cellMouseDown",n,r))},o._onMouseDownRow=function(n){var i=e(n.currentTarget),r=this.getRowIndx({$tr:i});r.$tr=i,this._trigger("rowMouseDown",n,r)},o._onCellMouseEnter=function(n){return function(i){if(n.evtBelongs(i)){var r=e(this),o=n.options,a=n.getCellIndices({$td:r});if(null!=a.rowIndx&&null!=a.colIndx&&!1!==n._trigger("cellMouseEnter",i,a))return"cell"==o.hoverMode&&n.highlightCell(r),!0}}},o._onChange=function(n){var i,r,o;function a(){if(i&&r&&r.target==i.target){for(var e in{ctrlKey:0,metaKey:0,shiftKey:0,altKey:0})r[e]=i[e];n._trigger("valChange",r,o),r=i=void 0}}return n.on("cellClickDone",function(e){i=e.originalEvent,a()}),function(i){var l,s;n.evtBelongs(i)&&(s=(l=e(i.target)).closest(".pq-grid-cell")).length&&(o=n.getCellIndices({$td:s}),(o=n.normalize(o)).input=l[0],r=i,a())}},o._onRowMouseEnter=function(n){return function(i){if(n.evtBelongs(i)){var r=e(this),o=n.options,r=n.getRowIndx({$tr:r}),a=r.rowIndxPage;if(!1!==n._trigger("rowMouseEnter",i,r))return"row"==o.hoverMode&&n.highlightRow(a),!0}}},o._onCellMouseLeave=function(n){return function(i){n.evtBelongs(i)&&(i=e(this),"cell"==n.options.hoverMode&&n.unHighlightCell(i))}},o._onRowMouseLeave=function(n){return function(i){var r,o,a;n.evtBelongs(i)&&(r=e(this),a=(o=n.getRowIndx({$tr:r})).rowIndxPage,!1!==n._trigger("rowMouseLeave",i,{$tr:r,rowIndx:o.rowIndx,rowIndxPage:a})&&"row"==n.options.hoverMode&&n.unHighlightRow(a))}},o.enableSelection=function(){this.element.removeClass("pq-disable-select").off("selectstart"+this.eventNamespace)},o.disableSelection=function(){this.element.addClass("pq-disable-select").on("selectstart"+this.eventNamespace,function(n){var i=n.target,r=e(i);if(i)return!!r.is("input,textarea,select,[contenteditable=true]")||!!r.closest(".pq-native-select").length||void n.preventDefault()})},o._onClickCell=function(n){var i=this,r=i.options.editModel,o=e(n.currentTarget),a=i.getCellIndices({$td:o}),a=i.normalize(a),l=a.colIndx;a.$td=o,a.evt=n,0!=i._trigger("beforeCellClick",n,a)&&(i._trigger("cellClick",n,a),null==l||l<0||(1==r.clicksToEdit&&i.isEditable(a)&&i.editCell(a),a.$tr=o.closest(".pq-grid-row"),i._trigger("rowClick",n,a)))},o.getHeadIndices=function(e){var e=this.iRenderB.getCellIndx(e),n=e[0],e=e[1],i=this.headerCells;return{ri:n,colIndx:e,column:(i[n]||i[n-1])[e],filterRow:!i[n]}},o.onContext=function(n){function i(e){s._trigger(e,n,l)}var r,o,a,l,s=this,d=n.target;if(s.evtBelongs(n)){o=d;do{if(a=e(o),l={ele:o},a.is(".pq-grid")){l={},i("context");break}if(a.is("img")?(l.type="img",r=1):a.is(".pq-grid-cell,.pq-grid-number-cell")?(l=s.getCellIndices({$td:a})).rowData&&(l.type=l.column?"cell":"num",l.$td=a,r=1,i("cellRightClick")):a.is(".pq-grid-col")&&((l=s.getHeadIndices(o)).type="head",l.$th=a,r=1,i("headRightClick")),r){i("context");break}}while(o=o.parentNode)}},o.highlightCell=function(e){e.addClass("pq-grid-cell-hover ui-state-hover")},o.unHighlightCell=function(e){e.removeClass("pq-grid-cell-hover ui-state-hover")},o.highlightRow=function(e){isNaN(e)||(e=this.getRow({rowIndxPage:e}))&&e.addClass("pq-grid-row-hover ui-state-hover")},o.unHighlightRow=function(e){isNaN(e)||(e=this.getRow({rowIndxPage:e}))&&e.removeClass("pq-grid-row-hover ui-state-hover")},o._getCreateEventData=function(){return{dataModel:this.options.dataModel,data:this.pdata,colModel:this.options.colModel}},o._initPager=function(){var n,i=this,r=i.options,o=r.pageModel;o.type&&(n={bootstrap:r.bootstrap,change:function(e,n){i.blurEditor({force:!0});var r=i.options.pageModel;null!=n.curPage&&(r.prevPage=r.curPage,r.curPage=n.curPage),null!=n.rPP&&(r.rPP=n.rPP),"remote"==r.type?i.remoteRequest({callback:function(){i._onDataAvailable({apply:!0,header:!1})}}):i.refreshView({header:!1,source:"pager"})},refresh:function(){i.refreshDataAndView()}},(n=e.extend(n,o)).rtl=r.rtl,i.pageI=pq.pager(o.appendTo||this.$footer,n).on("destroy",function(){delete i.pageI}))},o.generateLoading=function(){this.$loading&&this.$loading.remove(),this.$loading=e("<div class='pq-loading'></div>").appendTo(this.element),e(["<div class='pq-loading-bg'></div><div class='pq-loading-mask ui-state-highlight'><div>",this.options.strLoading,"...</div></div>"].join("")).appendTo(this.$loading),this.$loading.find("div.pq-loading-bg").css("opacity",.2)},o._refreshLoadingString=function(){this.$loading.find("div.pq-loading-mask").children("div").html(this.options.strLoading)},o.showLoading=function(){null==this.showLoadingCounter&&(this.showLoadingCounter=0),this.showLoadingCounter++,this.$loading.show()},o.hideLoading=function(){0<this.showLoadingCounter&&this.showLoadingCounter--,this.showLoadingCounter||this.$loading.hide()},o.getTotalRows=function(){var e=this.options,n=e.dataModel,i=n.data||[],n=n.dataUF||[],e=e.pageModel;return"remote"==e.location?e.totalRecords:i.length+n.length},o.refreshDataFromDataModel=function(e){e=e||{};var n,i,r,o,a=this,l=a.options,s=l.dataModel,d=l.pageModel,s=s.data,c=d.type,u=a._queueATriggers;for(o in u){var h=u[o];delete u[o],a._trigger(o,h.evt,h.ui)}a._trigger("beforeRefreshData",null,{}),"local"==c?(i=d.totalRecords=s.length,d.totalPages=i=Math.ceil(i/d.rPP),d.curPage>i&&(d.curPage=i),i&&!d.curPage&&(d.curPage=1),r=(d.curPage-1)*d.rPP,(n=d.curPage*d.rPP)>s.length&&(n=s.length),a.pdata=s.slice(r=0<=r?r:0,n),r):"remote"==c?(d.totalPages=i=Math.ceil(d.totalRecords/d.rPP),d.curPage>i&&(d.curPage=i),i&&!d.curPage&&(d.curPage=1),(n=d.rPP)>s.length&&(n=s.length),a.pdata=s.slice(0,n),r=d.rPP*(d.curPage-1)):l.backwardCompat?a.pdata=s.slice(0):a.pdata=s,a.riOffset=0<=r?r:0,a._trigger("dataReady",null,{source:e.source}),a._trigger("dataReadyAfter",null,{source:e.source})},o.getQueryStringCRUD=function(){return""},o.remoteRequest=function(n){this.loading&&this.xhr.abort(),n=n||{};var i,r,o=this,a="",l="",s=this.options,d=!1,c=this.colModel,u=s.dataModel,h=s.sortModel,f=s.filterModel,p=s.pageModel;"function"==typeof u.getUrl?(s={colModel:c,dataModel:u,sortModel:h,groupModel:s.groupModel,pageModel:p,filterModel:f},(s=u.getUrl.call(this,s))&&s.url&&(a=s.url),s&&s.data&&(l=s.data)):"string"==typeof u.url&&(a=u.url,s={},i={},r={},"remote"==h.type&&(n.initBySort||this.sort({initByRemote:!0}),(h=this.iSort.getQueryStringSort())&&(s={pq_sort:h})),"remote"==p.type&&(r={pq_curpage:p.curPage,pq_rpp:p.rPP}),"local"!=f.type&&(h=this.iFilterData.getQueryStringFilter())&&(d=!0,i={pq_filter:h}),p=u.postData,f=u.postDataOnce,p&&"function"==typeof p&&(p=p.call(this,{colModel:c,dataModel:u})),l=e.extend({pq_datatype:u.dataType},i,r,s,p,f)),a&&(this.loading=!0,this.showLoading(),this.xhr=e.ajax({url:a,dataType:u.dataType,async:null==u.async||u.async,cache:u.cache,contentType:u.contentType,type:u.method,data:l,beforeSend:function(e,n){if("function"==typeof u.beforeSend)return u.beforeSend.call(o,e,n)},success:function(e,i,r){o.onRemoteSuccess(e,i,r,d,n)},error:function(e,n,i){if(o.hideLoading(),o.loading=!1,"function"==typeof u.error)u.error.call(o,e,n,i);else if("abort"!=i)throw"Error : "+i}}))},o.onRemoteSuccess=function(e,n,i,r,o){var a=this,l=a.options,s=a.colModel,d=l.pageModel,l=l.dataModel,n="function"==typeof l.getData?l.getData.call(a,e,n,i):e;l.data=n.data,"remote"==d.type&&(null!=n.curPage&&(d.curPage=n.curPage),null!=n.totalRecords&&(d.totalRecords=n.totalRecords)),a.hideLoading(),a.loading=!1,a._trigger("load",null,{dataModel:l,colModel:s}),r&&(a._queueATriggers.filter={ui:{}}),o.callback&&o.callback()},o._refreshTitle=function(){this.$title.html(this.options.title)},o._destroyDraggable=function(){var e=this.element,n=e.parent(".pq-wrapper");n.length&&n.data("draggable")&&(n.draggable("destroy"),this.$title.removeClass("pq-draggable pq-no-capture"),e.unwrap(".pq-wrapper"))},o._refreshDraggable=function(){var e=this.options,n=this.element,i=this.$title;e.draggable?(i.addClass("pq-draggable pq-no-capture"),n.parent(".pq-wrapper").length||n.wrap("<div class='pq-wrapper' />"),n.parent(".pq-wrapper").draggable({handle:i})):this._destroyDraggable()},o._refreshResizable=function(){var n,i=this,r=this.element,o=this.options,a=-1<(o.width+"").indexOf("%"),l=-1<(o.height+"").indexOf("%"),s="auto"==o.width,d="flex"==o.width,c="flex"==o.height;!o.resizable||(c||l)&&(d||a||s)?this._destroyResizable():(n="e,s,se",c||l?n="e":(d||a||s)&&(n="s"),c=!0,r.hasClass("ui-resizable")&&(n==r.resizable("option","handles")?c=!1:this._destroyResizable()),c&&r.resizable({helper:"ui-state-default",handles:n,minWidth:o.minWidth,minHeight:o.minHeight||100,delay:0,start:function(n,i){e(i.helper).css({opacity:.5,background:"#ccc",border:"1px solid steelblue"})},stop:function(){var n=i.element,r=n[0],a=o.width,l=o.height,s=-1<(a+"").indexOf("%"),d=-1<(l+"").indexOf("%"),c="auto"==a,a="flex"==a,l="flex"==l,u=!1;r.style.width=r.offsetWidth+3+"px",r.style.height=r.offsetHeight+3+"px",d||l||(u=!0,o.height=r.offsetHeight),s||c||a||(u=!0,o.width=r.offsetWidth),i.refresh({soft:!0}),n.css("position","relative"),u&&e(window).trigger("resize")}}))},o.refresh=function(e){this.iRefresh.refresh(e)},o.refreshView=function(e){null!=this.options.editModel.indices&&this.blurEditor({force:!0}),this.refreshDataFromDataModel(e),this.refresh(e)},o._refreshPager=function(){var e=this,n=e.options,i=n.pageModel,r=!!i.type,o=i.rPP,a=i.totalRecords;r?(e.pageI||e._initPager(),e.pageI.option(i),o<a?e.$bottom.css("display",""):n.showBottom||e.$bottom.css("display","none")):(e.pageI&&e.pageI.destroy(),n.showBottom?e.$bottom.css("display",""):e.$bottom.css("display","none"))},o.getInstance=function(){return{grid:this}},o.refreshDataAndView=function(e){var n,i=this.options.dataModel;this.pdata=[],"remote"==i.location?(n=this).remoteRequest({callback:function(){n._onDataAvailable(e)}}):this._onDataAvailable(e)},o.getColIndx=function(e){var n=e.dataIndx,i=e.column,r=this.colModel,o=r.length,a=0;if(i){for(;a<o;a++)if(r[a]==i)return a}else{if(null==n)throw"dataIndx / column NA";if(null!=(e=this.colIndxs[n]))return e}return -1},o.getColumn=function(e){if(null==(e=e.dataIndx))throw"dataIndx N/A";return this.columns[e]||this.iGroup.getColsPrimary()[e]},o._generateEditorOutline=function(n,i,r){var o=this.options,n=this.iRenderB.getCellCont(n,i)[0];this.$div_focus||(i=this.$div_focus=e("<div class='pq-editor-outer'><div class='pq-editor-inner'></div></div>"),"flex"==o.height&&"flex"==o.width||"grid"==r.appendTo?i.appendTo(this.element):i.insertAfter(n))},o._removeEditOutline=function(){var n,i;this.$div_focus&&((i=n=this.$div_focus.find(".pq-editor-focus")).hasClass("hasDatepicker")&&i.datepicker("hide").datepicker("destroy"),n[0]==document.activeElement&&(i=this._blurEditMode,this._blurEditMode=!0,n.blur(),this._blurEditMode=i),this.$div_focus.remove(),delete this.$div_focus,n=this.options.editModel,i=e.extend({},n.indices),n.indices=null,i.rowData=void 0,this.refreshCell(i))},o.scrollX=function(e,n){var i=this;return i.iRenderB.scrollX(e,function(){n&&n.call(i)})},o.scrollY=function(e,n){var i=this;return i.iRenderB.scrollY(e,function(){n&&n.call(i)})},o.scrollXY=function(e,n,i){var r=this;return r.iRenderB.scrollXY(e,n,function(){i&&i.call(r)})},o.scrollRow=function(e,n){var i=this;i.iRenderB.scrollRow(i.normalize(e).rowIndxPage,function(){n&&n.call(i)})},o.scrollColumn=function(e,n){var i=this;i.iRenderB.scrollColumn(i.normalize(e).colIndx,function(){n&&n.call(i)})},o.scrollCell=function(e,n){var i=this,e=i.normalize(e);i.iRenderB.scrollCell(e.rowIndxPage,e.colIndx,function(){n&&n.call(i),i._trigger("scrollCell")})},o.blurEditor=function(e){if(this.$div_focus){var n=this.$div_focus.find(".pq-editor-focus");if(!e||!e.blurIfFocus)return n.triggerHandler("blur",e);document.activeElement==n[0]&&n.blur()}},o.Selection=function(){return this.iSelection},o.goToPage=function(e){var n,i,r=this.options.pageModel;"local"!=r.type&&"remote"!=r.type||(i=e.rowIndx,n=r.rPP,(i=null==e.page?Math.ceil((i+1)/n):e.page)!=r.curPage&&(r.curPage=i,"local"==r.type?this.refreshView():this.refreshDataAndView()))},o.setSelection=function(e,n){if(null==e)return this.iSelection.removeAll(),this.iRows.removeAll({all:!0}),!0;function i(){null!=l&&!1!==e.focus&&r.focus({rowIndxPage:l,colIndx:null==s?r.getFirstVisibleCI():s}),n&&n.call(r)}var r=this,o=r.pdata,a=(o&&o.length||i(),(e=this.normalize(e)).rowIndx),l=e.rowIndxPage,s=e.colIndx;(null==a||a<0||s<0||s>=this.colModel.length)&&i(),this.goToPage(e),l=a-this.riOffset,r.scrollRow({rowIndxPage:l},function(){null==s?(r.iRows.add({rowIndx:a}),i()):r.scrollColumn({colIndx:s},function(){r.Range({r1:a,c1:s}).select(),i()})})},o.getColModel=function(){return this.colModel},o.getCMPrimary=function(){return this.iGroup.getCMPrimary()},o.getOCMPrimary=function(){return this.iGroup.getOCMPrimary()},o.saveEditCell=function(n){var i=this.options,r=i.editModel;if(!r.indices)return null;var o,r=e.extend({},r.indices),n=n?n.evt:null,a=this.riOffset,l=r.colIndx,r=r.rowIndxPage,a=r+a,l=this.colModel[l],s=l.dataIndx,d=this.pdata[r],i=i.dataModel;if(null==d)return null;if(null!=r){var c=this.getEditCellData();if(e.isPlainObject(c))for(var u in o={},c)o[u]=d[u];else o=this.readCell(d,l);return"<br>"==c&&(c=""),r={rowIndx:a,rowIndxPage:r,dataIndx:s,column:l,newVal:c=null==o&&""===c?null:c,value:c,oldVal:o,rowData:d,dataModel:i},!1!==this._trigger("cellBeforeSave",n,r)&&(l={},e.isPlainObject(c)?l=c:l[s]=c,!1!==this.updateRow({row:l,rowIndx:a,silent:!0,source:"edit",checkEditable:!1})&&(this._trigger("cellSave",n,r),!0))}},o._digestNewRow=function(e,n,i,r,o,a,l,s,d){var c,u,h=this.getValueFromDataType,f=this.columns,p=this.colIndxs;for(c in e)if(u=f[c],g=p[c],u){if(a&&!1===this.isEditable({rowIndx:i,rowData:r,colIndx:g,column:u}))delete e[c],n&&delete n[c];else{var g=u.dataType,m=h(e[c],g),v=void 0!==(v=n?n[c]:void 0)?h(v,g):void 0;if(e[c]=m,l&&u.validations){if("edit"==d&&!1===s){var $=this.isValid({focusInvalid:!0,dataIndx:c,rowIndx:i,value:m});if(0==$.valid&&!$.warn)return!1}else!1!==($=this.iValid.isValidCell({column:u,rowData:"add"==o?e:r,allowInvalid:s,value:m})).valid||!1!==s||$.warn||delete e[c]}"update"==o&&m===v&&(delete e[c],delete n[c])}}return"update"!=o||!pq.isEmpty(e)||void 0},o._digestData=function(e){if(e.rowList)throw"not supported";if(q=e.addList=e.addList||[],e.updateList=e.updateList||[],e.deleteList=e.deleteList||[],q.length&&q[0].rowData)throw"rd in addList";if(!1===this._trigger("beforeValidate",null,e))return!1;for(var n,i,r,o=this,a=o.options,l=a.editModel,s=a.dataModel,d=s.data||[],s=s.dataUF||[],c=a.colModel,u=a.pageModel,h=a.historyModel,f=a.refreshCompareBy,p=o.iRenderB,g=c.map(function(e){return e.dataIndx}),m=(null==e.validate?l:e).validate,c="remote"==u.type,v=(null==e.allowInvalid?l:e).allowInvalid,l=a.trackModel,$=e.track,h=null==e.history?h.on:e.history,x=this.iHistory,w=this.iUCData,y=null==e.checkEditable||e.checkEditable,C=null==e.checkEditableAdd?y:e.checkEditableAdd,_=e.source,b=o.iRefresh,I=this.riOffset,q=e.addList,R=e.updateList,D=e.deleteList,M=[],T=[],$=null==$?null==a.track?l.on:a.track:$,k=0,S=R.length;k<S;k++){var E,P=R[k],A=P.newRow,H=P.rowData,F=P.checkEditable,O=P.rowIndx,V=P.oldRow;if(null==F&&(F=y),!V)throw"oldRow required while update";if(!1===(E=this._digestNewRow(A,V,O,H,"update",F,m,v,_)))return!1;E&&T.push(P)}for(k=0,S=q.length;k<S;k++){if(A=(P=q[k]).newRow,F=P.checkEditable,O=P.rowIndx,null==F&&(F=C),g.forEach(function(e){A[e]=A[e]}),!1===(E=this._digestNewRow(A,V,O,H,"add",F,m,v,_)))return!1;E&&M.push(P)}return q=e.addList=M,l=(R=e.updateList=T).length,a=q.length,r=D.length,a||l||r?(h&&(x.increment(),x.push(e)),l&&(!f||a||r||(n=p.saveValues(f)),o._digestUpdate(R,w,$)),r&&(o._digestDelete(D,w,$,d,s,u,c,I),b.addRowIndx()),a&&(o._digestAdd(q,w,$,d,u,c,I),b.addRowIndx()),o._trigger("change",null,e),(i=n?p.dirtyCells(n,f):i)||!0):"edit"==_&&null},o._digestUpdate=function(e,n,i){for(var r,o=0,a=e.length,l=this.columns,s=this.saveCell;o<a;o++){var d=e[o],c=d.newRow,u=d.rowData;for(r in i&&n.update({rowData:u,row:c,refresh:!1}),c)s(u,l[r],c[r])}},o._digestAdd=function(e,n,i,r,o,a,l){var s=0,d=e.length;for(e.sort(function(e,n){return e.rowIndx-n.rowIndx});s<d;s++){var c=e[s],u=c.newRow,h=c.rowIndx;i&&n.add({rowData:u}),null==h?r.push(u):r.splice(a?h-l:h,0,u),c.rowData=u,a&&o.totalRecords++}},o._digestDelete=function(e,n,i,r,o,a,l,s){for(var d,c=0,u=e.length;c<u;c++){var h=e[c],f=h.rowData,p=!1,g=r.indexOf(f);-1==g?0<=(g=o.indexOf(f))&&(p=!0):h.rowIndx=l?g+s:g,h.uf=p,h.indx=g}for(e.sort(function(e,n){return n.rowIndx-e.rowIndx}),c=0;c<u;c++)f=(h=e[c]).rowData,p=h.uf,d=h.rowIndx,g=h.indx,i&&n.delete({rowIndx:d,rowData:f}),p?o.splice(g,1):(d=r.splice(g,1))&&d.length&&l&&a.totalRecords--},o.refreshColumn=function(e){var n=this,i=n.normalize(e),e=n.iRenderB;i.skip=!0,e.eachV(function(e,r){i.rowIndxPage=r,n.refreshCell(i)}),n._trigger("refreshColumn",null,i)},o.refreshCell=function(e){var n=this,e=n.normalize(e),i=n._focusEle,r=e.rowIndxPage,o=e.colIndx;n.iRenderB.refreshCell(r,o,e.rowData,e.column)&&(i&&i.rowIndxPage==r&&n.focus(),e.skip||(n.refresh({soft:!0}),n._trigger("refreshCell",null,e)))},o.refreshHeaderCell=function(e){var e=this.normalize(e),n=this.headerCells,i=n.length-1,n=n[i];this.iRenderHead.refreshCell(i,e.colIndx,n,e.column)},o.refreshRow=function(e){var n,i,r,o;if(this.pdata)return i=(e=(n=this).normalize(e)).rowIndx,r=e.rowIndxPage,(e=e.rowData)?(n.iRenderB.refreshRow(r),n.refresh({soft:!0}),(o=n._focusEle)&&o.rowIndxPage==r&&n.focus(),n._trigger("refreshRow",null,{rowData:e,rowIndx:i,rowIndxPage:r}),!0):null},o.quitEditMode=function(e){var n,i,r,o,a,l;this._quitEditMode||(r=i=n=!1,a=(o=this.options.editModel).indices,this._quitEditMode=(l=void 0,!0),e&&(n=e.old,i=e.silent,r=e.fireOnly,l=e.evt),a&&(i||n||this._trigger("editorEnd",l,a),r||(this._removeEditOutline(e),o.indices=null)),this._quitEditMode=null)},o.getViewPortRowsIndx=function(){return{beginIndx:this.initV,endIndx:this.finalV}},o.getViewPortIndx=function(){var e=this.iRenderB;return{initV:e.initV,finalV:e.finalV,initH:e.initH,finalH:e.finalH}},o.getRIOffset=function(){return this.riOffset},o.getEditCell=function(){var e,n,i=this.options.editModel;return!0==is_japanese?{}:i.indices?(i=this.getCell(i.indices),n=(e=this.$div_focus.children(".pq-editor-inner")).find(".pq-editor-focus"),{$td:i,$cell:e,$editor:n}):{}},o.editCell=function(e){var n,i=this,r=i.normalize(e),e=i.iMerge,o=r.rowIndx,a=r.colIndx;if(e.ismergedCell(o,a)&&((e=e.getRootCellO(o,a)).rowIndx!=r.rowIndx||e.colIndx!=r.colIndx))return!1;i.scrollCell(r,function(){if((n=i.getCell(r))&&n.length)return i._editCell(r)})},o.getFirstEditableColIndx=function(e){if(null==e.rowIndx)throw"rowIndx NA";for(var n=this.colModel,i=0;i<n.length;i++)if(!n[i].hidden&&(e.colIndx=i,this.isEditable(e)))return i;return -1},o.editFirstCellInRow=function(e){var e=this.normalize(e).rowIndx,n=this.getFirstEditableColIndx({rowIndx:e});-1!=n&&this.editCell({rowIndx:e,colIndx:n})},o.getEditor=function(n,i){function r(e){return"function"==typeof e?e.call(o,a):e}var o=this,a=o.normalize(n),n=r(o.options.editor),l=r(a.column.editor),s=e.extend(!0,{},n,0==l?{type:!1}:l);return(i?[i]:["attr","cls","style","type"]).forEach(function(e){s[e]=r(s[e])||""}),i?s[i]:s},o._editCell=function(n){var r=this,n=r.normalize(n),a=n.evt,l=n.rowIndxPage,s=n.colIndx,d=r.pdata;if(!d||l>=d.length)return!1;var c=r.options,u=c.editModel,d=d[l],h=n.rowIndx,f=r.colModel[s],p=f.dataIndx,g=r.readCell(d,f),m={rowIndx:h,rowIndxPage:l,cellData:g,rowData:d,dataIndx:p,colIndx:s,column:f},v=!1,$=r.getEditor(m),x=$.type;if(0!=x){if(u.indices){var w,y=u.indices;if(y.rowIndxPage==l&&y.colIndx==s)return(w=r.$div_focus.find(".pq-editor-focus"))[0].focus(),document.activeElement!=w[0]&&window.setTimeout(function(){w.focus()},0),!1;if(!1===r.blurEditor({evt:a}))return!1;r.quitEditMode({evt:a})}u.indices={rowIndxPage:l,rowIndx:h,colIndx:s,column:f,dataIndx:p},r._generateEditorOutline(l,s,$),(y=r.$div_focus.children(".pq-editor-inner")).addClass("pq-align-"+(f.align||"left")),m.$cell=y;var C,n=(null==n.select?$:n).select,_=$.valueIndx,b=$.dataMap,I=$.mapIndices||{},q="pq-editor-focus "+$.cls,R=q+" pq-cell-editor ",D=$.attr,M=$.style,M=M?"style='"+M+"'":"",T=M,k=M,S=(m.cls=q,m.attr=D,"checkbox"==x?(q=$.subtype,y.html(C="<input "+(g?"checked='checked'":"")+" class='"+R+"' "+D+" "+k+" type=checkbox name='"+p+"' />"),k=y.children("input"),"triple"==q&&(k.pqval({val:g}),y.click(function(){e(this).children("input").pqval({incr:!0})}))):"textarea"==x||"select"==x||"textbox"==x||"contenteditable"==x?("textarea"==x?C="<textarea class='"+R+"' "+D+" "+T+" name='"+p+"' ></textarea>":"contenteditable"==x?(C="<div contenteditable='true' dataType='"+(f.dataType||"")+"' "+M+" "+D+" class='"+R+"' name='"+p+"'></div>",v=!0):C="select"==x?((q=$.options||[]).constructor!==Array&&(q=r.callFn(q,m)),k=[D," class='",R,"' ",T," name='",p,"'"].join(""),i.select({options:q,attr:k,prepend:$.prepend,labelIndx:$.labelIndx,valueIndx:_,groupIndx:$.groupIndx,dataMap:b})):"<input class='"+R+"' "+D+" "+T+" type=text name='"+p+"' />",e(C).appendTo(y).val("select"==x&&null!=_&&(I[_]||this.columns[_])?I[_]?d[I[_]]:d[_]:g)):x&&e("<"+x+" class='"+R+"' tabindex=0 "+D+" "+T+">").appendTo(y),m.$editor=y.children(".pq-editor-focus"),w=y.children(".pq-editor-focus"),u.filterKeys),M=r.getCell(u.indices),q=f.editModel,E=(q&&void 0!==q.filterKeys&&(S=q.filterKeys),"textarea"!=x&&"contenteditable"!=x&&M.empty(),{$cell:y,cellData:g,$editor:w,$td:M,dataIndx:p,column:f,colIndx:s,rowIndx:h,rowIndxPage:l,rowData:d,editor:$}),P=r.iKeyNav;if(r._trigger("editorBegin",a,E),u.indices=E,(w=y.children(".pq-editor-focus")).data({FK:S}).on("click",function(){e(this).focus(),r._trigger("editorClick",null,E)}).on("keydown",P.keyDownInEdit.bind(P)).on("keypress",function(e){return P.keyPressInEdit(e,{FK:S})}).on("keyup",function(e){return P.keyUpInEdit(e,{FK:S})}).on("blur",o._onBlur=function(n,i){var o=c.editModel,a=o.onBlur,l="save"==a,s=document.activeElement,d=e(n.target),u="validate"==a,h=o.cancelBlurCls,i=!!i&&i.force;if(!r._quitEditMode&&!r._blurEditMode&&o.indices){if(!i){if(!1===r._trigger("editorBlur",n,E)||!a||d[0]==s||h&&d.hasClass(h))return;if(d.hasClass("pq-autocomplete-text")){if(e("."+d.data("id")).is(":visible"))return}else if(d.hasClass("hasDatepicker")){if(d.datepicker("widget").is(":visible"))return!1}else if(d.hasClass("ui-autocomplete-input")){if(d.autocomplete("widget").is(":visible"))return}else if(d.hasClass("ui-multiselect")){if(e(".ui-multiselect-menu").is(":visible")||e(s).closest(".ui-multiselect-menu").length)return}else if(d.hasClass("pq-select-button")){if(e(".pq-select-menu").is(":visible")||e(s).closest(".pq-select-menu").length)return}else if($.preventClose&&$.preventClose.call(r,E))return}if(r._blurEditMode=!0,o=i||l||!u,!r.saveEditCell({evt:n,silent:o})&&!i&&u)return r._deleteBlurEditMode(),!1;r.quitEditMode({evt:n}),r._deleteBlurEditMode()}}).on("focus",function(e){r._trigger("editorFocus",e,E)}),w.focus(),window.setTimeout(function(){!1===e(document.activeElement).hasClass("pq-editor-focus")&&(r.element?r.element.find(".pq-editor-focus"):e()).focus()}),n){if(v)try{var A=document.createRange(),H=window.getSelection();A.selectNodeContents(w[0]),H.removeAllRanges(),H.addRange(A)}catch(F){}else w.select()}}},o._deleteBlurEditMode=function(e){var n=this;e=e||{},n._blurEditMode&&(e.timer?window.setTimeout(function(){delete n._blurEditMode},0):delete n._blurEditMode)},o.getRow=function(e){return e=this.normalize(e).rowIndxPage,this.iRenderB.get$Row(e)},o.getCell=function(n){0<=n.vci&&(n.colIndx=this.iCols.getci(n.vci));var n=this.normalize(n),i=n.rowIndxPage,n=n.colIndx,i=this.iRenderB.getCell(i,n);return e(i)},o.getCellHeader=function(n){0<=n.vci&&(n.colIndx=this.iCols.getci(n.vci));var n=this.normalize(n),i=n.colIndx,n=n.ri,n=0<=n?n:this.headerCells.length-1,n=this.iRenderHead.getCell(n,i);return e(n)},o.getCellFilter=function(e){return e.ri=this.headerCells.length,this.getCellHeader(e)},o.getEditorIndices=function(){var n=this.options.editModel.indices;return n?e.extend({},n):null},o.getEditCellData=function(){var e=this.options.editModel.indices;if(!e)return null;var n=e.colIndx,n=this.colModel[n],i=this.getEditor(e),r=i.valueIndx,o=i.labelIndx,a=i.mapIndices||{},n=n.dataIndx,l=this.$div_focus.children(".pq-editor-inner"),s=i.getData;if(s)d=this.callFn(s,e);else if("checkbox"==(s=i.type))var e=l.children(),d="triple"==i.subtype?e.pqval():!!e.is(":checked");else if((e=l.find('*[name="'+n+'"]'))&&e.length){if("select"==s&&null!=r){if(a[r]||this.columns[r]){(d={})[a[r]||r]=e.val(),d[a[o]||o]=e.find("option:selected").text();var c=i.dataMap;if(c){var u=e.find("option:selected").data("map");if(u)for(var h=0;h<c.length;h++){var f=c[h];d[a[f]||f]=u[f]}}}else d=e.val()}else d=e.val()}else(e=l.find(".pq-editor-focus"))&&e.length&&(d=e.val());return d},o.getCellIndices=function(e){var n,e=e.$td,i={};return e&&e.length&&e.closest(".pq-body-outer")[0]==this.$cont[0]&&(e=this.iRenderB.getCellIndx(e[0]))&&(n=e[0]+this.riOffset,i=this.iMerge.getRootCellO(n,e[1],!0)),i},o.getRowsByClass=function(e){var n=this.options,i=n.dataModel,r="remote"==n.pageModel.type,o=this.riOffset,a=i.data,l=[];if(null==a)return l;for(var s=0,d=a.length;s<d;s++){var c,u,h=a[s];h.pq_rowcls&&(e.rowData=h,this.hasClass(e)&&(u=(c=r?s+o:s)-o,(h={rowData:h}).rowIndx=c,h.rowIndxPage=u,l.push(h)))}return l},o.getCellsByClass=function(e){var n=this.options,i=n.dataModel,r="remote"==n.pageModel.type,o=this.riOffset,a=i.data,l=[];if(null==a)return l;for(var s=0,d=a.length;s<d;s++){var c=a[s],u=r?s+o:s,h=c.pq_cellcls;if(h)for(var f in h){var f={rowData:c,rowIndx:u,dataIndx:f,cls:e.cls};this.hasClass(f)&&(f=this.normalize(f),l.push(f))}}return l},o.data=function(n){var i=n.colIndx,i=(null!=i?this.colModel[i]:n).dataIndx,r=n.data,o=null==r||"string"==typeof r,n=n.rowData||this.getRowData(n);if(!n)return{data:null};if(null==i){var a=n.pq_rowdata;if(o)return{data:l=null!=a?null==r?a:a[r]:l};a=e.extend(!0,n.pq_rowdata,r),n.pq_rowdata=a}else{var l,s=n.pq_celldata;if(o)return null!=s&&(o=s[i],l=null==r||null==o?o:o[r]),{data:l};s||(n.pq_celldata={}),a=e.extend(!0,n.pq_celldata[i],r),n.pq_celldata[i]=a}},o.attr=function(n){var i=n.rowIndx,r=n.colIndx,r=(null!=r?this.colModel[r]:n).dataIndx,o=n.attr,a=null==o||"string"==typeof o,l=n.refresh,n=n.rowData||this.getRowData(n);if(!n)return{attr:null};if(a||!1===l||null!=i||(i=this.getRowIndx({rowData:n}).rowIndx),null==r){var s=n.pq_rowattr;if(a)return{attr:d=null!=s?null==o?s:s[o]:d};s=e.extend(!0,n.pq_rowattr,o),n.pq_rowattr=s,!1!==l&&null!=i&&this.refreshRow({rowIndx:i})}else{var d,c=n.pq_cellattr;if(a)return null!=c&&(a=c[r],d=null==o||null==a?a:a[o]),{attr:d};c||(n.pq_cellattr={}),s=e.extend(!0,n.pq_cellattr[r],o),n.pq_cellattr[r]=s,!1!==l&&null!=i&&this.refreshCell({rowIndx:i,dataIndx:r})}},o.processAttr=function(e,n){var i,r,o="";if("string"==typeof e)o=e;else if(e){for(i in e)if(r=e[i]){if("title"==i)r=r.replace(/"/g,"&quot;");else{if("style"==i){n&&n.push(r);continue}"object"==typeof r&&(r=JSON.stringify(r))}o+=i+'="'+r+'"'}}return o},o.removeData=function(n){var i=n.colIndx,i=(null!=i?this.colModel[i]:n).dataIndx,r=n.data,o="string"==typeof(r=null==r?[]:r)?r.split(" "):r,a=o.length,r=n.rowData||this.getRowData(n);if(r){if(null==i){var l=r.pq_rowdata;if(l){if(a)for(var s=0;s<a;s++)delete l[o[s]];a&&!e.isEmptyObject(l)||delete r.pq_rowdata}}else if((n=r.pq_celldata)&&n[i]){var d=n[i];if(a)for(s=0;s<a;s++)delete d[o[s]];a&&!e.isEmptyObject(d)||delete n[i]}}},o.removeAttr=function(n){var i=n.rowIndx,r=n.dataIndx,o=n.colIndx,r=null!=o?this.colModel[o].dataIndx:r,o=n.attr,a="string"==typeof(o=null==o?[]:o)?o.split(" "):o,l=a.length,s=i-this.riOffset,d=n.refresh,n=n.rowData||this.getRowData(n);if(n){if(!1!==d&&null==i&&(i=this.getRowIndx({rowData:n}).rowIndx),null==r){var c=n.pq_rowattr;if(c){if(l)for(var u=0;u<l;u++){var h=a[u];delete c[h]}else for(h in c)a.push(h);l&&!e.isEmptyObject(c)||delete n.pq_rowattr}!1!==d&&null!=i&&a.length&&(o=a.join(" "),(f=this.getRow({rowIndxPage:s}))&&f.removeAttr(o))}else{var f=n.pq_cellattr;if(f&&f[r]){var p=f[r];if(l)for(u=0;u<l;u++)delete p[h=a[u]];else for(h in p)a.push(h);l&&!e.isEmptyObject(p)||delete f[r]}!1!==d&&null!=i&&a.length&&(o=a.join(" "),(n=this.getCell({rowIndxPage:s,dataIndx:r}))&&n.removeAttr(o))}}},o.normalize=function(e,n){var i,r,o={};for(r in e)o[r]=e[r];var a=o.rowIndx,l=o.rowIndxPage,s=o.dataIndx,d=o.colIndx;return null==l&&null==a||(i=this.riOffset,a=null==a?+l+i:a,l=null==l?+a-i:l,o.rowIndx=a,o.rowIndxPage=l,o.rowData=o.rowData||n&&n[a]||this.getRowData(o)),null==d&&null==s||(i=this.colModel,s=null==s?i[d]?i[d].dataIndx:void 0:s,d=null==d?this.colIndxs[s]:d,o.column=i[d],o.colIndx=d,o.dataIndx=s),o},o.normalizeList=function(e){var n=this,i=n.get_p_data();return e.map(function(e){return n.normalize(e,i)})},o.addClass=function(e){var e=this.normalize(e),n=e.rowIndxPage,i=e.dataIndx,r=pq.arrayUnique,o=e.cls,a=e.refresh,e=e.rowData;if(e){if(!1!==a&&null==n&&(n=this.getRowIndx({rowData:e}).rowIndxPage),null==i){var l,s=e.pq_rowcls;l=r((l=s?s+" "+o:o).split(/\s+/)).join(" "),e.pq_rowcls=l,!1===a||null==n||!this.SelectRow().inViewRow(n)||(s=this.getRow({rowIndxPage:n}))&&s.addClass(o)}else{var d=[];"function"!=typeof i.push?d.push(i):d=i;for(var c=(c=e.pq_cellcls)||(e.pq_cellcls={}),u=0,h=d.length;u<h;u++){var f=c[i=d[u]];l=r((l=f?f+" "+o:o).split(/\s+/)).join(" "),c[i]=l,!1===a||null==n||!this.SelectRow().inViewRow(n)||(f=this.getCell({rowIndxPage:n,dataIndx:i}))&&f.addClass(o)}}}},o.removeClass=function(e){var e=this.normalize(e),n=e.rowIndx,i=e.rowData,r=e.dataIndx,o=e.cls,a=e.refresh;if(i){var l=i.pq_cellcls,e=i.pq_rowcls;if(!1!==a&&null==n&&(n=this.getRowIndx({rowData:i}).rowIndx),null==r)e&&(i.pq_rowcls=this._removeClass(e,o),null!=n&&!1!==a&&(e=this.getRow({rowIndx:n}))&&e.removeClass(o));else if(l){var s=[];"function"!=typeof r.push?s.push(r):s=r;for(var d=0,c=s.length;d<c;d++){var u=l[r=s[d]];u&&(i.pq_cellcls[r]=this._removeClass(u,o),null!=n&&!1!==a&&(u=this.getCell({rowIndx:n,dataIndx:r}))&&u.removeClass(o))}}}},o.hasClass=function(e){var n,i=e.dataIndx,r=e.cls,e=this.getRowData(e),r=RegExp("\\b"+r+"\\b");return e?null==i?!(!(n=e.pq_rowcls)||!r.test(n)):!!((n=e.pq_cellcls)&&n[i]&&r.test(n[i])):null},o._removeClass=function(e,n){if(e&&n){for(var i=e.split(/\s+/),r=n.split(/\s+/),o=[],a=0,l=i.length;a<l;a++){for(var s=i[a],d=!1,c=0,u=r.length;c<u;c++)if(s===r[c]){d=!0;break}d||o.push(s)}return 1<o.length?o.join(" "):1===o.length?o[0]:null}},o.getRowIndx=function(e){var n,i=e.$tr,r=e.rowData,o=this.riOffset;if(r){if(null!=(l=r.pq_ri))return{rowData:r,rowIndx:l,rowIndxPage:l-o};var a=this.get_p_data(),l=!1,s=e.dataUF?this.options.dataModel.dataUF:null,d=!1;if(a){for(var c=0,u=a.length;c<u;c++)if(a[c]==r){d=!0;break}}if(!d&&s){for(l=!0,c=0,u=s.length;c<u;c++)if(s[c]==r){d=!0;break}}return d?(n=c-o,{rowIndxPage:l?void 0:n,uf:l,rowIndx:c,rowData:r}):{}}return null==i||0==i.length||null==(n=this.iRenderB.getRowIndx(i[0])[0])?{}:{rowIndxPage:n,rowIndx:n+o}},o.search=function(e){for(var n=this.options,i=e.row,r=e.first,e=n.dataModel,n=n.pageModel.type,o=[],a=this.riOffset,l="remote"==n,s=e.data,d=0,c=s.length;d<c;d++){var u,h=s[d],f=!0;for(u in i)i[u]!==h[u]&&(f=!1);if(f){var p=this.normalize({rowIndx:l?d+a:d});if(o.push(p),r)break}}return o},o._getFirstRC=function(e,n,i,r,o){for(var n=this[n],a=0,l=this.options[i],s=e?this.iRenderB[r]:l,d=n.length;a<d;a++)if(!n[a=a==l?s:a][o])return a},o.getFirstVisibleRIP=function(e){return this._getFirstRC(e,"pdata","freezeRows","initV","pq_hidden")},o.getFirstVisibleCI=function(e){return this._getFirstRC(e,"colModel","freezeCols","initH","hidden")},o.getLastVisibleRIP=function(){for(var e=this.pdata,n=e.length-1;0<=n;n--)if(!e[n].pq_hidden)return n;return null},o.getLastVisibleCI=function(){return this.iCols.getLastVisibleCI()},o.getNextVisibleCI=function(e){return this.iCols.getNextVisibleCI(e)},o.getPrevVisibleCI=function(e){return this.iCols.getPrevVisibleCI(e)},o.getPrevVisibleRIP=function(e){return this.iKeys.getPrevVisibleRIP(e)},o.getNextVisibleRIP=function(e){return this.iKeys.getNextVisibleRIP(e)},o.calcWidthCols=function(e,n){var i,r=0,o=this.options.numberCell,a=this.colModel;-1==e&&(o.show&&(r+=+o.width),e=0);for(var l=e;l<n;l++)if((i=a[l])&&!i.hidden){if(!i._width)throw"assert failed";r+=i._width}return r}}(jQuery),function(e){(e.paramquery.cKeyNav=function(e){this.that=e}).prototype={bodyKeyDown:function(n){function i(e){return b==e}function r(){return d.getFirstVisibleCI()}function o(){return d.getLastVisibleCI()}function a(){return d.getFirstVisibleRIP()}function l(){return d.getLastVisibleRIP()}var s=this,d=s.that,c=d.riOffset,u=d.options,h=u.rtl,f=d.iMerge,p=e(n.target),g=d._fe,m=d.colModel,v=u.selectionModel,$=u.editModel,x=d.$cont[0],p=p[0]==x,x=pq.isCtrl(n),w=e.ui.keyCode,y=w.LEFT,C=w.RIGHT,_=w.TAB,b=n.keyCode,y=b==y,C=b==C,I=i(w.HOME),q=i(w.END),_=b==_,R=i(w.SPACE),D=i(w.PAGE_UP),M=i(w.PAGE_DOWN),T=n.shiftKey,k=i(w.UP),S=i(w.DOWN);if($.indices)d.$div_focus.find(".pq-cell-focus").focus();else{if(p&&!g&&_&&!T)return A=d.getViewPortIndx(),void d.focus({rowIndxPage:A.initV,colIndx:A.initH});if(R&&p)return!1;var E,P,A=d.normalize(g),R=A.rowIndxPage,H=A.rowIndx,F=A.colIndx,p=d.pdata,g=A,O=!0;if(null!=H&&null!=F&&null!=A.rowData){if(f.ismergedCell(H,F)&&(R=(A=g=f.getRootCellO(H,F)).rowIndxPage,H=A.rowIndx,F=A.colIndx,(D||M||I||q)&&(A=f.getData(H,F,"proxy_cell"))&&!p[f=A.rowIndx-c].pq_hidden&&(H=(R=f)+c),m[F].hidden&&(F=d.getNextVisibleCI(F))),0==d._trigger("beforeCellKeyDown",n,g))return!1;d._trigger("cellKeyDown",n,g),I||x&&y?(x&&I&&(H=a()+c),F=(h?o:r)(),s.select(H,F,n)):q||x&&C?(x&&q&&(H=l()+c),F=(h?r:o)(),s.select(H,F,n)):y||C||k||S||v.onTab&&_?((y&&!h||C&&h)&&F!=r()||_&&T?(E=s.incrIndx(R,F,!1))||pq.focusEle(!0)&&n.preventDefault():(C&&!h||y&&h)&&(F!=o()||u.autoAddCol)||_&&!T?(!_&&u.autoAddCol&&F==o()&&d.Columns().add([{}]),E=s.incrIndx(R,F,!0)):k?E=x?{rowIndxPage:a(),colIndx:F}:s.incrRowIndx(R,F,!1):S&&(E=x?{rowIndxPage:l(),colIndx:F}:(u.autoAddRow&&R==l()&&d.addNodes([{}]),s.incrRowIndx(R,F,!0))),E?(H=E.rowIndxPage+c,s.select(H,E.colIndx,n)):O=!1):M||D?d.iRenderB[D?"pageUp":"pageDown"](R,function(e){H=e+c,s.select(H,F,n)}):b==w.ENTER?(P=d.getCell(g))&&P[0]&&(d.isEditable(g)?d.editCell(g):(p=P.find("button"))[0]&&e(p[0]).click()):x&&"65"==b?(A=d.iSelection,"row"==v.type&&"single"!=v.mode?d.iRows.toggleAll({all:v.all}):"cell"==v.type&&"single"!=v.mode&&A.selectAll({type:"cell",all:v.all})):x?O=!1:$.pressToEdit&&this.isEditKey(b)&&!x&&(46==b?d.clear():("select"==d.getEditor(g,"type")&&(R=g.rowIndxPage,F=g.colIndx,(P=d.getCell(g))&&P[0]&&d.isEditable(g)&&d.editCell({rowIndxPage:R,colIndx:F,select:!0})),O=!1)),O&&n.preventDefault()}}},getPrevVisibleRIP:function(e){for(var n=this.that.pdata,i=e-1;0<=i;i--)if(!n[i].pq_hidden)return i;return e},setDataMergeCell:function(e,n){var i,r=this.that.iMerge;r.ismergedCell(e,n)&&(i=r.getRootCellO(e,n),r.setData(i.rowIndx,i.colIndx,{proxy_cell:{rowIndx:e,colIndx:n}}))},getValText:function(n){var n=n[0].nodeName.toLowerCase(),i="text";return -1!=e.inArray(n,["input","textarea","select"])?"val":i},getNextVisibleRIP:function(e){for(var n=this.that.pdata,i=e+1,r=n.length;i<r;i++)if(!n[i].pq_hidden)return i;return e},incrEditIndx:function(e,n,i){var r=this.that,o=r.colModel,a=o.length,l=r.iMerge,s=r.riOffset,d=r[i?"getLastVisibleRIP":"getFirstVisibleRIP"]();do{var c,u=e+s;if(n=l.ismergedCell(u,n)?(c=l.getRootCell(u,n),(h=l.getData(u,n,"proxy_edit_cell"))&&(e=(u=h.rowIndx)-s),i?n+c.o_cc:n-1):i?n+1:n-1,i&&a<=n||!i&&n<0){if(e==d)return null;e=this[i?"getNextVisibleRIP":"getPrevVisibleRIP"](e),n=i?0:a-1}l.ismergedCell(u=e+s,n)&&(c=l.getRootCellO(u,n),l.setData(c.rowIndx,c.colIndx,{proxy_edit_cell:{rowIndx:u,colIndx:n}}),u=c.rowIndx,n=c.colIndx);var h=o[n],f=r.isEditable({rowIndx:u,colIndx:n}),p="function"==typeof(p=h.editor)?p.call(r,r.normalize({rowIndx:u,colIndx:n})):p}while(e=u-s,h&&(h.hidden||0==f||!1===p));return{rowIndxPage:e,colIndx:n}},incrIndx:function(e,n,i){var r,o,a,l,s,d=this.that,c=d.iMerge,u=e,h=n,f=d.pdata,p=d.riOffset,g="get"+(i?"Last":"First")+"Visible",m=d[g+"RIP"](),g=d[g+"CI"](),v=d.colModel,$=v.length;if(null==h)u!=m&&(s={rowIndxPage:u=this[i?"getNextVisibleRIP":"getPrevVisibleRIP"](u)});else if(h==g)(s=this.incrRowIndx(u,h,i)).rowIndxPage!=u&&(s.colIndx=d["get"+(i?"First":"Last")+"VisibleCI"]());else{for(;c.ismergedCell(o=u+p,h)&&(r=c.getRootCell(o,h),f[u=!l&&(a=c.getData(r.o_ri,r.o_ci,"proxy_cell"))&&!f[a=a.rowIndx-p].pq_hidden?a:u].pq_hidden&&(u=c.getRootCellV(o,h).rowIndxPage),!l&&i&&(h=r.o_ci+(r.o_cc?r.o_cc-1:0))),i?h<$-1&&h++:0<h&&h--,(l=v[h])&&l.hidden;);s={rowIndxPage:u,colIndx:h}}if(s.rowIndxPage!=e||s.colIndx!=n)return s},incrRowIndx:function(e,n,i){var r=this.that,o=r.riOffset,a=e+o,r=r.iMerge;return r.ismergedCell(a,n)&&(a=r.getRootCell(a,n),r=r.getData(a.o_ri,a.o_ci,"proxy_cell"),i&&(e=a.o_ri-o+a.o_rc-1),n=r?r.colIndx:a.v_ci),{rowIndxPage:e=this["get"+(i?"Next":"Prev")+"VisibleRIP"](e),colIndx:n}},isEditKey:function(e){return 32<=e&&e<=127||189==e||190==e},keyDownInEdit:function(n){var i=this.that,r=i.options,o=r.editModel.indices;if(o){var a=e(n.target),l=e.ui.keyCode,s=r.editModel,d=(o=e.extend({},o)).rowIndxPage,c=o.colIndx,u=o.column.editModel,u=u?e.extend({},s,u):s,s=this.getValText(a);return a.data("oldVal",a[s]()),0!=i._trigger("editorKeyDown",n,o)&&((s=n.keyCode)!=l.TAB&&(s!=u.saveKey||n.altKey)?s==l.ESCAPE?(i.quitEditMode({evt:n}),i.focus({rowIndxPage:d,colIndx:c}),n.preventDefault(),!1):s==l.PAGE_UP||s==l.PAGE_DOWN?(n.preventDefault(),!1):!u.keyUpDown||n.altKey||s!=l.DOWN&&s!=l.UP?void 0:(o=this.incrRowIndx(d,c,s==l.DOWN),this.saveAndMove(o,n)):(o="downFocus"==(u=s==l.TAB?u.onTab:u.onSave)?(r.autoAddRow&&d==i.getLastVisibleRIP()&&i.addNodes([{}]),this.incrRowIndx(d,c,!n.shiftKey)):{rowIndxPage:d,colIndx:c,incr:!!u,edit:"nextEdit"==u},a.hasClass("ui-autocomplete-input")&&a.autocomplete("widget").is(":visible")&&s==l.ENTER?void 0:this.saveAndMove(o,n)))}},keyPressInEdit:function(n,i){var r=this.that,o=r.options.editModel,a=o.indices,i=(i||{}).FK,l=a.column,s=e.ui.keyCode,d=["BACKSPACE","LEFT","RIGHT","UP","DOWN","DELETE","HOME","END"].map(function(e){return s[e]}),l=l.dataType;return 0<=e.inArray(n.keyCode,d)||!1!==r._trigger("editorKeyPress",n,e.extend({},a))&&(!i||"float"!=l&&"integer"!=l||(d=a.$editor.val(),r=o.charsAllow["float"==l?0:1],a=String.fromCharCode(i=n.charCode||n.keyCode),"="===d[0]||!a||-1!=r.indexOf(a)))},keyUpInEdit:function(n,i){var r=this.that,o=r.options,i=(i||{}).FK,o=o.editModel,a=o.indices;r._trigger("editorKeyUp",n,e.extend({},a));var l,r=a.column.dataType;i&&("float"==r||"integer"==r)&&(a=e(n.target),i="integer"==r?o.reInt:o.reFloat,n=this.getValText(a),o=a.data("oldVal"),l=a[n](),0==i.test(l)&&"="!==l[0]&&(i.test(o)?a[n](o):(l=("float"==r?parseFloat:parseInt)(o),isNaN(l)?a[n](0):a[n](l))))},saveAndMove:function(e,n){if(null==e)return n.preventDefault(),!1;var i,r,o=this,a=o.that,l=e.rowIndxPage,s=e.colIndx;return(a._blurEditMode=!0,!1!==a.saveEditCell({evt:n})&&a.pdata)?(a.quitEditMode(n),e.incr&&(l=(r=o[e.edit?"incrEditIndx":"incrIndx"](l,s,!n.shiftKey))?r.rowIndxPage:l,s=r?r.colIndx:s),a.scrollCell({rowIndxPage:l,colIndx:s},function(){i=l+a.riOffset,o.select(i,s,n),e.edit&&a._editCell({rowIndxPage:l,colIndx:s})}),a._deleteBlurEditMode({timer:!0,msg:"saveAndMove"})):(a.pdata||a.quitEditMode(n),a._deleteBlurEditMode({timer:!0,msg:"saveAndMove saveEditCell"})),n.preventDefault(),!1},select:function(n,i,r){var o=this.that,a=n-o.riOffset,l=(this.setDataMergeCell(n,i),o.options),s=o.iSelection,d=l.selectionModel,l=d.type,c="row"==l,u="cell"==l;o.scrollCell({rowIndx:n,colIndx:i},function(){var l,h,f,p,g=s.address();r.shiftKey&&r.keyCode!==e.ui.keyCode.TAB&&d.type&&"single"!=d.mode&&(g.length||c)?c?o.iRows.extend({rowIndx:n,evt:r}):(h=(l=g[g.length-1]).firstR,f=l.firstC,"column"==(p=l.type)?(l.c1=f,l.c2=i,l.r1=l.r2=l.type=l.cc=l.rc=void 0,o.Range(g,!1).select()):"row"==p?s.resizeOrReplace({r1:h,r2:n,firstR:h,firstC:f}):s.resizeOrReplace({r1:h,c1:f,r2:n,c2:i,firstR:h,firstC:f})):c||u&&o.Range({r1:n,c1:i,firstR:n,firstC:i}).select(),o.focus({rowIndxPage:a,colIndx:i})})}}}(jQuery),function(e){var n,i;(e.paramquery.cGenerateView=function(){}).prototype={autoFitCols:function(){var e=this.that,n=e.colModel,i=n.length,r=this.dims,e=e.calcWidthCols(-1,i,!0),o=this.getSBWd(),r=r.wdCenter-o;if(e!==r){for(var a,l=e-r,s=[],d=0;d<i;d++){var c=(f=n[d])._percent,u=(f.resizable,f._resized);f.hidden||c||u||(l<0?(m=f._maxWidth-f._width)&&s.push({availWd:-1*m,colIndx:d}):(m=f._width-f._minWidth)&&s.push({availWd:m,colIndx:d})),u&&delete(a=f)._resized}s.sort(function(e,n){return e.availWd>n.availWd?1:e.availWd<n.availWd?-1:0});for(var d=0,h=s.length;d<h;d++){var f,p,g=s[d],m=g.availWd,g=g.colIndx,v=Math.round(l/(h-d)),g=(f=n[g])._width;Math.abs(m)>Math.abs(v)?(p=g-v,l-=v):(p=g-m,l-=m),f.width=f._width=p}0!=l&&a&&((p=a._width-l)>a._maxWidth?p=a._maxWidth:p<a._minWidth&&(p=a._minWidth),a.width=a._width=p)}},numericVal:function(e,n){return Math.round(n=-1<(e+"").indexOf("%")?parseInt(e)*n/100:parseInt(e))},refreshColumnWidths:function(e){e=e||{};var n=this.that,i=n.options,r=i.numberCell,o="flex"===i.width,a=n.colModel,l=this.autoFit,s=this.dims.wdCenter,d=a.length,c=i.minColWidth,u=i.maxColWidth,h=0,f=(r.show&&(r.width<r.minWidth&&(r.width=r.minWidth),h=r.outerWidth=r.width),o?null:+s-h),c=Math.floor(this.numericVal(c,f)),u=Math.ceil(this.numericVal(u,f)),p=0;if(!o&&f<5||isNaN(f)){if(i.debug)throw"availWidth N/A"}else{delete n.percentColumn;for(var g=0;g<d;g++){var m,v,$,x,w,y,C=a[g];C.hidden||(v=-1<((m=C.width)+"").indexOf("%")||null,$=C.minWidth,x=C.maxWidth,$=$?this.numericVal($,f):c,(x=x?this.numericVal(x,f):u)<$&&(x=$),null!=m?(y=0,!o&&v?(n.percentColumn=!0,C.resizable=!1,C._percent=!0,1<=(p+=(w=+this.numericVal(m,f))-(y=Math.floor(w)))&&(y+=1,--p)):m&&(y=+m),y<$?y=$:x<y&&(y=x),C._width=y):C._width=$,v||(C.width=C._width),C._minWidth=$,C._maxWidth=o?1e3:x)}!1==o&&!1!==e.refreshWidth&&l&&this.autoFitCols()}},format:(n=e.datepicker,i=pq.formatNumber,function(e,r){return"function"==typeof r?r(e):pq.isDateFormat(r)?e==parseInt(e)?pq.formulas.TEXT(e,pq.juiToExcel(r)):isNaN(Date.parse(e))?void 0:n.formatDate(r,new Date(e)):e==parseFloat(e)?i(e,r):void 0}),renderCell:function(e){var n,i,r,o,a,l,s=this.that,d=e.attr||[],c=e.style||[],u=e.Export,h=s.options,f=e.cls||[],p=e.rowData,g=e.column,m=g.dataIndx,v=(p.pq_celldt||{})[m]||g.dataType,$="pic"==v,x=e.colIndx,w=pq.styleStr,y=s.processAttr,C=g.style||{},_=p.pq_rowstyle,b=(p.pq_cellprop||{})[m]||{},I=p.pq_rowprop||{},q=h.freezeCols,R=h.columnBorders;if(p)return a=p[m],u||(C&&c.push(w(C)),_&&c.push(w(_)),(C=(p.pq_cellstyle||{})[m])&&c.push(w(C)),x==q-1&&R&&f.push("pq-last-frozen-col"),g.cls&&f.push(g.cls),h.editModel.addDisableCls&&!1===s.isEditable(e)&&f.push("pq-cell-disable"),$?a=a&&("data"==a.substr(0,4)||"http"==a.substr(0,4))?'<img style="max-height:100%;max-width:100%;" src = "'+a+'" />':a:"string"==typeof a&&"html"!=v&&(a=pq.escapeHtml(a))),C=(_=h.format.call(s,p,g,b,I))?this.format(a,_,v):a,e.dataIndx=m,e.cellData=a,e.formatVal=C,(x=g.render)&&(l=s.callFn(x,e))&&"string"!=typeof l&&((n=l.attr)&&d.push(y(n)),o=l.prop,(r=l.cls)&&f.push(r),(i=l.style)&&c.push(w(i)),l=l.text),(l=null==l&&(x=g._renderG||g._render)?x.call(s,e):l)&&"string"!=typeof l&&((n=l.attr)&&d.push(n),(r=l.cls)&&f.push(r),(i=l.style)&&c.push(w(i)),l=l.text),null==l&&(l=C||a),u?[l,i,o,(n||{}).title]:((q=(o=o||{}).align||b.align||I.align||g.align)&&f.push("pq-align-"+q),(q=o.valign||b.valign||I.valign||g.valign)&&f.push("pq-valign-"+q),(R=(p.pq_cellcls||{})[m])&&f.push(R),(h=(p.pq_cellattr||{})[m])&&d.push(y(h,c)),c=c.length?" style='"+c.join("")+"' ":"",null==(l=pq.newLine(l))&&(l=""),["<div class='",f.join(" "),"' ",d.join(" "),c," >",$?l:"<div>"+l+"</div>","</div>"].join(""))}}}(jQuery),function(e){var n=e.paramquery,i=n._pqGrid.prototype;i.getHeadCell=function(e){var n,i,r,e=this.iRenderHead.getCellIndx(e[0]),o=e[0],e=e[1];return(r=null!=e&&null!=o&&(i=(i=this.headerCells[o])&&i[e])?i.colModel:r)&&r.length&&(n=!0),{col:i||this.colModel[e],ci:e,ri:o,isParent:n}},i.flex=function(e){var n=this.colIndxs;e&&e.dataIndx&&(e.colIndx=e.dataIndx.map(function(e){return n[e]})),this.iResizeColumns.flex(e)},n.mixHeader={colCollapse:function(e,n){var i=this.that,r={column:e},e=e.collapsible;!1!==i._trigger("beforeColumnCollapse",n,r)&&(e.on=!e.on,!1!==i._trigger("columnCollapse",n,r)&&i.refresh({colModel:!0}))},onHeaderClick:function(n){var i,r=this.that,o=r.iDragColumns;if(r._trigger("headerClick",n),!o||"stop"==o.status){if((o=e(n.target)).is("input,label"))return!0;if((i=o.closest(".pq-grid-col,.pq-grid-number-cell")).length){if(i=(r=r.getHeadCell(i)).col,o.hasClass("pq-col-collapse"))this.colCollapse(i,n);else if(!r.isParent)return this.onHeaderCellClick(i,r.ci,n)}}},getTitle:function(e,n){var i=e.title;return"function"==typeof i?i.call(this.that,{column:e,colIndx:n,dataIndx:e.dataIndx}):i},createHeaderCell:function(e){var n,i=this.that,r=i.options,o=e.cls,a=e.style,l=e.attr,s=e.column,d=e.colIndx,c=this.getSortSpaceSpans(r.sortModel),u=s.collapsible,h=pq.styleStr,f=s.halign||s.align,p=s.hvalign,g=s.cls,m=s.colModel,r=this.hasMenuH(r,s),d=null!=(d=this.getTitle(s,d))?d:s.dataIndx;return f&&o.push("pq-align-"+f),p&&o.push("pq-valign-"+p),(f=s.styleHead)&&a.push(h(f)),(f=s.attrHead)&&l.push(i.processAttr(f)),g&&o.push(g),o.push(s.clsHead),r&&o.push("pq-has-menu"),m&&m.length?u&&(o.push("pq-collapsible-th"),n=["<span class='pq-col-collapse pq-icon-hover ui-icon ui-icon-",u.on?"plus":"minus","'></span>"].join("")):o.push("pq-grid-col-leaf"),l.push("pq-row-indx="+e.rowIndx+" pq-col-indx="+e.colIndx),s.pq_title=d,["<div ",l.join(" ")," "," class='",o.join(" "),"' style='",a.join(""),"' >","<div class='pq-td-div'>",n,"<span class='pq-title-span'>",d,"</span>",c,"</div>",r?"<span class='pq-menu-icon'></span>":"","</div>"].join("")},getSortSpaceSpans:function(e){var n=e.space?" pq-space":"";return["<span class='pq-col-sort-icon",n,"'></span>",e.number?"<span class='pq-col-sort-count"+n+"'></span>":""].join("")},hasMenuH:function(e,n){var i=n.colModel;return(!i||!i.length)&&(i=e.menuIcon,e=n.menuIcon,i&&!1!==e||!1!==i&&e)},onHeaderCellClick:function(n,i,r){var o,a,l,s=this.that,d=s.options,c=d.sortModel,u=(n=n||{}).dataIndx;!1!==s._trigger("headerCellClick",r,{column:n,colIndx:i,dataIndx:u})&&-1!=i&&(d.selectionModel.column&&-1==r.target.className.indexOf("pq-title-span")?(d={c1:i,firstC:i,firstR:s.getFirstVisibleRIP()},a=(o=(l=s.iSelection).address()).length,pq.isCtrl(r)?l.add(d):(r.shiftKey&&(a&&"column"==o[a-1].type&&((l=o[a-1]).c1=l.firstC,l.c2=i,l.r1=l.r2=l.type=l.cc=void 0),d=o),s.Range(d,!1).select()),s.focus({rowIndxPage:s.getFirstVisibleRIP(!0),colIndx:i}),s._trigger("mousePQUp")):c.on&&(c.wholeCell||e(r.target).hasClass("pq-title-span"))&&0!=n.sortable&&s.sort({sorter:[{dataIndx:u,sortIndx:n.sortIndx}],addon:!0,skipCustomSort:pq.isCtrl(r),tempMultiple:c.multiKey&&r[c.multiKey],evt:r}))},refreshHeaderSortIcons:function(){var n=this.that,i=n.options,r=i.bootstrap,o=i.ui,a=n.headerCells.length-1;if(n.$head_i){var l=n.iSort.getSorter(),s=l.length,d=!1;n.options.sortModel.number&&1<s&&(d=!0);for(var c=0;c<s;c++){var u,h=l[c],f=h.dataIndx,f=n.getColIndx({dataIndx:f}),h=h.dir;0<=f&&(u=r.on?r.header_active:o.header_active+" pq-col-sort-"+("up"==h?"asc":"desc"),h=r.on?" glyphicon glyphicon-arrow-"+h:"ui-icon ui-icon-triangle-1-"+("up"==h?"n":"s"),(f=e(n.iRenderHead.getCell(a,f))).addClass(u),f.find(".pq-col-sort-icon").addClass(h),d&&f.find(".pq-col-sort-count").html(c+1))}}}},n.cResizeColumns=function(n){var i=this,r=((i.that=n).$head_i.on({mousedown:function(n){var r;n.pq_composed||(r=e(n.target),i.setDraggables(n),n.pq_composed=!0,n=e.Event("mousedown",n),r.trigger(n))},dblclick:function(e){i.doubleClick(e)}},".pq-grid-col-resize-handle"),n.options),o=r.flex;i.rtl=r.rtl?"right":"left",o.on&&o.one&&n.one("ready",function(){i.flex()})},n.cResizeColumns.prototype={doubleClick:function(n){var i=this.that.options,r=i.flex,n=e(n.target),n=parseInt(n.attr("pq-col-indx"));isNaN(n)||r.on&&this.flex(r.all&&!i.scrollModel.autoFit?{}:{colIndx:[n]})},flex:function(e){this.that.iRenderB.flex(e)},setDraggables:function(n){var i,r,n=e(n.target),o=this,a=o.rtl;n.draggable({axis:"x",helper:function(n,i){var r=e(n.target),a=parseInt(r.attr("pq-col-indx"));return o._setDragLimits(a),o._getDragHelper(n,i),r},start:function(e,n){i=e.clientX,r=parseInt(o.$cl[0].style[a])},drag:function(e,n){e=e.clientX-i,"right"==o.rtl&&(e*=-1),o.$cl[0].style[a]=r+e+"px"},stop:function(e,n){return o.resizeStop(e,n,i)}})},_getDragHelper:function(n){var i=this.that,r=+i.options.freezeCols,n=e(n.target),o=i.$grid_center,i=i.iRenderHead,n=+n.attr("pq-col-indx"),r=n<r?0:i.scrollX(),a=o.outerHeight(),l=i.getLeft(n)-r,i=i.getLeft(1+n)-r,n="style='height:"+a+"px;"+this.rtl+":";this.$clleft=e("<div class='pq-grid-drag-bar' "+n+l+"px;'></div>").appendTo(o),this.$cl=e("<div class='pq-grid-drag-bar' "+n+i+"px;'></div>").appendTo(o)},_setDragLimits:function(n){var i,r,o;n<0||(o=(r=this.that).iRenderHead,r=r.colModel[n],r=(i=o.getLeft(n)+r._minWidth)+r._maxWidth-r._minWidth,(o=e(o._resizeDiv(n))).draggable("instance")&&o.draggable("option","containment",[i,0,r,0]))},resizeStop:function(n,i,r){var o=this.that,a=o.colModel,l=o.options,s=l.numberCell;this.$clleft.remove(),this.$cl.remove();var d,c,u,r=n.clientX-r,i=+e(i.helper).attr("pq-col-indx");l.rtl&&(r*=-1),-1==i?(d=null,u=(c=parseInt(s.width))+r,s.width=u):(u=(c=parseInt((d=a[i]).width))+r,d.width=u,d._resized=!0),o._trigger("columnResize",n,{colIndx:i,column:d,dataIndx:d?d.dataIndx:null,oldWidth:c,newWidth:(d||s).width}),o.refresh({soft:!0})}}}(jQuery),function(e){var n=e.paramquery;n.cDragColumns=function(n){function i(i,r){return e("<div class='pq-arrow-"+i+" ui-icon "+r+"'></div>").appendTo(n.element)}var r=this,o=n.options,a=o.dragColumns;r.that=n,r.$drag_helper=null,r.rtl=o.rtl,r.status="stop",r.$arrowTop=i("down",a.topIcon),r.$arrowBottom=i("up",a.bottomIcon),r.hideArrows(),a&&a.enabled&&n.$head_i.on("mousedown",".pq-grid-col",r.onColMouseDown(r,n))},n.cDragColumns.prototype={dragHelper:function(n,i,r){var o=i.options.dragColumns.rejectIcon;return function(){n.status="helper",i.$head_i.find(".pq-grid-col-resize-handle").hide();var a=e("<div class='pq-col-drag-helper ui-widget-content ui-corner-all panel panel-default' ><span class='pq-drag-icon ui-icon "+o+" glyphicon glyphicon-remove'></span>"+r.pq_title+"</div>");return(n.$drag_helper=a)[0]}},getRowIndx:function(e,n,i){for(;i&&e[i][n]==e[i-1][n];)i--;return i},hideArrows:function(){this.$arrowTop.hide(),this.$arrowBottom.hide()},_columnIndexOf:function(e,n){for(var i=0,r=e.length;i<r;i++)if(e[i]==n)return i;return -1},moveColumn:function(e,n,i,r,o){var a=this.that,l="colModel",s=a.options[l],d=a.headerCells,c=a.depth-1,r=null==r?this.getRowIndx(d,e,c):r,o=null==o?this.getRowIndx(d,n,c):o,c=d[r][e],r=d[o][n],e=c.parent,d=r.parent,o=e?e[l]:s,n=d?d[l]:s,l=o.indexOf(c),s=i?0:1,o=n.indexOf(r);return a.iCols.move(1,l,o+s,e,d,"dnd")[0]},onColMouseDown:function(n,i){return function(r){var o,a,l=e(this),s=e(r.target);r.pq_composed||s.is("input,select,textarea")||s.parent().hasClass("pq-grid-header-search-row")||(a=(o=(l=i.getHeadCell(l)).col)?o.parent:null,!o||o.nodrag||o._nodrag||a&&1==a.colSpan||n.setDraggable(r,o,l)&&(r.pq_composed=!0,a=e.Event("mousedown",r),s.trigger(a)))}},onDrop:function(){var n=this,i=n.that;return function(r,o){var a=+o.draggable.attr("pq-col-indx"),o=+o.draggable.attr("pq-row-indx"),l=e(this),s=+l.attr("pq-col-indx"),l=+l.attr("pq-row-indx"),d=n.leftDrop;n.rtl&&(d=!d),!1!==i._trigger("beforeColumnOrder",null,{colIndxDrag:a,colIndxDrop:s,left:d})&&(s=n.moveColumn(a,s,d,o,l))&&i._trigger("columnOrder",null,{dataIndx:s.dataIndx,column:s,oldcolIndx:a,colIndx:i.getColIndx({column:s})})}},onStart:function(e,n,i,r){return function(o){if(!1===n._trigger("columnDrag",o.originalEvent,{column:i}))return!1;e.setDroppables(r)}},onDrag:function(n,i){return function(r,o){n.status="drag";var a,l=e(".pq-drop-hover",i.$head_i);0<l.length?(n.updateDragHelper(!0),a=l.width(),r=r.clientX-l.offset().left+e(document).scrollLeft(),n.leftDrop=r=r<a/2,n.showFeedback(l,r)):(n.hideArrows(),a=e(".pq-drop-hover",i.$top),n.updateDragHelper(!!a.length))}},setDraggable:function(n,i,r){var n=e(n.currentTarget),o=this,a=o.that;if(!n.hasClass("ui-draggable"))return n.draggable({distance:10,cursorAt:{top:-18,left:-10},zIndex:"1000",appendTo:a.element,revert:"invalid",helper:o.dragHelper(o,a,i),start:o.onStart(o,a,i,r),drag:o.onDrag(o,a),stop:function(){a.element&&(o.status="stop",a.$head_i.find(".pq-grid-col-resize-handle").show(),o.hideArrows())}}),!0},setDroppables:function(n){for(var i,r,o,a,l,s=this.that,d=n.col,c=n.ri,u=n.o_ci,h=u+d.o_colspan,n="pq-drop-hover ui-state-highlight",f={hoverClass:n,classes:{"ui-droppable-hover":n},accept:".pq-grid-col",tolerance:"pointer",drop:this.onDrop()},p=s.$head_i.find(":not(.pq-grid-header-search-row)>.pq-grid-col"),g=p.length;g--;)l=(a=e(p[g])).hasClass("ui-droppable"),o=(r=s.getHeadCell(a)).col,i=r.ri,r=r.ci,o==d||o.nodrop||o._nodrop||c<i&&u<=r&&r<h?l&&a.droppable("destroy"):l||a.droppable(f)},showFeedback:function(n,i){var r=this.that,o=n[0],a=r.$grid_center[0].offsetTop,n=n.offset().left-e(r.element).offset().left+(i?0:o.offsetWidth)-8,i=a+o.offsetTop-16,o=a+r.$header[0].offsetHeight;this.$arrowTop.css({left:n,top:i,display:""}),this.$arrowBottom.css({left:n,top:o,display:""})},updateDragHelper:function(e){var n=this.that.options.dragColumns,i="removeClass",r="addClass",o=n.acceptIcon,n=n.rejectIcon,a=this.$drag_helper;a&&a[e?i:r]("ui-state-error").children("span.pq-drag-icon")[e?r:i](o)[e?i:r](n)}}}(jQuery),function(e){e.paramquery.mixHeaderFilter={_input:function(e,n,i,r,o,a){return["<input ",' value="',n=pq.formatEx(e,n,a),"\" name='",e.dataIndx,"' type=text style='",r,"' class='",i,"' ",o," />"].join("")},_onKeyDown:function(n,i,r){var o,a=this,l=this.that;if(n.keyCode===e.ui.keyCode.TAB){var s,d,c=a.getCellIndx(r.closest(".pq-grid-col")[0])[1],u=l.colModel,h=n.shiftKey,f=u[c];if("textbox2"==(f.filterUI||{}).type&&(l.scrollColumn({colIndx:c}),(o=a.getCellEd(c)[1])[0]==r[0]?h||(s=o[1]):h&&(s=o[0]),s))return s.focus(),n.preventDefault(),!1;for(;h?c--:c++,!(c<0)&&!(c>=u.length);){var p=(f=u[c]).filter;if(!f.hidden&&p){d=!0,l.scrollColumn({colIndx:c},function(){var i=a.getCellEd(c)[1];if(i="textbox2"==(f.filterUI||{}).type?e(h?i[1]:i[0]):i)return i.focus(),n.preventDefault(),!1});break}}!d&&h&&pq.focusEle(!0)&&n.preventDefault()}},_textarea:function(e,n,i,r,o){return["<textarea name='",e,"' style='"+r+"' class='"+i+"' "+o+" >",n,"</textarea>"].join("")},bindListener:function(n,i,r,o){var a=this.that,l=o.filter,l=pq.filter.getVal(l),s=l[0],d=l[1];pq.fakeEvent(n,i,a.options.filterModel.timeout),n.off(i).on(i,function(i){var l,c,u=o.filterUI,h=u.type,u=u.condition;if("checkbox"==h?l=n.pqval({incr:!0}):"textbox2"==h?(l=e(n[0]).val(),c=e(n[1]).val()):l=n.val(),l=""===l?void 0:pq.deFormat(o,l,u),c=""===c?void 0:pq.deFormat(o,c,u),s!==l||d!==c)return s=l,d=c,(r=pq.getFn(r)).call(a,i,{column:o,dataIndx:o.dataIndx,value:l,value2:c})})},betweenTmpl:function(e,n){return["<div class='pq-from-div'>",e,"</div>","<span class='pq-from-to-center'>-</span>","<div class='pq-to-div'>",n,"</div>"].join("")},createListener:function(e){var n={},i=this.that;return n[e]=function(e,n){var r=n.column;i.filter({rules:[{dataIndx:r.filterIndx||n.dataIndx,condition:r.filter.condition,value:n.value,value2:n.value2}]})},n},getCellEd:function(n){var i=this.data.length-1,i=e(this.getCell(i,n)),n=i.find(".pq-grid-hd-search-field");return[i,n]},onCreateHeader:function(){var e=this;e.that.options.filterModel.header&&e.eachH(function(n){n.filter&&e.postRenderCell(n)})},onHeaderKeyDown:function(n,i){var r=e(n.originalEvent.target);return!r.hasClass("pq-grid-hd-search-field")||this._onKeyDown(n,i,r)},postRenderCell:function(n){var i=n.dataIndx,r=n.filterUI||{},o=n.filter,a=this.that,l=a.colIndxs[i],l=this.getCellEd(l),s=l[0],d=l[1];if(0!=d.length){var c=r.type,u={button:"click",select:"change",checkbox:"change",textbox:"timeout",textbox2:"timeout"},l=pq.filter.getVal(o)[0],l=("checkbox"==c?d.pqval({val:l}):"select"==c&&(e.isArray(l=l||[])||(l=[l]),n.format&&(l=l.slice(0,25).map(function(e){return pq.format(n,e)})),d.val(l.join(", "))),r.init),h=o.listener,f=o.listeners||[h||u[c]];l&&l.find(function(e){return a.callFn(e,{dataIndx:i,column:n,filter:o,filterUI:r,$cell:s,$editor:d})});for(var p=0;p<f.length;p++){var g,m=f[p],v=typeof m,$={};for(g in"string"==v?m=this.createListener(m):"function"==v&&($[u[c]]=m,m=$),m)this.bindListener(d,g,m[g],n)}}},getControlStr:function(e){var n=this.that,i=e.dataIndx,r=e.filter,o=" ui-corner-all",r=pq.filter.getVal(r),a=r[0],l=r[1],r=r[2],s=e.filterUI=pq.filter.getFilterUI({column:e,dataIndx:i,condition:r,indx:0},n),d=s.type,c="",u=("textbox2"==d&&(l=null!=l?l:""),"pq-grid-hd-search-field "+(s.cls||"")),h=s.style||"",s=(s.attr||"")+" tabindex=-1";return d&&0<=d.indexOf("textbox")?(a=a||"",u=u+" pq-search-txt"+o,c="textbox2"==d?this.betweenTmpl(this._input(e,a,u+" pq-from",h,s,r),this._input(e,l,u+" pq-to",h,s,r)):this._input(e,a,u,h,s,r)):"select"===d?c="<input type='text' "+["name='",i,"' class='",u+=o,"' style='",h,"' ",s].join("")+" ><span style='position:absolute;"+(n.options.rtl?"left":"right")+":0;top:3px;' class='ui-icon ui-icon-arrowthick-1-s'></span>":"checkbox"==d?c=["<input ",null==a||0==a?"":"checked=checked"," name='",i,"' type=checkbox class='"+u+"' style='"+h+"' "+s+" />"].join(""):"string"==typeof d&&(c=d),c},renderFilterCell:function(e,n,i){var r,o=this.that.options.filterModel,a=e.cls,l=e.halign||e.align;return l&&i.push("pq-align-"+l),a&&i.push(a),i.push(e.clsHead),e.filter&&(r=this.getControlStr(e))&&i.push("pq-col-"+n),(l=this.hasMenu(o,e))&&i.push("pq-has-menu"),["<div class='pq-td-div' style='overflow:hidden;'>","",r,"</div>",l?"<span class='pq-filter-icon'></span>":""].join("")},hasMenu:function(e,n){return e=e.menuIcon,n=(n.filter||{}).menuIcon,e&&!1!==n||!1!==e&&n}}}(jQuery),function(e){var n=e.paramquery.cRefresh=function(n){var i=this;i.vrows=[],(i.that=n).on("dataReadyDone",function(){i.addRowIndx(!0)}),e(window).on("resize"+n.eventNamespace+" orientationchange"+n.eventNamespace,i.onWindowResize.bind(i))};e.extend(n,{Z:function(){return(window.outerWidth-8)/window.innerWidth},cssZ:function(){return document.body.style.zoom},isFullScreen:function(){return document.fullScreen||document.mozFullScreen||document.webkitIsFullScreen||window.innerHeight==screen.height},isSB:function(){return e(document).height()>e(window).height()}}),e(document).one("pq:ready",function(){var i=n.Z,r=n.cssZ,o=i(),a=r(),l=(n.isZoom=function(){var e=i(),n=r();if(o!=e||a!=n)return o=e,a=n,!0},n.isSB),s=l();pq.onResize(document.body,function(){var n=l();n!=s&&(s=n,e(window).trigger("resize",{SB:!0}))})}),e(window).on("resize",function(){n.isZoom&&(n.ISZOOM=n.isZoom())}),n.prototype={addRowIndx:function(e){for(var n,i=this.that,r=i.options,o=r.dataModel,a=r.rowTemplate,l=o.dataUF,s=i.get_p_data(),d=s.length;d--;)(n=s[d])&&(n.pq_ri=d),a&&pq.extendT(n,a);if(e&&l)for(d=l.length;d--;)delete l[d].pq_ri},move:function(){},setGridAndCenterHeightForFlex:function(){var e=this.that;e.element.height(""),e.$grid_center.height(""),e.dims.htGrid=e.element.height()},setGridWidthForFlex:function(){var e=this.that,n=e.options,i=this.maxWidthPixel,r=e.element,o=e.$toolPanel[0].offsetWidth+e.iRenderB.getFlexWidth();n.maxWidth&&o>=this.maxWidthPixel&&(o=i),e._trigger("contWd"),r.width(o+"px"),e.dims.wdGrid=o},_calcOffset:function(e){return(e=/(-|\+)([0-9]+)/.exec(e))&&3===e.length?parseInt(e[1]+e[2]):0},setMax:function(e){var n=this.that,i=n.element,n=n.options[e];n?(n==parseInt(n)&&(n+="px"),i.css(e,n)):i.css(e,"")},refreshGridWidthAndHeight:function(){var n,i,r,o=this.that,a=o.options,l=o.dims,s=-1<(a.width+"").indexOf("%"),d=-1<(a.height+"").indexOf("%"),c=-1<(a.maxHeight+"").indexOf("%"),u="flex"==a.height,h=a.dimsRelativeTo,f=c&&u,p=-1<(a.maxWidth+"").indexOf("%"),g="flex"==a.width,m=p&&g,o=o.element;if(s||d||f||m){if(!(h=h?e(h):o.parent()).length)return;var h=h[0]==document.body||"fixed"==o.css("position")?(r=e(window).width(),window.innerHeight||e(window).height()):(r=h.width(),h.height()),v=this._calcOffset,$=s?v(a.width):0,v=d?v(a.height):0;m?n=parseInt(a.maxWidth)*r/100:s&&(n=parseInt(a.width)*r/100+$),f?i=parseInt(a.maxHeight)*h/100:d&&(i=parseInt(a.height)*h/100+v)}n||(g&&a.maxWidth?p||(n=a.maxWidth):s||(n=a.width)),a.maxWidth&&(this.maxWidthPixel=n),i||(u&&a.maxHeight?c||(i=a.maxHeight):d||(i=a.height)),parseFloat(n)==n?(n=n<a.minWidth?a.minWidth:n,o.css("width",n)):"auto"===n&&o.width(n),parseFloat(i)==i&&(i=i<a.minHeight?a.minHeight:i,o.css("height",i)),l.wdGrid=Math.round(o.width()),l.htGrid=Math.round(o.height())},isReactiveDims:function(){function e(e){return -1!=(e+"").indexOf("%")}var n=this.that.options,i=n.width,r=n.height,o=n.maxWidth,n=n.maxHeight,a=e(i),i="auto"===i,r=e(r),o=e(o),n=e(n);return a||i||r||o||n},getParentDims:function(){var n,i=this.that.element,r=i.parent();return r.length?[r[0]==document.body||"fixed"==i.css("position")?(n=window.innerHeight||e(window).height(),e(window).width()):(n=r.height(),r.width()),n]:[]},onWindowResize:function(i,r){var o,a,l=this,s=l.that,d=s.dims||{},c=d.htParent,u=d.wdParent,h=s.options,f=s.element;if(!n.isFullScreen()&&!h.disabled&&!(e.support.touch&&h.editModel.indices&&e(document.activeElement).is(".pq-editor-focus")||r&&(s=r.$grid)&&(s==f||0==f.closest(s).length))){if(h=l.isReactiveDims(),n.ISZOOM)return l.setResizeTimer(function(){l.refresh({soft:!0})});h&&l.setResizeTimer(function(){if(o=(a=l.getParentDims())[0],(a=a[1])==c&&o==u){if(parseInt(f.width())==parseInt(d.wdGrid))return}else d.htParent=a,d.wdParent=o;l.refresh({soft:!0})})}},setResizeTimer:function(e){var n=this,i=n.that;clearTimeout(n._autoResizeTimeout),n._autoResizeTimeout=window.setTimeout(function(){i.element&&(e?e():n.refreshAfterResize())},i.options.autoSizeInterval||100)},refresh:function(e){var n,i=this,r=i.that,o=null==(e=e||{}).header||e.header,a=e.pager,l=!e.soft,s=r.element,d=r.$toolPanel,c=r.dims=r.dims||{htCenter:0,htHead:0,htSum:0,htBody:0,wdCenter:0,htTblSum:0};e.colModel&&r.refreshCM(),s[0].offsetWidth?(d.css("height","1px"),e.toolbar&&r.refreshToolbar(),(n=r.options).collapsible._collapsed=!1,i.setMax("maxHeight"),i.setMax("maxWidth"),i.refreshGridWidthAndHeight(),l&&!1!==a&&r._refreshPager(),c.htCenter=i.setCenterHeight(),a=d[0].offsetWidth,c.wdCenter=c.wdGrid-a,r.$grid_center.css("margin"+(n.rtl?"Left":"Right"),a),r.iRenderB.init({header:o,soft:e.soft,source:e.source}),"flex"==n.height&&i.setGridAndCenterHeightForFlex(),"flex"==n.width&&i.setGridWidthForFlex(),d=this.getParentDims(),c.wdParent=d[0],c.htParent=d[1],l&&r._createCollapse(),n.dataModel.postDataOnce=void 0,r._trigger("refreshFull")):s.addClass("pq-pending-refresh")},setCenterHeight:function(){var e,n=this.that,i=n.$top,r=n.options;return("flex"!==r.height||r.maxHeight)&&(e=n.dims.htGrid-(r.showTop?i[0].offsetHeight+parseInt(i.css("marginTop")):0)-n.$bottom[0].offsetHeight+1,n.$grid_center.height(e=0<=e?e:"")),e}}}(jQuery),function(e){(e.paramquery.cCheckBoxColumn=function(n,i){var r,o=this,a=(o.that=n,o.fns={},o.options=n.options,(i=(r=o.colUI=i).cbId?o.colCB=n.columns[i.cbId]:o.colCB=i).cb=e.extend({},{all:!1,header:!1,select:!1,check:!0,uncheck:!1},i.cb)),l=i.dataIndx;r._render=o.cellRender(i,r),o.on("dataAvailable",function(){n.one("dataReady",o.oneDataReady.bind(o))}).on("dataReady",o.onDataReady.bind(o)).on("valChange",o.onCheckBoxChange(o)).on("cellKeyDown",o.onCellKeyDown.bind(o)).on("refreshHeader",o.onRefreshHeader.bind(o)).on("change",o.onChange(o,n,l,a.check,a.uncheck)),a.select&&o.on("rowSelect",o.onRowSelect(o,n)).on("beforeRowSelectDone",o.onBeforeRowSelect(o,n,l,a.check,a.uncheck)),o.on("beforeCheck",o.onBeforeCheck.bind(o))}).prototype=e.extend({cellRender:function(e,n){var i=this;return function(r){var o,a=r.rowData,l=e.dataIndx,s=e.cb,d=n.renderLabel,c=n.useLabel;if(!(a.pq_gtitle||a.pq_gsummary||r.Export))return[c?" <label>":"","<input type='checkbox' ",s.check===a[l]?"checked":""," ",i.isEditable(a,e,r.rowIndx,r.colIndx,l)?"":"disabled"," />",o=null==(o=d?d.call(this,r):o)?e==n?"":r.formatVal||r.cellData:o,c?"</label>":""].join("")}},checkAll:function(e,n){var i=this.that,i=this.colCB.cb.all?i.options.dataModel.data:i.pdata;return this.checkNodes(i,e=null==e||e,n)},checkNodes:function(e,n,i){var r,o,a,l,s,d,c,u;if(e.length)return r=this.that,o=this.colUI.dataIndx,a=(u=this.colCB).cb,l=(n=null==n||n)?a.check:a.uncheck,s=u.dataIndx,d=(u=e[0]).pq_ri,c=function(){return r.refreshCell({rowIndx:d,dataIndx:o}),!1},u={rowIndx:d,rowData:u,dataIndx:o,check:n,rows:e=e.map(function(e){var n={},i={};return n[s]=e[s],i[s]=l,{rowIndx:e.pq_ri,rowData:e,oldRow:n,newRow:i}})},n={source:"checkbox"},!1===r._trigger("beforeCheck",i,u)?c():(n.updateList=u.rows,n.history=n.track=!a.select&&null,!1===r._digestData(n)?c():void(a.maxCheck||1!=n.updateList.length?r.refresh({header:!1}):r.refreshRow({rowIndx:n.updateList[0].rowIndx})))},isEditable:function(e,n,i,r,o){return this.that.isEditable({rowIndx:i,rowData:e,column:n,colIndx:r,dataIndx:o})},onBeforeRowSelect:function(e,n,i,r,o){return function(a,l){var s;"checkbox"!=l.source&&((s=function(a){for(var l,s,d=a.length,c=n.columns[i],u=n.colIndxs[i];d--;)l=(s=a[d]).rowIndx,s=s.rowData,e.isEditable(s,c,l,u,i)?s[i]=s.pq_rowselect?o:r:a.splice(d,1)})(l.addList),s(l.deleteList))}},onChange:function(e,n,i,r,o){return function(o,a){function l(e,i){e.length&&n._trigger("check",o,{rows:e,dataIndx:u,rowIndx:e[0].rowIndx,rowData:e[0].rowData,check:i})}function s(e){e.forEach(function(e){var n=e.newRow,o=e.oldRow;n.hasOwnProperty(i)&&(n[i]===r?d.push(e):o&&o[i]===r&&c.push(e))})}var d=[],c=[],u=e.colUI.dataIndx;e.setValCBox(),s(a.addList),s(a.updateList),e.colCB.cb.select&&n.SelectRow().update({addList:d,deleteList:c,source:"checkbox"}),l(d,!0),l(c,!1)}},onCheckBoxChange:function(e){return function(n,i){if(i.dataIndx==e.colUI.dataIndx)return e.checkNodes([i.rowData],i.input.checked,n)}},onDataReady:function(){this.setValCBox()},off:function(){var e,n=this.fns,i=this.that;for(e in n)i.off(e,n[e]);this.fns={}},on:function(e,n){return this.fns[e]=n,this.that.on(e,n),this},destroy:function(){for(var e in this.off(),this)delete this[e]},oneDataReady:function(){var e,n=this.that.get_p_data(),i=0,r=n.length,o=this.colCB,a=o.cb,l=o.dataIndx;if(null!=l&&n&&a.select)for(;i<r;i++)(e=n[i])&&(e[l]===a.check?e.pq_rowselect=!0:e.pq_rowselect&&(e[l]=a.check))},onRowSelect:function(e,n){return function(i,r){"checkbox"!=r.source&&(r.addList.length||r.deleteList.length)&&(e.setValCBox(),n.refresh({header:!1}))}}},pq.mixin.ChkGrpTree)}(jQuery),function(e){var n=e.paramquery,i={options:{stateColKeys:{width:1,filter:["crules","mode"],hidden:1},stateKeys:{height:1,width:1,freezeRows:1,freezeCols:1,groupModel:["dataIndx","collapsed","grandSummary"],pageModel:["curPage","rPP"],sortModel:["sorter"]},detailModel:{cache:!0,offset:100,expandIcon:"ui-icon-triangle-1-se glyphicon glyphicon-minus",collapseIcon:"ui-icon-triangle-1-e glyphicon glyphicon-plus",height:"auto"},dragColumns:{enabled:!0,acceptIcon:"ui-icon-check glyphicon-ok",rejectIcon:"ui-icon-closethick glyphicon-remove",topIcon:"ui-icon-circle-arrow-s glyphicon glyphicon-circle-arrow-down",bottomIcon:"ui-icon-circle-arrow-n glyphicon glyphicon-circle-arrow-up"},flex:{on:!0,one:!1,all:!0},track:null,mergeModel:{flex:!1},realFocus:!0,sortModel:{on:!0,type:"local",multiKey:"shiftKey",number:!0,single:!0,cancel:!0,sorter:[],useCache:!0,ignoreCase:!1},filterModel:{on:!0,newDI:[],type:"local",mode:"AND",header:!1,timeout:400}},_create:function(){var e=this,i=e.options;null==i.rtl&&(i.rtl="rtl"==e.element.css("direction")),e.listeners={},e._queueATriggers={},e.iHistory=new n.cHistory(e),e.iGroup=new n.cGroup(e),e.iMerge=new n.cMerge(e),e.iFilterData=new n.cFilterData(e),e.iSelection=new pq.Selection(e),e.iUCData=new n.cUCData(e),e.iMouseSelection=new n.cMouseSelection(e),e._super(),new n.cFormula(e),e.iDragColumns=new n.cDragColumns(e),e.refreshToolbar(),"remote"===i.dataModel.location&&e.refresh(),e.on("dataAvailable",function(){e.one("refreshDone",function(){e._trigger("ready"),setTimeout(function(){e.element&&e._trigger("complete")},0)})}),e.refreshDataAndView({header:!0})}},i=(e.widget("paramquery.pqGrid",n._pqGrid,i),e.widget.extend=function(){var n,i,r,o,a,l=Array.prototype.shift,s=e.isPlainObject,d=e.isArray,c=e.widget.extend,u=l.apply(arguments),h=("boolean"==typeof u&&(n=u,u=l.apply(arguments)),arguments),f=0,p=h.length;for(null==n&&(n=1<p);f<p;f++)for(o in i=h[f])(a=(r=Object.getOwnPropertyDescriptor(i,o)).get)&&"reactiveGetter"!=a.name||r.set?Object.defineProperty(u,o,r):void 0!==(a=i[o])&&(r=!(0<f),s(a)?a.byRef?u[o]=a:(u[o]=u[o]||{},c(r,u[o],a)):d(a)?u[o]=n&&r?a.slice():a:u[o]=a);return u},pq.grid=function(n,i){return(n=e(n).pqGrid(i)).data("paramqueryPqGrid")||n.data("paramquery-pqGrid")},n.pqGrid.regional={},n.pqGrid.prototype);function r(e,n,i){for(var r=0,o=e.length;r<o;r++){for(var a,l=e[r],s={},d=0,c=n.length;d<c;d++)s[a=n[d]]=l[a];i.push(s)}}n.pqGrid.defaults=i.options,i.focusT=function(e){var n=this;setTimeout(function(){n.focus(e)})},i.focus=function(n){var i,r,o,a,l,s=this,d=s._fe,n=n||d||{},c=!n.nofocus,u=s.options.editModel,h=n.rowIndxPage,n=n.colIndx,f=s.pdata,h=h>=f.length?f.length-1:h,f=s.colModel,n=n>f.length?f.length-1:n,f=s.iMerge,p=h+s.riOffset,n=-1==n?s.getFirstVisibleCI(!0):n;null!=h&&null!=n&&(f.ismergedCell(p,n)&&(h=(f=f.getRootCellO(p,n)).rowIndxPage,n=f.colIndx),p=s.iRenderB,f="ontouchstart"in window?"disabled":"",i=(a=p.getCellCoords(h,n))[0],l=a[1],r=a[2],a={left:i,top:l,height:a[3]-l-2,width:r-i-2},l=p.getCellCont(h,n)[0],d?(d.$td&&d.$td.removeClass("pq-focus"),(o=d.$ele)&&o.parent()[0]!=l&&(d.$ele.remove(),o=null)):d=s._fe={},(o=o||(d.$ele=e("<textarea "+f+" class='pq-box-focus' style='position:absolute;opacity:0;resize:none;pointer-events:none;' ></textarea>"))).appendTo(l),o.val("").css(a),d.rowIndxPage=h,d.colIndx=n,(d.$td=s.getCell(d)).addClass("pq-focus"),s.one("assignTblDims",function(){o.css({left:0,top:0})}),c&&(s.one("scroll",function(){(d.$td=s.getCell(d)).addClass("pq-focus")}),o.blur(),o[0].focus()),u.pressToEdit&&o.off("input").on("input",function(n){var i=s.getEditor(d,"type"),r="select"==i;s.isEditable(d)&&i&&!r&&(s.editCell(d),i=s.getEditCell().$editor,r=e(n.target).val(),i&&i.val(r))}),o.css({height:2,width:2}))},i.onfocus=function(e){},i.onfocusHeader=function(){var n=this,i=[];n.$head_i.find(".pq-grid-hd-search-field").each(function(r,o){var o=e(o).attr("name"),a=n.getColIndx({dataIndx:o});i.push({ci:a,di:o})}),i.length&&(i.sort(function(e,n){return e.ci-n.ci}),n.iRenderHead.getCellEd(i[0].ci)[1].focus())},i.onblur=function(){},i.callFn=function(e,n){return pq.getFn(e).call(this,n)},i.rowExpand=function(e){this.iHierarchy.rowExpand(e)},i.rowInvalidate=function(e){this.iHierarchy.rowInvalidate(e)},i.rowCollapse=function(e){this.iHierarchy.rowCollapse(e)},i._saveState=function(n,i,r){var o,a,l,s;for(o in r)(a=r[o])&&(l=n[o],e.isArray(a)?null!=l&&(s=i[o]=e.isPlainObject(i[o])?i[o]:{},a.forEach(function(e){s[e]=l[e]})):i[o]=l)},i.saveState=function(n){n=n||{};for(var i,r,o,a=this,l=a.element,s=a.options,d=s.stateColKeys,c=s.stateKeys,u=a.colModel,h=[],f=0,p=u.length,l=l[0].id;f<p;f++)i=(r=u[f]).dataIndx,a._saveState(r,r={dataIndx:i},d),h[f]=r;return o={colModel:h,datestamp:Date.now()},a._saveState(s,o,c),(s=n.extra)&&(o=e.extend(!0,o,s)),!1!==n.stringify&&(o=JSON.stringify(o),!1!==n.save&&"undefined"!=typeof Storage&&localStorage.setItem("pq-grid"+(l||""),o)),o},i.getState=function(){if("undefined"!=typeof Storage)return localStorage.getItem("pq-grid"+(this.element[0].id||""))},i.loadState=function(n){var i=this,r=e.widget.extend,o=(n=n||{}).state||i.getState();if(!o)return!1;for(var a,l,s,d=(o="string"==typeof o?JSON.parse(o):o).colModel,c=[],u=[],h=i.options,f=h.stateColKeys,p=1<i.depth,g=(p?i:h).colModel,m=0,v=d.length;m<v;m++)c[s=(a=d[m]).dataIndx]=a,u[s]=m;for(p||g.sort(function(e,n){return u[e.dataIndx]-u[n.dataIndx]}),m=0,v=g.length;m<v;m++)(a=c[s=(l=g[m]).dataIndx])&&i._saveState(a,l,f);return i.iCols.init(),r(h.sortModel,o.sortModel),r(h.pageModel,o.pageModel),i.Group().option(o.groupModel,!1),i.Tree().option(o.treeModel,!1),p={freezeRows:o.freezeRows,freezeCols:o.freezeCols},isNaN(+h.height)||isNaN(+o.height)||(p.height=o.height),isNaN(+h.width)||isNaN(+o.width)||(p.width=o.width),i.option(p),!1!==n.refresh&&i.refreshDataAndView(),!0},i.refreshToolbar=function(){var n,i,r,o,a=this,l=a.options,s=l.toolbar;a._toolbar&&(n=a._toolbar).destroy(),s&&(o=s.cls||"",i=s.style||"",r=s.attr||"",s=s.items,o=e("<div class='"+o+"' style='"+i+"' "+r+" ></div>"),n?n.widget().replaceWith(o):a.$top.append(o),n=pq.toolbar(o,{items:s,gridInstance:a,bootstrap:l.bootstrap}),l.showToolbar||o.css("display","none"),a._toolbar=n)},i.filter=function(e){return this.iFilterData.filter(e)},i.Checkbox=function(e){return this.iCheckBox[e]},i.refreshHeader=function(){this.iRenderHead.refreshHS()},i.refreshSummary=function(){this.iRenderSum.refreshHS()},i.refreshHeaderFilter=function(e){var e=this.normalize(e),n=e.colIndx,e=e.column,i=this.iRenderHead,r=i.rows-1;this.options.filterModel.header&&(i.refreshCell(r,n,{},e),i.postRenderCell(e,n,r))},i._refreshHeaderSortIcons=function(){this.iHeader.refreshHeaderSortIcons()},i.pageData=function(){return this.pdata},i.getData=function(e){var n=(e=e||{}).dataIndx,i=n?n.length:0,e=e.data,o=!i,a=this.columns,l=this.options.dataModel,s=l.dataPrimary||l.data||[],l=l.dataUF||[],d=[];if(!i)return l.length?s.concat(l):s;e?r(e,n,d):(r(s,n,d),r(l,n,d));for(var c=[],i=n.reduce(function(e,n){var i=a[n];return i&&e.push({dataIndx:n,dir:"up",dataType:i.dataType,sortType:i.sortType}),e},[]),u={},h=0,f=d.length;h<f;h++){var p=d[h],g=JSON.stringify(p);u[g]||(c.push(p),u[g]=1)}return this.iSort._sortLocalData(i,c,o)},i.getPlainOptions=function(n,i){var r=n[0];return e.isPlainObject(r)?(r=Object.keys(r))[0]!=i&&1==r.length&&(n=n.map(function(e){var n,r={};for(n in e)r[i]=n,r.pq_label=e[n];return r})):n=n.map(function(e){var n={};return n[i]=e,n}),n},i.getDataCascade=function(e,n,i){var r,o=this,a=o.options.filterModel,l=a.newDI.slice(),n=n?[n,e]:[e],e=l.indexOf(e);return"AND"==a.mode&&l.length&&"remote"!=a.type&&(0<=e&&l.splice(e,l.length),l.length&&(a=l.map(function(e){var n=o.getColumn({dataIndx:e}).filter;return{dataIndx:e,crules:n.crules||[n],mode:n.mode}}),r=o.filter({data:o.getData(),mode:"AND",rules:a}))),n=n.concat(i||[]),o.getData({data:r,dataIndx:n})},i.removeNullOptions=function(e,n,i){var r;return null==i?e.filter(function(e){var i=e[n];return null!=i&&""!==i||(r?void 0:(r=!0,e[n]="",!0))}):e.filter(function(e){return null!=(e=e[n])&&""!==e})},i.get_p_data=function(){var e,n=this.options,i=n.pageModel,r=i.type,n=n.dataModel.data,o=this.pdata,a=[];return r?(i=i.rPP,e=this.riOffset,!o.length&&n.length&&(o=n.slice(e,e+i)),a=(r="remote"==r)?Array(e):n.slice(0,e),r=r?[]:n.slice(e+i),a.concat(o,r)):o.length?o:n},i._onDataAvailable=function(e){var n=this,i=n.options,r=!(e=e||{}).data,o=e.source,a=e.sort,l=[],s=i.filterModel,d=i.dataModel,i=i.sortModel;if(!1!=r&&(n.pdata=[],!1!==e.trigger)&&n._trigger("dataAvailable",e.evt,{source:o}),l=(s&&s.on&&"local"==s.type?n.iFilterData.filterLocalData(e):d).data,"local"==i.type&&!1!==a&&(r?n.sort({refresh:!1}):l=n.iSort.sortLocalData(l,!0)),!1==r)return l;n.refreshView(e)},i.reset=function(n){var i=this,r=(n=n||{}).sort,o=i.options,a=!1!==n.refresh,l=e.extend,s=n.filter,n=n.group;(r||s||n)&&(r&&l(o.sortModel,!0===r?{sorter:[]}:r),s&&!a&&this.iFilterData.clearFilters(i.colModel),n&&i.groupOption(!0===n?{dataIndx:[]}:n,!1),a&&(s?(i.filter({oper:"replace",rules:[]}),i.refreshHeader()):r?i.sort():i.refreshView()))},i._trigger=n._trigger,i.on=n.on,i.one=n.one,i.off=n.off,i.pager=function(){var e;return this.pageI=this.pageI||((e=this.widget().find(".pq-pager")).length?e.pqPager("instance"):null),this.pageI},i.toolbar=function(){return this._toolbar.element},i.Columns=function(){return this.iCols}}(jQuery),function(e){var n=e.paramquery;n.cColModel=function(e){this.that=e,this.vciArr,this.ciArr,this.init()},n.cColModel.prototype={add:function(e,n,i,r){var o,a,l=this,s=l.that,i=i||s.options.colModel,n=null==n?i.length:n,d={args:arguments},c=e.length,u=[n,0].concat(e);!1!==s._trigger("beforeColAdd",null,d)&&("undo"!=r&&"redo"!=r&&s.iHistory.push({callback:function(i){a=(o||{}).colModel,i?l.add(e,n,a,"redo"):l.remove(c,n,a,"undo")}}),i.splice.apply(i,u),s.refreshCM(),o=i[0].parent,s._trigger("colAdd",null,d),s.refresh())},move:function(e,n,i,r,o,a){var l,s=this,d={args:arguments},c=s.that,u=[],h=c.options.colModel,f=(r||{}).colModel||h,p=(o||{}).colModel||h;return!1!==c._trigger("beforeColMove",null,d)&&("undo"!=a&&"redo"!=a&&c.iHistory.push({callback:function(a){a?s.move(e,n,i,r,o,"redo"):s.move(e,l,f==p&&l<n?n+e:n,o,r,"undo")}}),u=f.splice(n,e),l=f==p&&n+e<i?i-e:i,p.splice.apply(p,[l,0].concat(u)),c.refreshCM(),c._trigger("colMove",null,d),c.refresh()),u},remove:function(e,n,i,r){var o,a,l=this,s={args:arguments},d=l.that,i=(d.iCheckBox,i||d.options.colModel),c=i[0].parent;!1!==d._trigger("beforeColRemove",null,s)&&("undo"!=r&&"redo"!=r&&d.iHistory.push({callback:function(i){a=(c||{}).colModel,i?l.remove(e,n,a,"redo"):l.add(o,n,a,"undo")}}),o=i.splice(n,e),d.refreshCM(),d._trigger("colRemove",null,s),d.refresh())},alter:function(e){var n=this.that;e.call(n),n.refreshCM(),n.refresh()},assignRowSpan:function(){for(var e,n,i,r,o=this.that,a=o.colModel.length,l=o.headerCells,s=o.depth,d=0;d<a;d++)for(n=0;n<s;n++)if(e=l[n][d],!(0<d&&e==l[n][d-1]||0<n&&e==l[n-1][d])){for(i=n+(r=1);i<s;i++)e==l[i][d]&&r++;e.rowSpan=r}return l},autoGenColumns:function(){var n=this.that.options,i=n.columnTemplate||{},r=i.dataType,o=i.title,a=i.width,i=n.dataModel.data,l=pq.valid,s=[];i&&i.length&&(i=i[0],e.each(i,function(e,n){var i="string";l.isInt(n)?i=-1<n+"".indexOf(".")?"float":"integer":l.isDate(n)?i="date":l.isFloat(n)&&(i="float"),s.push({dataType:r||i,dataIndx:e,title:o||e,width:a||100})})),n.colModel=s},cacheIndices:function(){for(var e=this.that,n="JSON"==this.getDataType(),i={},r={},o={},a=e.colModel,l=0,s=a.length,d=0,c=this.vciArr=[],u=this.ciArr=[];l<s;l++){var h=a[l],f=h.dataIndx;null==f&&("pq_detail"==(f="detail"==h.type?"pq_detail":n?"dataIndx_"+l:l)&&(h.dataType="object"),h.dataIndx=f),i[f]=h,r[f]=l,h.validations&&(o[f]=o),h.hidden||(c[u[d]=l]=d,d++),!h.align&&(f=h.dataType)&&("integer"==f||"float"==f)&&(h.align="right")}e.columns=i,e.colIndxs=r,e.validations=o},collapse:function(e){var n,i,r,o=e.collapsible,a=o.on||!1,l=e.colModel||[],e=l.length,s=e,d=0,c=o.last,u=c?e-1:0;if(e){for(;s--;)n=l[s],null===c?(r=n.showifOpen===a)&&d++:r=u!==s&&a,(n.hidden=r)||!(i=n.colModel)||n.collapsible||this.each(function(e){e.hidden=r},i);d==e&&this.each(function(e){e.hidden=!1},[l[0]])}},each:function(e,n){var i=this.that;(n||i.options.colModel).forEach(function(n){e.call(i,n),n.colModel&&this.each(e,n.colModel)},this)},extend:function(e,n){for(var i=e.length;i--;){var r=e[i];n&&pq.extendT(r,n)}},find:function(e,n){for(var i,r=this.that,o=n||r.options.colModel,a=0,l=o.length;a<l;a++)if(i=o[a],e.call(r,i)||i.colModel&&(i=this.find(e,i.colModel)))return i},getHeaderCells:function(){for(var e=this.that,n=e.options.colModel,i=e.colModel.length,r=e.depth,o=[],a=0;a<r;a++){o[a]=[];for(var l,s=0,d=0,c=0;c<i;c++){if(0==a)l=n[s];else{var u=o[a-1][c],h=u.colModel;if(h&&0!=h.length){for(var f=c-u.leftPos,p=0,g=0,m=0;m<h.length;m++)if(f<(p+=0<h[m].childCount?h[m].childCount:1)){g=m;break}l=h[g]}else l=u}u=l.childCount||1,c==d?(l.leftPos=c,o[a][c]=l,d+=u,n[s+1]&&s++):o[a][c]=o[a][c-1]}}return e.headerCells=o},getDataType:function(){var e=this.colModel;if(e&&e[0])return"string"==typeof e[0].dataIndx?"JSON":"ARRAY"},getci:function(e){return this.ciArr[e]},getvci:function(e){return this.vciArr[e]},getNextVisibleCI:function(e){for(var n=this.vciArr,i=this.that.colModel.length;e<i;e++)if(null!=n[e])return e},getPrevVisibleCI:function(e){var n=this.vciArr;for(this.that.colModel.length;0<=e;e--)if(null!=n[e])return e},getLastVisibleCI:function(){var e=this.ciArr;return e[e.length-1]},getVisibleTotal:function(){return this.ciArr.length},hide:function(e){var n=this.that,i=n.columns;e.diShow=e.diShow||[],e.diHide=e.diHide||[],!1!==n._trigger("beforeHideCols",null,e)&&(e.diShow=e.diShow.filter(function(e){if((e=i[e]).hidden)return delete e.hidden,!0}),e.diHide=e.diHide.filter(function(e){if(!(e=i[e]).hidden)return e.hidden=!0}),n.refresh({colModel:!0}),n._trigger("hideCols",null,e))},init:function(e){var n=this,i=n.that,r=i.options,o=r.columnTemplate,a=r.colModel;a||(n.autoGenColumns(),a=r.colModel),r=n.nestedCols(a),i.depth=r.depth,a=i.colModel=r.colModel,o&&n.extend(a,o),n.getHeaderCells(),n.assignRowSpan(),n.cacheIndices(),n.initTypeColumns(),i._trigger("CMInit",null,e)},initTypeColumns:function(){var e,i=this.that,r=i.colModel,o=0,a=r.length,l=i.columns,s=i.iCheckBox=i.iCheckBox||{};for(e in s)s[e].colUI!=l[e]&&(s[e].destroy(),delete s[e]);for(;o<a;o++){var d=r[o],c=d.type;c&&("checkbox"==c||"checkBoxSelection"==c?(e=d.dataIndx,d.type="checkbox",s[e]=s[e]||new n.cCheckBoxColumn(i,d)):"detail"!=c||i.iHierarchy||(d.dataIndx="pq_detail",i.iHierarchy=new n.cHierarchy(i,d)))}},nestedCols:function(e,n,i,r){for(var o=e.length,a=[],l=0,s=n=n||1,d=0,c=0,u=0;l<o;l++){var h=e[l],f=h.colModel;h.parent=r,!0===i&&(h.hidden=i),f&&f.length?(h.collapsible&&this.collapse(h),f=this.nestedCols(f,n+1,h.hidden,h),a=a.concat(f.colModel),0<f.colSpan?(f.depth>s&&(s=f.depth),h.colSpan=f.colSpan,d+=f.colSpan):h.colSpan=0,u+=f.o_colspan,h.o_colspan=f.o_colspan,h.childCount=f.childCount,c+=f.childCount):(h.hidden?h.colSpan=0:(h.colSpan=1,d++),u++,h.o_colspan=1,h.childCount=0,c++,a.push(h))}return{depth:s,colModel:a,colSpan:d,width:0,childCount:c,o_colspan:u}},reduce:function(e,n){var i=this.that,r=[];return(n||i.options.colModel).forEach(function(n,o){(n=e.call(i,n,o))&&((o=n.colModel)&&o.length?(o=this.reduce(e,o)).length&&(n.colModel=o,r.push(n)):r.push(n))},this),r},reverse:function(e){var n,i=this,r=i.that;(e||r.options.colModel).reverse().forEach(function(e){(n=e.colModel)&&i.reverse(n)}),e||r.refreshCM()}}}(jQuery),function(e){function n(n,i){var r=this,o=n.options;r.that=n,r.type="detail",r.refreshComplete=!0,r.rowHtDetail="auto"==(o=o.detailModel.height)?1:o,n.on("cellClick",r.toggle.bind(r)).on("cellKeyDown",function(n,i){if(n.keyCode==e.ui.keyCode.ENTER)return r.toggle(n,i)}).on("beforeViewEmpty",r.onBeforeViewEmpty.bind(r)).on("autoRowHeight",r.onAutoRowHeight.bind(r)).one("render",function(){n.iRenderB.removeView=r.removeView(r,n),n.iRenderB.renderView=r.renderView(r,n)}).one("destroy",r.onDestroy.bind(r)),i._render=r.renderCell.bind(r)}e.extend(e.paramquery.pqGrid.prototype,{parent:function(){return this._parent},child:function(e){return((this.normalize(e).rowData||{}).pq_detail||{}).child}}),(e.paramquery.cHierarchy=n).prototype={detachCells:function(e){e.children().detach(),e.remove()},getCls:function(){return"pq-detail-cont-"+this.that.uuid},getId:function(e){return"pq-detail-"+e+"-"+this.that.uuid},getRip:function(e){return+e.id.split("-")[2]},onAutoRowHeight:function(){var n=this,i=this.that.iRenderB;i.$ele.find("."+n.getCls()).each(function(r,o){var a=n.getRip(o),a=i.getHeightCell(a);e(o).css("top",a)})},onBeforeViewEmpty:function(e,n){var i=n.rowIndxPage,r=this.that.iRenderB,n=n.region,o=0<=i?"#"+this.getId(i):"."+this.getCls(),i=(0<=i?r.$ele:r["$c"+n]).find(o);this.detachCells(i)},onDestroy:function(){(this.that.getData()||[]).forEach(function(e){e.child&&e.child.remove()})},onResize:function(e,n){var i,r=[];pq.onResize(n[0],function(){r.push(n[0]),clearTimeout(i),i=setTimeout(function(){var n=e.that.pdata,i=[];r.forEach(function(r){var o,a,l;document.body.contains(r)&&(o=e.getRip(r),r=r.offsetHeight,(l=(a=n[o]).pq_detail.height||e.rowHtDetail)!=r&&(a.pq_detail.height=r,i.push([o,r-l])))}),r=[],i.length&&(e.that._trigger("onResizeHierarchy"),e.softRefresh(i))},150)})},removeView:function(n,i){var r=i.iRenderB.removeView;return function(i,o,a){for(var l,s,d=r.apply(this,arguments),c=n.getCls(),u=this.getCellRegion(i,a),h=i;h<=o;h++)(l=this.getRow(h,u))&&1==l.children.length&&1==(s=e(l).children("."+c)).length&&(n.detachCells(s),l.parentNode.removeChild(l));return d}},renderView:function(n,i){var r=i.iRenderB.renderView;return function(o,a,l,s){var d,c=r.apply(this,arguments),u=i.iRenderB,h=n.getCls()+" pq-detail",f=i.options,p="padding-"+(f.rtl?"right:":"left:")+(i.dims.wdContLeft+5)+"px;",g=f.freezeRows,m=f.detailModel,v=m.init,$=this.data;if(n.refreshComplete){for(n.refreshComplete=!1,d=o;d<=a;d++)if((C=$[d])&&!C.pq_hidden){var x=C.pq_detail=C.pq_detail||{},w=x.show,y=x.child;if(w){y||"function"==typeof v&&(y=v.call(i,{rowData:C}),x.child=y);var w=y.parent(),C=u.getHeightCell(d),x="position:absolute;left:0;top:"+C+"px;padding:5px;width:100%;overflow:hidden;"+p;if(w.length){if(!document.body.contains(w[0]))throw"incorrectly detached detail";w.css({top:C})}else w=e("<div role='gridcell' id='"+n.getId(d)+"' class='"+h+"' style='"+x+"'></div>").append(y),e(u.getRow(d,d<g?"tr":"right")).append(w),"auto"==m.height&&n.onResize(n,w);for(var _,b,I=w.find(".pq-grid"),q=0,R=I.length;q<R;q++)(b=(_=e(I[q])).pqGrid("instance"))._parent=i,_.hasClass("pq-pending-refresh")&&_.is(":visible")&&(_.removeClass("pq-pending-refresh"),b.refresh())}}return n.refreshComplete=!0,c}}},renderCell:function(e){var n=this.that.options.detailModel,i=e.cellData,e=e.rowData;return e.pq_gsummary||e.pq_gtitle?"":"<div class='ui-icon "+(i&&i.show?n.expandIcon:n.collapseIcon)+"'></div>"},rowExpand:function(e){var n=this.that,e=n.normalize(e),i=n.options,r=e.rowData,o=e.rowIndxPage,i=i.detailModel,a="pq_detail";r&&!1!==n._trigger("beforeRowExpand",null,e)&&((n=r[a]=r[a]||{}).show=!0,i.cache||this.rowInvalidate(e),this.softRefresh([[o,n.height||this.rowHtDetail]],e))},rowInvalidate:function(e){var e=this.that.getRowData(e),n="pq_detail",i=e[n],i=i?i.child:null;i&&(i.remove(),e[n].child=null)},rowCollapse:function(e){var n=this.that,i=n.options,e=n.normalize(e),r=e.rowData,o=e.rowIndxPage,i=i.detailModel,r=r?r.pq_detail:null;r&&r.show&&(e.close=!0,!1!==n._trigger("beforeRowExpand",null,e))&&(i.cache||this.rowInvalidate(e),r.show=!1,this.softRefresh([[o,-(r.height||this.rowHtDetail)]],e))},softRefresh:function(e,n){var i=this.that,r=i.iRenderB;r.initRowHtArrDetailSuper(e),r.setPanes(),r.setCellDims(!0),n&&i.refreshRow(n),r.refresh()},toggle:function(e,n){var i=this.that,r=n.column,o=n.rowData,n=n.rowIndx,a=this.type;o.pq_gtitle||o.pq_gsummary||r&&r.type===a&&i[(o.pq_detail=o.pq_detail||{}).show?"rowCollapse":"rowExpand"]({rowIndx:n})}}}(jQuery),function(e){function n(e){var n=this;n.that=e,n.class="pq-grid-overlay",n.rtl=e.options.rtl?"right":"left",n.ranges=[],e.on("assignTblDims",n.onRefresh(n,e))}(e.paramquery.cCells=n).prototype={addBlock:function(e,n){var i,r,o,a,l,s,d,c,u,h,f,p,g,m,v,$,x,w,y;e&&this.addUnique(this.ranges,e)&&(i=this.that,d=e.r1,l=e.c1,u=e.r2,e=e.c2,o=(r=a=this.serialize(d,l,u,e))+" pq-number-overlay",a+=" pq-head-overlay",f=i.iRenderB,c=function(e,n){return f.getCellCont(e,n)},(m=this.shiftRC(d,l,u,e))&&(d=m[0],l=m[1],u=m[2],e=m[3],y=c(d,l),s=c(u,e),p=(m=f.getCellXY(d,l))[0],g=m[1],v=(m=f.getCellCoords(u,e))[2],x=($=m[3])-g,w=v-p,y==s?this.addLayer(p,g,x,w,r,y,(w?"":"border-left:0;border-right:0; ")+(x?"":"border-top:0;border-bottom:0;")):(d=c(d,e),c=c(u,l),u=y[0].offsetWidth,h=y[0].offsetHeight,c==y?(this.addLayer(p,g,x,u-p,r,y,"border-right:0;"),this.addLayer(0,g,x,v,r,s,"border-left:0;")):y==d?(this.addLayer(p,g,h-g,w,r,y,"border-bottom:0;"),this.addLayer(p,0,$,w,r,s,"border-top:0;")):(this.addLayer(p,g,h-g,u-p,r,y,"border-right:0;border-bottom:0"),this.addLayer(0,g,h-g,v,r,d,"border-left:0;border-bottom:0"),this.addLayer(p,0,$,u-p,r,c,"border-right:0;border-top:0"),this.addLayer(0,0,$,v,r,s,"border-left:0;border-top:0"))),w=i.options.numberCell.outerWidth||0,this.addLayer(0,g,x,w,o,f.$clt,""),this.addLayer(0,g,x,w,o,f.$cleft,""),0!=i.options.showHeader&&(p=(m=(f=i.iRenderHead).getCellXY(0,l))[0],g=m[1],v=(m=f.getCellCoords(i.headerCells.length-1,e))[2],x=($=m[3])-g,y=f.$cright,this.addLayer(p,g,x,w=v-p,a,y,""),y=f.$cleft,this.addLayer(p,g,x,w,a,y,""))))},addLayer:function(n,i,r,o,a,l,s){n=this.rtl+":"+n+"px;top:"+i+"px;height:"+r+"px;width:"+o+"px;"+(s||""),e("<svg class='"+this.class+" "+a+"' style='"+n+"'></svg>").appendTo(l)},addUnique:function(e,n){if(!e.filter(function(e){return n.r1==e.r1&&n.c1==e.c1&&n.r2==e.r2&&n.c2==e.c2})[0])return e.push(n),!0},getLastVisibleFrozenCI:function(){for(var e=this.that,n=e.colModel,i=e.options.freezeCols-1;0<=i;i--)if(!n[i].hidden)return i},getLastVisibleFrozenRIP:function(){for(var e=this.that,n=e.get_p_data(),i=e.riOffset,r=e.options.freezeRows+i-1;i<=r;r--)if(!n[r].pq_hidden)return r-i},getSelection:function(){var e=this.that,n=e.get_p_data(),i=e.colModel,r=[];return this.ranges.forEach(function(e){for(var o,a,l=e.r1,s=e.r2,d=e.c1,c=e.c2,u=l;u<=s;u++)for(o=n[u],a=d;a<=c;a++)r.push({dataIndx:i[a].dataIndx,colIndx:a,rowIndx:u,rowData:o})}),r},isSelected:function(e){var e=this.that.normalize(e),n=e.rowIndx,i=e.colIndx;return null==i||null==n?null:!!this.ranges.find(function(e){var r=e.r1,o=e.r2,a=e.c1,e=e.c2;if(r<=n&&n<=o&&a<=i&&i<=e)return!0})},onRefresh:function(e,n){var i;return function(){clearTimeout(i),i=setTimeout(function(){n.element&&(e.removeAll(),n.Selection().address().forEach(function(n){e.addBlock(n)}))},50)}},removeAll:function(){var e=this.that,n=e.$cont;n&&(n.children().children().children("svg").remove(),e.$head_i.children().children("svg").remove()),this.ranges=[]},removeBlock:function(e){var n,i,r,o,a;e&&(n=e.r1,i=e.c1,r=e.r2,o=e.c2,e=this.that,0<=(a=this.ranges.findIndex(function(e){return n==e.r1&&i==e.c1&&r==e.r2&&o==e.c2}))&&(this.ranges.splice(a,1),a="."+this.class+"."+this.serialize(n,i,r,o),e.$cont.find(a).remove(),e.$head_i.find(a).remove()))},serialize:function(e,n,i,r){return"r1"+e+"c1"+n+"r2"+i+"c2"+r},shiftRC:function(e,n,i,r){var o=this.that,a=(o.iMerge,o.options),l=o.pdata.length,a=a.freezeRows,s=o.riOffset;if(i-=s,!(l<=(e=(e-=s)<a?Math.max(e,Math.min(0,i)):e)||i<0))return e=e+s-s,i=(i=Math.min(i,l-1))+s-s,[e=Math.max(e,0),n,i=Math.min(i,l-1),r=Math.min(r,o.colModel.length-1)]}}}(jQuery),function(e){e.paramquery.pqGrid.prototype.Range=function(e,n){return new pq.Range(this,e,"range",n)};var n=pq.Range=function(e,i,r,o){if(null==e)throw"invalid param";if(this.that=e,this._areas=[],this instanceof n==0)return new n(e,i,r,o);this._type=r||"range",this.init(i,o)};function i(e){e.shiftKey&&"pqGrid:mousePQUp"!=e.type||(this._trigger("selectEnd",null,{selection:this.Selection()}),this.off("mousePQUp",i),this.off("keyUp",i))}n.prototype=e.extend({add:function(e){this.init(e)},address:function(){return this._areas},addressLast:function(){var e=this.address();return e[e.length-1]},history:function(n){function i(i){function m(n,r,o,a){for(var l in n){var s,d=n[l][a],c=(i?r:o)[l],c=e.extend(!0,{},c);for(s in d)d[s]=c[s];for(s in c)d[s]=c[s]}}m(s,o,r,p),m(h,u,c,n),m(d,l,a,g),f.refresh()}var r={},o={},a={},l={},s={},d={},c={},u={},h={},f=this.that,p="pq_cell"+n,g="pq_row"+n;return{add:function(i,o,l){function u(n,i,r,o,a){r[i=n[i]]||(o[i]=n,r[i]=e.extend(!0,{},n[a]))}l?u(i,"pq_ri",r,s,p):o?u(o,"dataIndx",c,h,n):u(i,"pq_ri",a,d,g)},push:function(){function r(e){return Object.keys(e).length}function a(n,i,r){for(var o in n)i[o]=e.extend(!0,{},n[o][r])}(r(s)||r(h)||r(d))&&(a(s,o,p),a(h,u,n),a(d,l,g),f.iHistory.push({callback:i}))}}},refreshStop:function(){this._stop=!0},refresh:function(){this.that.refresh(),this._stop=!1},setAPS:function(e,n,i){function r(n,i,r){(null!=r||n[c])&&(l=(l=n[c]=n[c]||{})[i]=l[i]||{})[e]!=r&&(f.add(n,null,!0),l[e]=r)}var o,a,l,s=this,d=s.that,c="pq_cell"+i,u="pq_row"+i,h="attr"==i,f=s.history(i);s.each(function(c,p,g,m,v,$){o="row"==m,((a="column"==m)||o)&&!h?((l=a?(s.addProp(g),g[i]=g[i]||{}):c[u]=c[u]||{})[e]!=n&&(a?f.add(null,g):f.add(c),l[e]=n),d.Range(a?{c1:$,c2:$}:{r1:v,r2:v},!1).each(function(i,o){var l;a&&null!=(i[u]||{})[e]&&(l=n),r(i,o,l)},!0)):r(c,p,n)},h),f.push(),s._stop||s.refresh()},addProp:function(e){e.prop=e.prop||{get align(){return e.align},set align(t){e.align=t},get format(){return e.format},set format(t){e.format=t},get valign(){return e.valign},set valign(t){e.valign=t},get edit(){return e.editable},set edit(t){e.editable=t}}},setAttr:function(e,n){this.setAPS(e,n,"attr")},setStyle:function(e,n){this.setAPS(e,n,"style")},setProp:function(e,n){this.setAPS(e,n,"prop")},clear:function(){return this.copy({copy:!1,cut:!0,source:"clear"})},clearOther:function(e){for(var n=this._normal(e,!0),i=this.address(),r=i.length-1;0<=r;r--){var o=i[r];o.r1==n.r1&&o.c1==n.c1&&o.r2==n.r2&&o.c2==n.c2||i.splice(r,1)}},clone:function(){return this.that.Range(this._areas)},_cellAttr:function(e,n){return(e=e.pq_cellattr=e.pq_cellattr||{})[n]=e[n]||{}},comment:function(e){return this.attr("title",e)},pic:function(e,n,i){var r=this.that.Pic(),o=0,a=0;this.each(function(e,n,i,r,l,s){return o=l,a=s,!1}),pq.fileToBase(e,function(l){r.add(r.name(e.name),l,[a,n||0,o,i||0])})},_copyArea:function(e,n,i,r,o,a,l,s,d,c,u,h,f,p){for(var g,m,v,$,x,w,y=this.that,C=y.readCell,_=this.getRenderVal,b=y.iMerge,I=[],q=[],R=[],D=y.riOffset,M=y.iRenderB,T=i;T<=r;T++)w=(x=o[T]).dataType,I[T]=!w||"string"==w||"html"==w,!1===(q[T]=x.copy)?p.push(T):h&&R.push(this.getTitle(x,T));for(h&&a.push(R.slice()),v=e;v<=n;v++){var k=s[v],S={},E={},P={rowIndx:v,rowIndxPage:v-D,rowData:k,Export:!0,exportClip:!0};if(!1===k.pq_copy)f.push(v);else{for(R=[],T=i;T<=r;T++)$=(x=o[T]).dataIndx,!1!==q[T]&&(g=k[$],c&&((m=C(k,x,b,v,T))===g&&(P.colIndx=T,P.column=x,P.dataIndx=$,m=_(P,u,M)[0],I[T]&&/(\r|\n)/.test(m)&&(m=this.newLine(m))),R.push(m)),d&&void 0!==g&&(S[$]=void 0,E[$]=g));d&&l.push({rowIndx:v,rowData:k,oldRow:E,newRow:S}),a.push(R.slice())}}},copy:function(e){var n,i,r,o,a,l=this.that,s=(e=e||{}).dest,d=!!e.cut,c=null==e.copy||e.copy,u=e.source||(d?"cut":"copy"),h=e.history,f=e.allowInvalid,p=[],g=[],m=[],v=[],$=l.get_p_data(),x=l.colModel,w=e.render,y=e.header,C=l.options.copyModel,_=(navigator||{}).clipboard,b=this.address(),I={areas:b,cut:d,dest:s,header:y},h=null==h||h,f=null==f||f,w=null==w?C.render:w,y=null==y?C.header:y;b.length&&!1!==l._trigger("beforeCopy",null,I)&&(b.forEach(function(e){o=e.type,n=e.r1,i=e.c1,r="cell"===o?n:e.r2,o="cell"===o?i:e.c2,this._copyArea(n,r,i,o,x,g,p,$,d,c,w,y,m,v)},this),c&&(C=e.clip,a=g.map(function(e){return e.join("	")||" "}).join("\n"),C?(C.val(a),C.select()):(_&&_.writeText(a),l._setGlobalStr(a)),I.data=g,I.skippedRIs=m,I.skippedCIs=v,l._trigger("copy",null,I)),s?l.paste({text:a,dest:s,rowList:p,history:h,allowInvalid:f}):d&&!1!==l._digestData({updateList:p,source:u,history:h,allowInvalid:f})&&l.refresh({source:u,header:!1}))},_countArea:function(e){var n=e.type,i=e.r1,r=e.c1,o=e.r2,e=e.c2;return"cell"===n?1:"row"===n?0:(o-i+1)*(e-r+1)},count:function(){for(var e="range"===this._type,n=this.address(),i=0,r=n.length,o=0;o<r;o++)i+=e?this._countArea(n[o]):1;return i},cut:function(e){return(e=e||{}).cut=!0,this.copy(e)},_eachRC:function(e,n,i,r){this.address().forEach(function(n){for(var o=n[i],a=n[r];o<=a;o++)e(this[o],o)},this.that[n])},eachCol:function(e){this._eachRC(e,"colModel","c1","c2")},eachRow:function(e){this._eachRC(e,"pdata","r1","r2")},_hsCols:function(e){var n=[],i={};this.eachCol(function(e){n.push(e.dataIndx)}),i[e]=n,this.that.Columns().hide(i)},hideCols:function(){this._hsCols("diHide")},showCols:function(){this._hsCols("diShow")},hideRows:function(){this.eachRow(function(e){e.pq_hidden=!0})},showRows:function(){this.eachRow(function(e){e.pq_hidden=!1})},each:function(e,n){for(var i=this.that,r=i.colModel,o=this.address(),a=0,l=i.pdata;a<o.length;a++)for(var s,d,c,u=o[a],h=u.r1,f=u.r2,p=u.c2,g=u.type,m="column"==g,v="row"==g;h<=f;h++){if(s=l[h])for(d=(d=u.c1)<0?0:d;d<=p;d++){if((c=r[d])&&!1===e(s,c.dataIndx,c,g,h,d))return;if(v&&!n)break}if(m&&!n)break}},enable:function(e){return null==(e=this.prop("edit",e))||e},getAPS:function(e,n){var i,r,o,a,l=this;return l.each(function(s,d,c){return l.addProp(c),o=((s["pq_cell"+n]||{})[d]||{})[e],a=(s["pq_row"+n]||{})[e],i=(c[n]||{})[e],r=null==o?null==a?i:a:o,!1}),r},getAttr:function(e){return this.getAPS(e,"attr")},getProp:function(e){return this.getAPS(e,"prop")},getStyle:function(e){return this.getAPS(e,"style")},getIndx:function(e){return null==e?this._areas.length-1:e},getValue:function(){var e,n,i,r,o,a,l,s,d,c=this.address(),u=[],h=this.that;if(c.length){for(i=(c=c[0]).r1,r=c.c1,o=c.r2,a=c.c2,d=h.get_p_data(),l=i;l<=o;l++)for(e=d[l],s=r;s<=a;s++)n=e[h.colModel[s].dataIndx],u.push(n);return u}},indexOf:function(e){for(var n,i=(e=this._normal(e)).r1,r=e.c1,o=e.r2,a=e.c2,l=this.address(),s=0,d=l.length;s<d;s++)if(i>=(n=l[s]).r1&&o<=n.r2&&r>=n.c1&&a<=n.c2)return s;return -1},index:function(e){for(var n,i=(e=this._normal(e)).type,r=e.r1,o=e.c1,a=e.r2,l=e.c2,s=this.address(),d=0,c=s.length;d<c;d++)if(i===(n=s[d]).type&&r===n.r1&&a===n.r2&&o===n.c1&&l===n.c2)return d;return -1},init:function(e,n){var i,r;if(n=!1!==n,e){if("function"==typeof e.push)for(var o=0,a=e.length;o<a;o++)this.init(e[o],n);else"string"==typeof e?this.init(pq.getAddress(e),n):(i=this._normal(e,n),r=this._areas=this._areas||[],i&&r.push(i))}},isValid:function(){return!!this._areas.length},format:function(e){return this.prop("format",e)},merge:function(e){e=e||{};var n,i,r=this.that,o=r.options.mergeCells,a=this._areas[0];a&&(n=a.r2-a.r1+1,i=a.c2-a.c1+1,(1<n||1<i)&&(a.rc=n,a.cc=i,o.push(a),!1!==e.refresh&&r.refreshView()))},newLine:function(e){return'"'+e.replace(/"/g,'""')+'"'},replace:function(e,n){var e=this._normal(e),i=this._areas,n=this.getIndx(n);i.splice(n,1,e)},remove:function(e){var n=this._areas,e=this.indexOf(e);0<=e&&n.splice(e,1)},resize:function(e,n){var i=this._normal(e),r=this._areas[this.getIndx(n)];return["r1","c1","r2","c2","rc","cc","type"].forEach(function(e){r[e]=i[e]}),this},rows:function(e){var n=this.that,i=[],r=this.addressLast();if(r)for(var o=r.r1,a=r.c1,l=r.r2,s=r.c2,d=r.type,c=null==e?l:o+e,u=null==e?o:o+e;u<=c;u++)i.push({r1:u,c1:a,r2:u,c2:s,type:d});return pq.Range(n,i,"row")},_normal:function(e,n){if(e.type)return e;if("function"==typeof e.push){for(var i=[],r=0,o=e.length;r<o;r++){var a=this._normal(e[r],n);a&&i.push(a)}return i}var l,s,d=this.that,c=d.get_p_data().length-1,u=d.colModel.length-1,h=c<(h=e.r1)?c:h,f=u<(f=e.c1)?u:f,p=e.rc,g=e.cc,m=e.r2,v=e.c2;return u<0||c<0?null:null!=h||null!=f?(m<h&&(l=h,h=m,m=l),v<f&&(l=f,f=v,v=l),null==h?(h=0,m=c,v=null==v?f:v,s="column"):null==f?(e._type,f=0,m=null==m?h:m,v=u,s=e._type||"row"):null==m&&null==p||h==m&&f==v?(s="cell",m=h,v=f):s="block",m=c<(m=p?h+p-1:m)?c:m,v=u<(v=g?f+g-1:v)?u:v,n&&("block"==s||"cell"==s)&&(h=(i=d.iMerge.inflateRange(h,f,m,v))[0],f=i[1],m=i[2],v=i[3]),p=m-h+1,g=v-f+1,e.r1=h,e.c1=f,e.r2=m,e.c2=v,e.rc=p,e.cc=g,e.type=e.type||s,e):void 0},select:function(){var e=this.that.iSelection,n=this._areas;return n.length&&(e.removeAll({trigger:!1}),n.forEach(function(n){e.add(n,!1)}),e.trigger()),this},style:function(e,n){return this._prop(e,n,"Style")},_prop:function(e,n,i){return this[(null!=n?"set":"get")+i](e,n)},attr:function(e,n){return this._prop(e,n,"Attr")},prop:function(e,n){return this._prop(e,n,"Prop")},toggleStyle:function(e,n){var i=this.getStyle(e),i=i&&i!=n[1]?n[1]:n[0];this.style(e,i)},unmerge:function(e){e=e||{};var n=this.that,i=n.options.mergeCells,r=this._areas[0];if(r){for(var o=0;o<i.length;o++){var a=i[o];if(a.r1===r.r1&&a.c1===r.c1){i.splice(o,1);break}}!1!==e.refresh&&n.refreshView()}},align:function(e){return this.prop("align",e)},valign:function(e){return this.prop("valign",e)},value:function(e){var n=0,i=this.that,r=i.colModel,o=[],a=this.address();if(void 0===e)return this.getValue();for(var l=0;l<a.length;l++)for(var s,d=(s=a[l]).r1,c=s.c1,u=s.r2,h=s.c2,f=d;f<=u;f++){for(var p=i.normalize({rowIndx:f}),g=p.rowData,p=p.rowIndx,m={},v={},$=c;$<=h;$++){var x=r[$].dataIndx;v[x]=e[n++],m[x]=g[x]}o.push({rowData:g,rowIndx:p,newRow:v,oldRow:m})}return o.length&&(i._digestData({updateList:o,source:"range"}),i.refresh({header:!1})),this},val2D:function(){var e,n=[],i=this.that,r={};for(e in this._areas.forEach(function(e){for(var n,o=e.c1,a=e.c2,l=e.r1;l<=e.r2;l++)n=i.Range({r1:l,rc:1,c1:o,c2:a}).value(),r[l]=r[l]?r[l].concat(n):n}),r)n.push(r[e]);return n}},pq.mixin.render);var r=pq.Selection=function(n,i){if(null==n)throw"invalid param";if(this instanceof r==0)return new r(n,i);this._areas=[],this.that=n,this.iCells=new e.paramquery.cCells(n),this._base(n,i)};pq.extend(n,r,{add:function(e,n){var e=this._normal(e,!0),i=this.iCells;0<=this.indexOf(e)||(i.addBlock(e),this._super(e),!1!==n&&this.trigger())},clearOther:function(e,n){var i=this.iCells,r=this._normal(e,!0);this.address().forEach(function(e){e.r1==r.r1&&e.c1==r.c1&&e.r2==r.r2&&e.c2==r.c2||i.removeBlock(e)}),this._super(r),n||this.trigger()},getSelection:function(){return this.iCells.getSelection()},isSelected:function(e){return this.iCells.isSelected(e)},removeAll:function(e){e=e||{},this._areas.length&&(this.iCells.removeAll(),this._areas=[],!1!==e.trigger&&this.trigger())},resizeOrReplace:function(e,n){this.resize(e,n)||this.replace(e,n)},replace:function(e,n){var i=this.iCells,e=this._normal(e),r=this._areas,n=this.getIndx(n),r=r[n];i.removeBlock(r),i.addBlock(e),this._super(e,n),this.trigger()},resize:function(e,n){var e=this._normal(e,!0),i=e.r1,r=e.c1,o=e.r2,e=e.c2,a=this._areas||[];if(!a.length)return!1;var a=a[this.getIndx(n)],n=a.r1,l=a.c1,s=a.r2,a=a.c2;return n===i&&l===r&&n===i&&a===e&&s===o&&l===r&&s===o&&a===e||void 0},selectAll:function(e){var n=(e=e||{}).type,i=this.that,r=i.colModel,e=e.all,o=e?0:i.riOffset,e=(e?i.get_p_data():i.pdata).length,r=r.length-1,e=o+e-1,n="row"===n?{r1:o,r2:e}:{c1:0,c2:r,_type:"column",r1:0,r2:e};return i.Range(n).select(),this},trigger:function(){var e=this.that;e._trigger("selectChange",null,{selection:this}),e.off("mousePQUp",i),e.off("keyUp",i),e.on("mousePQUp",i),e.on("keyUp",i)}})}(jQuery),function(e){var n=e.paramquery;e.widget("paramquery.pqToolbar",{options:{items:[],gridInstance:null,events:{button:"click",select:"change",checkbox:"change",textbox:"change",textarea:"change",file:"change"}},_create:function(){var i,r=this.options,o=r.gridInstance,a=r.events,l=r.bootstrap,s=l.on,d=o.colModel,c=o.options.filterModel.timeout,u=r.items,h=this.element,f=0,p=u.length;for(h.addClass("pq-toolbar");f<p;f++){var g,m,v,$,x=u[f],w=x.type,y=x.value,C=x.icon,_=x.options||{},b=x.label,I=x.init,q=((g=x.listener)?[g]:x.listeners)||[function(){}],R=x.cls,R=R||"",R=(R=s&&"button"==w?l.btn+" "+R:R)?"class='"+R+"'":"",D=x.style,D=D?"style='"+D+"'":"",M=x.attr||"",T=b?"<label "+D+">"+b:"",k=b?"</label>":"",S=(S=b&&"button"!=w&&"file"!=w?[R,M]:[R,M,D]).join(" ");x.options=_,"textbox"==w?$=e([T,"<input type='text' "+S+">",k].join("")):"textarea"==w?$=e([T,"<textarea "+S+"></textarea>",k].join("")):"select"==w?("function"==typeof _&&(_=_.call(o,{colModel:d})),$=e([T,m=n.select({options:_=_||[],attr:S,prepend:x.prepend,groupIndx:x.groupIndx,valueIndx:x.valueIndx,labelIndx:x.labelIndx}),k].join(""))):"file"==w?$=e(["<label class='ui-button ui-widget ui-state-default ui-corner-all "+(R=C&&b?"ui-button-text-icon-primary":C?"ui-button-icon-only":"ui-button-text-only")+"' "+M+" "+D+">","<input type='file' style='display:none;' "+(x.attrFile||"")+">",C?"<span class='ui-button-icon-primary ui-icon "+C+"'></span>":"","<span class='ui-button-text'>"+(b||"")+"</span>","</label>"].join("")):"checkbox"==w?$=e([b?"<label "+D+">":"","<input type='checkbox' ",y?"checked='checked' ":"",S,">",b?b+"</label>":""].join("")):"separator"==w?$=e("<span class='pq-separator' "+[M,D].join(" ")+"></span>"):"button"==w?($=e("<button type='button' "+S+">"+(s&&C?"<span class='glyphicon "+C+"'></span>":"")+b+"</button>"),e.extend(_,{label:b||!1,icon:C,icons:{primary:s?"":C}}),$.button(_)):"string"==typeof w?$=e(w):"function"==typeof w&&($=e(m=w.call(o,{colModel:d,cls:R}))),$.appendTo(h),I&&I.call(o,$[0]),v=this.getInner($,b,w),"checkbox"!==w&&void 0!==y&&v.val(y);for(var E=0,P=q.length;E<P;E++){var A={};for(i in"function"==typeof(g=q[E])?A[a[w]]=g:A=g,A)pq.fakeEvent(v,i,c),v.on(i,this._onEvent(o,A[i],x))}}}}),e.extend(n.pqToolbar.prototype,{getInner:function(n,i,r){var o=n[0];return"LABEL"==o.nodeName.toUpperCase()?e(o.children[0]):n},refresh:function(){this.element.empty(),this._create()},_onEvent:function(n,i,r){return function(o){var a=r.type;r.value="checkbox"==a?e(o.target).prop("checked"):e(o.target).val(),i.call(n,o),"file"==a&&e(this).val("")}},_destroy:function(){this.element.empty().removeClass("pq-toolbar").enableSelection()},_disable:function(){null==this.$disable&&(this.$disable=e("<div class='pq-grid-disable'></div>").css("opacity",.2).appendTo(this.element))},_enable:function(){this.$disable&&(this.element[0].removeChild(this.$disable[0]),this.$disable=null)},_setOption:function(e,n){"disabled"==e&&(1==n?this._disable():this._enable())}}),pq.toolbar=function(n,i){return(n=e(n).pqToolbar(i)).data("paramqueryPqToolbar")||n.data("paramquery-pqToolbar")}}(jQuery),function(e){var n=e.paramquery,i=n.pqGrid.prototype;i.options.trackModel={on:!1,dirtyClass:"pq-cell-dirty"},n.cUCData=function(e){this.that=e,this.udata=[],this.ddata=[],this.adata=[],this.options=e.options,e.on("dataAvailable",this.onDA(this))},n.cUCData.prototype={add:function(e){for(var n=this.that,i=this.adata,r=this.ddata,o=e.rowData,a=this.options.trackModel.dirtyClass,l=n.getRecId({rowData:o}),s=0,d=i.length;s<d;s++){var c=i[s];if(null!=l&&c.recId==l)throw"primary key violation";if(c.rowData==o)throw"same data can't be added twice."}for(s=0,d=r.length;s<d;s++)if(o==r[s].rowData)return void r.splice(s,1);var u,h=[];for(u in o)h.push(u);n.removeClass({rowData:o,dataIndx:h,cls:a}),e={recId:l,rowData:o},i.push(e)},commit:function(e){var n,i,r,o,a=this.that;null==e?(this.commitAddAll(),this.commitUpdateAll(),this.commitDeleteAll()):(o=e.history,n=[],i=a.options.dataModel.recIndx,r=e.type,e=e.rows,o=null!=o&&o,"add"==r?e?n=this.commitAdd(e,i):this.commitAddAll():"update"==r?e?this.commitUpdate(e,i):this.commitUpdateAll():"delete"==r&&(e?this.commitDelete(e,i):this.commitDeleteAll()),n.length&&(a._digestData({source:"commit",checkEditable:!1,track:!1,history:o,updateList:n}),a.refreshView({header:!1})))},commitAdd:function(n,i){for(var r,o,a,l,s=this.that,d=s.colModel,c=d.length,u=this.adata,h=e.inArray,f=u.length,p=s.getValueFromDataType,g=[],m=n.length,v=[],$=0;$<m;$++)for(a=n[$],I=0;I<f;I++)if(l=!0,-1==h(o=u[I].rowData,v)){for(r=0;r<c;r++){var x=d[r],w=x.dataType,y=x.dataIndx;if(!x.hidden&&y!=i&&p(o[y],w)!==p(a[y],w)){l=!1;break}}if(l){var C={},_={};C[i]=a[i],_[i]=o[i],g.push({rowData:o,oldRow:_,newRow:C}),v.push(o);break}}for(var b=[],I=0;I<f;I++)-1==h(o=u[I].rowData,v)&&b.push(u[I]);return this.adata=b,g},commitDelete:function(e,n){for(var i,r,o,a,l=this.ddata,s=l.length,d=this.udata;s--&&(r=(i=l[s].rowData)[n],o=e.length);)for(;o--;)if(r==e[o][n]){for(e.splice(o,1),l.splice(s,1),a=d.length;a--;)d[a].rowData==i&&d.splice(a,1);break}},commitUpdate:function(n,i){for(var r,o=this.that,a=this.options.trackModel.dirtyClass,l=this.udata,s=l.length,d=n.length,c=[],u=0;u<s;u++){var h=l[u],f=h.rowData,p=h.oldRow;if(-1==e.inArray(f,c))for(r=0;r<d;r++){var g=n[r];if(f[i]==g[i])for(var m in c.push(f),p)o.removeClass({rowData:f,dataIndx:m,cls:a})}}var v=[];for(u=0;u<s;u++)f=l[u].rowData,-1==e.inArray(f,c)&&v.push(l[u]);this.udata=v},commitAddAll:function(){this.adata=[]},commitDeleteAll:function(){for(var e,n=this.ddata,i=this.udata,r=i.length,o=n.length,a=0;0<r&&a<o;a++){for(e=n[a].rowData;r--;)i[r].rowData==e&&i.splice(r,1);r=i.length}n.length=0},commitUpdateAll:function(){for(var e=this.that,n=this.options.trackModel.dirtyClass,i=this.udata,r=0,o=i.length;r<o;r++){var a,l=i[r],s=l.oldRow,d=l.rowData;for(a in s)e.removeClass({rowData:d,dataIndx:a,cls:n})}this.udata=[]},delete:function(e){for(var n=this.that,i=e.rowIndx,r=e.rowIndxPage,o=n.riOffset,i=null==i?r+o:i,r=null==r?i-o:r,o="remote"==n.options.pageModel.type?r:i,a=this.adata,r=this.ddata,l=n.getRowData(e),s=0,d=a.length;s<d;s++)if(a[s].rowData==l)return void a.splice(s,1);r.push({indx:o,rowData:l,rowIndx:i})},getChangesValue:function(n){for(var i=this.that,r=(n=n||{}).all,o=this.udata,a=this.adata,l=this.ddata,s=[],d=[],c=[],u=[],h=[],f=[],p=0,g=l.length;p<g;p++){var m=(w=l[p]).rowData,v={};for(x in h.push(m),m)0!=x.indexOf("pq_")&&(v[x]=m[x]);f.push(v)}for(p=0,g=o.length;p<g;p++){var $=(w=o[p]).oldRow,m=w.rowData;if(-1==e.inArray(m,h)&&-1==e.inArray(m,s)){if(v={},!1!==r)for(var x in m)0!=x.indexOf("pq_")&&(v[x]=m[x]);else{for(var x in $)v[x]=m[x];v[i.options.dataModel.recIndx]=w.recId}s.push(m),d.push(v),c.push($)}}for(p=0,g=a.length;p<g;p++){var w,v={};for(x in m=(w=a[p]).rowData)0!=x.indexOf("pq_")&&(v[x]=m[x]);u.push(v)}return{updateList:d,addList:u,deleteList:f,oldList:c}},getChanges:function(){this.that;for(var n=this.udata,i=this.adata,r=this.ddata,o=e.inArray,a=[],l=[],s=[],d=[],c=0,u=r.length;c<u;c++){var h=(p=r[c]).rowData;d.push(h)}for(c=0,u=n.length;c<u;c++){var f=(p=n[c]).oldRow;-1==o(h=p.rowData,d)&&-1==o(h,a)&&(a.push(h),l.push(f))}for(c=0,u=i.length;c<u;c++){var p,h=(p=i[c]).rowData;s.push(h)}return{updateList:a,addList:s,deleteList:d,oldList:l}},getChangesRaw:function(){this.that;var e=this.udata,n=this.adata,i=this.ddata,r={updateList:[],addList:[],deleteList:[]};return r.updateList=e,r.addList=n,r.deleteList=i,r},isDirty:function(e){var n=this.that,i=this.udata,r=this.adata,o=this.ddata,a=!1,l=n.getRowData(e);if(l){for(var s=0;s<i.length;s++)if(l==i[s].rowData){a=!0;break}}else(i.length||r.length||o.length)&&(a=!0);return a},onDA:function(e){return function(n,i){"filter"!=i.source&&(e.udata=[],e.ddata=[],e.adata=[])}},rollbackAdd:function(e,n){for(var i=this.adata,r=[],o=(e.type,0),a=i.length;o<a;o++){var l=i[o].rowData;r.push({type:"delete",rowData:l})}return this.adata=[],r},rollbackDelete:function(e,n){for(var i=this.ddata,r=[],o=(e.type,i.length-1);0<=o;o--){var a=i[o],l=(a.indx,a.rowIndx),a=a.rowData;r.push({type:"add",rowIndx:l,newRow:a})}return this.ddata=[],r},rollbackUpdate:function(e,n){for(var i=this.that,r=this.options.trackModel.dirtyClass,o=this.udata,a=[],l=0,s=o.length;l<s;l++){var d=o[l],c=d.recId,u=d.rowData,h={},d=d.oldRow;if(null!=c){var f,p=[];for(f in d)h[f]=u[f],p.push(f);i.removeClass({rowData:u,dataIndx:p,cls:r,refresh:!1}),a.push({type:"update",rowData:u,newRow:d,oldRow:h})}}return this.udata=[],a},rollback:function(e){var n=this.that,i=n.options.dataModel,r=n.options.pageModel,o=!e||null==e.refresh||e.refresh,e=e&&null!=e.type?e.type:null,a=[],l=[],s=[],i=i.data;null!=e&&"update"!=e||(l=this.rollbackUpdate(r,i)),null!=e&&"delete"!=e||(a=this.rollbackDelete(r,i)),null!=e&&"add"!=e||(s=this.rollbackAdd(r,i)),n._digestData({history:!1,allowInvalid:!0,checkEditable:!1,source:"rollback",track:!1,addList:a,updateList:l,deleteList:s}),o&&n.refreshView({header:!1})},update:function(n){var i=this.that,r=this.options.trackModel.dirtyClass,o=n.rowData||i.getRowData(n),a=i.getRecId({rowData:o}),l=n.dataIndx,s=n.refresh,d=i.columns,c=i.getValueFromDataType,u=n.row,h=this.udata,f=h.slice(0),p=!1;if(null!=a){for(var g=0,m=h.length;g<m;g++){var v=h[g],$=v.oldRow;if(v.rowData==o){for(var l in p=!0,u){var x=d[l].dataType,w=c(u[l],x),x=c($[l],x);$.hasOwnProperty(l)&&x===w?(i.removeClass(y={rowData:o,dataIndx:l,refresh:s,cls:r}),delete $[l]):(i.addClass(y={rowData:o,dataIndx:l,refresh:s,cls:r}),$.hasOwnProperty(l)||($[l]=o[l]))}e.isEmptyObject($)&&f.splice(g,1);break}}if(!p){for(l in $={},u){$[l]=o[l];var y={rowData:o,dataIndx:l,refresh:s,cls:r};i.addClass(y)}y={rowData:o,recId:a,oldRow:$},f.push(y)}this.udata=f}}},i.getChanges=function(e){if(this.blurEditor({force:!0}),e){var n=e.format;if(n){if("byVal"==n)return this.iUCData.getChangesValue(e);if("raw"==n)return this.iUCData.getChangesRaw()}}return this.iUCData.getChanges()},i.rollback=function(e){this.blurEditor({force:!0}),this.iUCData.rollback(e)},i.isDirty=function(e){return this.iUCData.isDirty(e)},i.commit=function(e){this.iUCData.commit(e)},i.updateRow=function(n){var i=this,r=n.rowList||[{rowIndx:n.rowIndx,newRow:n.newRow||n.row,rowData:n.rowData,rowIndxPage:n.rowIndxPage}],o=[];if(i.normalizeList(r).forEach(function(e){var n,i=e.newRow,r=e.rowData,a=e.oldRow={};if(r){for(n in i)a[n]=r[n];o.push(e)}}),o.length){if(r={source:n.source||"update",history:n.history,checkEditable:n.checkEditable,track:n.track,allowInvalid:n.allowInvalid,updateList:o},!1===(n=i._digestData(r)))return!1;e.isArray(n)&&n.forEach(function(e){i.refreshCell({rowIndx:e[0],colIndx:e[1],skip:!0})})}},i.getRecId=function(e){var n=this.options.dataModel,n=(e.dataIndx=n.recIndx,this.getCellData(e));return null==n?null:n},i.getCellData=function(e){var n=e.rowData||this.getRowData(e),e=e.dataIndx;return n?n[e]:null},i.getRowData=function(e){if(!e)return null;var n,i=e.rowData;if(null!=i)return i;if(null==(n=e.recId))return i=null!=(i=e.rowIndx)?i:e.rowIndxPage+this.riOffset,this.get_p_data()[i];for(var r,e=this.options.dataModel,o=e.recIndx,a=e.data,l=0,s=a.length;l<s;l++)if((r=a[l])[o]==n)return r;return null},i.addNodes=function(e,n){n=null==n?this.options.dataModel.data.length:n,this._digestData({addList:e.map(function(e){return{rowIndx:n++,newRow:e}}),source:"addNodes"}),this.refreshView()},i.deleteNodes=function(e){this._digestData({deleteList:e.map(function(e){return{rowData:e}}),source:"deleteNodes"}),this.refreshView()},i.moveNodes=function(e,n){var i=this.options,r=this.riOffset,o=i.dataModel.data;n=null==n?o.length:n,this._trigger("beforeMoveNode"),e.forEach(function(e){n=pq.moveItem(e,o,o.indexOf(e),n)}),o!=this.pdata&&(this.pdata=o.slice(r,i.pageModel.rPP+r)),this.iRefresh.addRowIndx(),this.iMerge.init(),this._trigger("moveNode",null,{args:arguments}),this.refresh()},i.deleteRow=function(e){var n=this.normalizeList(e.rowList||[{rowIndx:e.rowIndx,rowIndxPage:e.rowIndxPage,rowData:e.rowData}]);if(!n.length)return!1;this._digestData({source:e.source||"delete",history:e.history,track:e.track,deleteList:n}),!1!==e.refresh&&this.refreshView({header:!1})},i.addRow=function(e){var n=this.riOffset,i=this.options.dataModel,i=i.data=i.data||[];return e.rowData&&(e.newRow=e.rowData),null!=e.rowIndxPage&&(e.rowIndx=e.rowIndxPage+n),!(!(n=e.rowList||[{rowIndx:e.rowIndx,newRow:e.newRow}]).length||!1===this._digestData({source:e.source||"add",history:e.history,track:e.track,checkEditable:e.checkEditable,addList:n}))&&(!1!==e.refresh&&this.refreshView({header:!1}),null==(e=n[0].rowIndx)?i.length-1:e)}}(jQuery),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(e){return setTimeout(e,10)},window.cancelAnimationFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)},function(e){var n=e.paramquery;function i(e){(this.that=e).on("cellClick",this.onCellClick.bind(this)).on("cellMouseDown",this.onCellMouseDown.bind(this)).on("cellMouseEnter",this.onCellMouseEnter.bind(this))}(n.cMouseSelection=i).prototype=e.extend({onCellMouseDown:function(n,i){if(!n.isDefaultPrevented()){var r=this.that,o=i.rowIndx,a=r.iSelection,l=i.colIndx,s=r.options.selectionModel,d=s.type,c=s.mode,u=a.addressLast();if(!e(n.originalEvent.target).is("input,textarea,select")){if("cell"==d){if(null==l)return;if(-1==l){if(!s.row)return;l=void 0}n.shiftKey&&"single"!==c&&u?(d=u.firstR,s=u.firstC,this.mousedown={r1:d,c1:s},a.resizeOrReplace({r1:d,c1:null==l?void 0:s,r2:o,c2:l,firstR:d,firstC:s})):pq.isCtrl(n)&&"single"!==c?(this.mousedown={r1:o,c1:l},null==l?a.add({r1:o,firstR:o,firstC:r.getFirstVisibleCI()}):a.add({r1:o,c1:l,firstR:o,firstC:l})):(this.mousedown={r1:o,c1:l},a.clearOther({r1:o,c1:l},!0),null==l?a.resizeOrReplace({r1:o,firstR:o,firstC:r.getFirstVisibleCI()}):a.resizeOrReplace({r1:o,c1:l,firstR:o,firstC:l}))}i.nofocus=!0,r[-1==i.colIndx?"focusT":"focus"](i),r.one("mousePQUp",this.onMousePQUp.bind(this))}}},onCellMouseEnter:function(e,n){var i,r,o=this.that,a=o.options.selectionModel,l=a.type,s=this.mousedown,a=a.mode;s&&"single"!==a&&("cell"===l&&(a=s.r1,l=s.c1,s=n.rowIndx,i=n.colIndx,r=o.Selection(),o.scrollCell({rowIndx:s,colIndx:i}),r.resizeOrReplace({r1:a,c1:l,r2:s,c2:i,firstR:a,firstC:l})),n.nofocus=!0,o.focusT(n))},onCellClick:function(e,n){var i=this.that,r=i.options.selectionModel,o="single"==r.mode,a=r.toggle,i=i.iRows;"row"!=r.type||!r.row&&-1==n.colIndx||(r=i.isSelected(n),o&&!r||a||!pq.isCtrl(e)?!o&&e.shiftKey?i.extend(n):!o||r&&a?(n.isFirst=!0,i[a?"toggle":"replace"](n)):r||i.replace(n):(n.isFirst=!0,i.toggle(n)))},onMousePQUp:function(){var e=this.that;window.getSelection().toString().length||e.focus(),this.mousedown=null}},new n.cClass)}(jQuery),function(e){var n=null,i=!1,r="pq-grid-excel",o=e.paramquery,a=o.pqGrid.prototype,l=(e.extend(a.options,{copyModel:{on:!0,render:!1,zIndex:1e4},cutModel:{on:!0},pasteModel:{on:!0,compare:"byVal",select:!0,validate:!0,allowInvalid:!0,type:"replace"}}),e.extend(a,{_setGlobalStr:function(e){l.clip=e},canPaste:function(){return!!o.cExcel.clip},clearPaste:function(){o.cExcel.clip=""},copy:function(e){return this.iSelection.copy(e)},cut:function(e){return this.iSelection.cut(e)},paste:function(e){function i(){n.paste(e),n=null}e=e||{};var r=(navigator||{}).clipboard;n=new l(this),null==e.text&&r&&r.readText?r.readText().then(function(n){e.text=n,i()}).catch(function(e){i()}):i()},clear:function(){var e=this.iSelection;(e.address().length?e:this.iRows.toRange()).clear()}}),o.cExcel=function(e){this.that=e}),s=(l.clip="",l.prototype={createClipBoard:function(){var n=this.that,i=(e("#pq-grid-excel-div"),n.options.copyModel),o=e("#"+r);0==o.length&&(i=e("<div id='pq-grid-excel-div'  style='position:fixed;top:20px;left:20px;height:1px;width:1px;overflow:hidden;z-index:"+i.zIndex+";'/>").appendTo(document.body),(o=e("<textarea id='"+r+"' autocomplete='off' spellcheck='false' style='overflow:hidden;height:10000px;width:10000px;opacity:0' />").appendTo(i)).css({opacity:0}).on("keyup",function(e){pq.isCtrl(e)&&n.element&&n._trigger("keyUp",e)})),o.on("focusin",function(e){e.stopPropagation()}),o.select()},destroyClipBoard:function(){this.clearClipBoard();var n=this.that,i=e(window).scrollTop(),r=e(window).scrollLeft(),n=(n.focus(),e(window).scrollTop()),o=e(window).scrollLeft();i==n&&r==o||window.scrollTo(r,i)},clearClipBoard:function(){e("#"+r).val("")},copy:function(e){var n=this.that,i=n.iSelection;if(i.address().length)return i.copy(e);n.iRows.toRange().copy(e)},getRows:function(e){return(e=(e=e.replace(/\n$/,"")).replace(/(^|\t|\n)"(?=[^\t]*?[\r\n])([^"]|"")*"(?=$|\t|\n)/g,function(e){return e.replace(/(?!^(\r\n|\n))(\r\n|\n)/g,"\r").replace(/^(\t|\n)?"/,"$1").replace(/"$/,"").replace(/""/g,'"')})).split("\n")},paste:function(n){var i=this.that,r=(n=n||{}).dest,o=n.clip,n=n.text||(o?o.length?o.val():"":l.clip),a=this.getRows(n),s=a.length,d=i.colModel,o=i.options,c=i.readCell,o=o.pasteModel,u="row",h=!1,f=d.length;if(o.on&&0!=n.length&&0!=s){for(var p=0;p<s;p++)a[p]=a[p].split("	");var g,m,v,$,x,w,y=o.type,n=(r?i.Range(r):i.Selection()).address(),r=(n.length?n:i.iRows.toRange().address())[0],n={rows:a,areas:[r]};if(!1===i._trigger("beforePaste",null,n))return!1;$=r&&i.getRowData({rowIndx:r.r1})?(u="row"==r.type?"row":"cell",g=r.r1,v=r.r2,m=r.c1,r.c2):(u="cell",m=v=g=0),"replace"==y?w=v-(x=g)+1<s?"extend":"repeat":"append"==y?(x=v+1,w="extend"):"prepend"==y&&(x=g,w="extend");for(var C,_,b="extend"==w?s:v-g+1,I=0,q=0,R=[],D=[],M=0,p=0;p<b;p++){var T=a[I],k=p+x,S="replace"==y?i.getRowData({rowIndx:k}):null,E=S?{}:null,P={};if(void 0===T&&"repeat"===w&&(T=a[I=0]),S&&!1===S.pq_paste)b++,q++;else{I++;var A=T,H=A.length;if(!_){if("cell"==u){if(isNaN(_="extend"==(C=$-m+1<H?"extend":"repeat")?H:$-m+1))throw"lenH NaN. assert failed.";f<_+m&&(_=f-m)}else _=f,m=0}for(var F=0,O=0,V=0,L=_,O=0;O<L;O++){H<=F&&(F=0);var N=d[O+m],B=A[F],z=N.dataIndx;!1===N.paste?(V++,"extend"==C&&L+m<f&&L++):(F++,P[z]=B,E&&(E[z]=c(S,N)))}0==e.isEmptyObject(P)&&(null==S?(h=!0,R.push({newRow:P,rowIndx:k})):D.push({newRow:P,rowIndx:k,rowData:S,oldRow:E}),M++)}}r={addList:R,updateList:D,source:"paste",allowInvalid:o.allowInvalid,validate:o.validate},i._digestData(r),i[h?"refreshView":"refresh"]({header:!1}),o.select&&i.Range({r1:x,c1:m,r2:x+M-1+q,c2:"extend"==C?m+_-1+V:$}).select(),i._trigger("paste",null,n)}}},e(document).unbind(".pqExcel").bind("keydown.pqExcel",function(o){if(pq.isCtrl(o)){var a=e(o.target);if(a.hasClass("pq-box-focus")||a.is("#"+r)||a.hasClass("pq-body-outer")){var d=a.closest(".pq-grid");if(n||a.length&&d.length){if(!n){try{if((u=d.pqGrid("instance")).options.selectionModel.native)return!0}catch(c){return!0}(n=new l(u,a)).createClipBoard()}"67"==o.keyCode||"99"==o.keyCode?n.copy({clip:e("#"+r)}):"88"==o.keyCode?n.copy({cut:!0,clip:e("#"+r)}):"86"==o.keyCode||"118"==o.keyCode?(i=!0,n.clearClipBoard(),window.setTimeout(function(){n&&(n.paste({clip:e("#"+r)}),n.destroyClipBoard(),n=null),i=!1},3)):(d=e("#"+r)).length&&document.activeElement==d[0]&&n.that.onKeyDown(o)}}}else{var u=o.keyCode,d=e.ui.keyCode;if(u==d.UP||u==d.DOWN||u==d.LEFT||u==d.RIGHT||u==d.PAGE_UP||u==d.PAGE_DOWN){if(s)return!1;((a=e(o.target)).hasClass("pq-grid-row")||a.hasClass("pq-grid-cell"))&&(s=!0)}}}).bind("keyup.pqExcel",function(r){var o=r.keyCode;i||!n||pq.isCtrl(r)||-1==e.inArray(o,[17,91,93,224])||(n.destroyClipBoard(),n=null),!s||(o=e(r.target)).hasClass("pq-grid-row")||o.hasClass("pq-grid-cell")||(s=!1)}),!1)}(jQuery),function(e){var n=e.paramquery,i=n.pqGrid.prototype.options;i.historyModel=i.historyModel||{on:!0,checkEditable:!0,checkEditableAdd:!1,allowInvalid:!0},(n.cHistory=function(e){var n=this;n.that=e,n.options=e.options,n.records=[],n.counter=0,n.id=0,e.on("keyDown",n.onKeyDown.bind(n)).on("dataAvailable",function(e,i){"filter"!=i.source&&n.reset()})}).prototype={onKeyDown:function(e,n){var i="90",r="89",o=pq.isCtrl(e);return o&&e.keyCode==i?(this.undo(),!1):o&&e.keyCode==r?(this.redo(),!1):void 0},resetUndo:function(){if(0==this.counter)return!1;this.counter=0,this.that._trigger("history",null,{type:"resetUndo",num_undo:0,num_redo:this.records.length-this.counter,canUndo:!1,canRedo:!0})},reset:function(){if(0==this.counter&&0==this.records.length)return!1;this.records=[],this.counter=0,this.id=0,this.that._trigger("history",null,{num_undo:0,num_redo:0,type:"reset",canUndo:!1,canRedo:!1})},increment:function(){var e=this.records,n=e.length;n?(e=e[n-1].id,this.id=e+1):this.id=0},push:function(n){var i,r,o=this.canRedo(),a=this.records,l=this.counter,l=(a.length>l&&a.splice(l,a.length-l),a[l]=e.extend({id:this.id},n),this.counter++,this.that);1==this.counter&&(i=!0),o&&this.counter==a.length&&(r=!1),l._trigger("history",null,{type:"add",canUndo:i,canRedo:r,num_undo:this.counter,num_redo:0})},canUndo:function(){return 0<this.counter},canRedo:function(){return this.counter<this.records.length},undo:function(){var e=this.canRedo(),n=this.that,i=this.options.historyModel,r=this.records;if(!(0<this.counter))return!1;this.counter--;var o,a,l,r=r[this.counter],s=r.callback;return r.id,s?s():(s=r.updateList.map(function(e){return{rowIndx:n.getRowIndx({rowData:e.rowData}).rowIndx,rowData:e.rowData,oldRow:e.newRow,newRow:e.oldRow}}),l=r.addList.map(function(e){return{rowData:e.newRow}}),r=r.deleteList.map(function(e){return{newRow:e.rowData,rowIndx:e.rowIndx}}),n._digestData({history:!1,source:"undo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,addList:r,updateList:s,deleteList:l}),n[r.length||l.length?"refreshView":"refresh"]({source:"undo",header:!1})),0==this.counter&&(a=!1),n._trigger("history",null,{canUndo:a,canRedo:o=!1===e||o,type:"undo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0},redo:function(){var e=this.canUndo(),n=this.that,i=this.options.historyModel,r=this.counter,o=this.records;if(r==o.length)return!1;var a,l,s,r=o[r],d=r.callback;return r.id,d?d(!0):(d=r.updateList.map(function(e){return{rowIndx:n.getRowIndx({rowData:e.rowData}).rowIndx,rowData:e.rowData,newRow:e.newRow,oldRow:e.oldRow}}),a=r.deleteList.map(function(e){return{rowData:e.rowData}}),r=r.addList.map(function(e){return{newRow:e.newRow,rowIndx:e.rowIndx}}),n._digestData({history:!1,source:"redo",checkEditable:i.checkEditable,checkEditableAdd:i.checkEditableAdd,allowInvalid:i.allowInvalid,addList:r,updateList:d,deleteList:a}),n[r.length||a.length?"refreshView":"refresh"]({source:"redo",header:!1})),this.counter<o.length&&this.counter++,this.counter==this.records.length&&(s=!1),n._trigger("history",null,{canUndo:l=0==e||l,canRedo:s,type:"redo",num_undo:this.counter,num_redo:this.records.length-this.counter}),!0}},(i=n.pqGrid.prototype).history=function(e){var n=e.method;return this.iHistory[n](e)},i.History=function(){return this.iHistory}}(jQuery),function(e){function n(e){(this.that=e).on("load",this.onLoad.bind(this)).on("filter clearFilter",this.onFilterChange.bind(this))}var i=e.paramquery,r=(pq.filter={dpBeforeShow:function(n,i,r){return function(){var o,a,l=n.getDataCascade(i);l.length&&(o=(""==l[0][i]?l[1]:l[0])[i],a=l[l.length-1][i]),e(this).datepicker("option","defaultDate",new Date(1==r?a:o))}},datepicker:function(n){var i=n.column,r=i.dataIndx,o=this,a=n.filterUI,n=n.$editor,l=i.dataType,s={dateFormat:a.format||i.format,changeYear:!0,changeMonth:!0};if("date"==l)return n.each(function(n,i){var l=e.extend({},s,1==n&&a.dpOptions2||a.dpOptions);l.defaultDate||(l.beforeShow=l.beforeShow||pq.filter.dpBeforeShow(o,r,n)),e(i).datepicker(l)}),!0},filterFnEq:function(n,i){var r=(n.column||{}).dataType;return"date"==r?this.filterFnTD(n,i):"bool"==r?{type:"checkbox"}:e.extend({maxCheck:1},this.filterFnSelect(n,i))},filterFnSelect:function(e,n){var i=e.column.dataIndx,e=e.indx;return{type:"select",style:"padding-"+(n&&n.options.rtl?"left":"right")+":16px;cursor:default;",attr:"readonly",valueIndx:i,labelIndx:i,options:this.options,init:0==e?this.rangeInit.bind(n):function(){}}},filterFnT:function(){return{type:"textbox",attr:"autocomplete='off'"}},filterFnTD:function(){return{type:"textbox",attr:"autocomplete='off'",init:pq.filter.datepicker}},getVal:function(e){return[(e=(e.crules||[])[0]||{}).value,e.value2,e.condition]},setVal:function(e,n){return(e=e.crules=e.crules||[])[0]=e[0]||{},e[0].value=n}},e.extend(pq.filter,{conditions:{begin:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},between:{stringList:1,date:1,number:1,filter:{attr:"autocomplete='off'",type:"textbox2",init:pq.filter.datepicker}},contain:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},equal:{string:1,bool:1,date:1,number:1,filterFn:pq.filter.filterFnEq},empty:{string:1,bool:1,date:1,number:1,nr:1},end:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},great:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},gte:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},less:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},lte:{stringList:1,number:1,date:1,filterFn:pq.filter.filterFnTD},notbegin:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},notcontain:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},notequal:{string:1,date:1,number:1,bool:1,filterFn:pq.filter.filterFnEq},notempty:{string:1,bool:1,date:1,number:1,nr:1},notend:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT},range:{cascade:1,string:1,number:1,date:1,bool:1,filterFn:pq.filter.filterFnSelect},regexp:{string:1,numberList:1,dateList:1,filterFn:pq.filter.filterFnT}},getConditionsCol:function(e,n){var i,r=n.conditionList||(i=this,(i=i.getConditionsDT(pq.getDataType(e))).sort(),i),n=n.conditionExclude,o={};return n&&(n.forEach(function(e){o[e]=1}),r=r.filter(function(e){return!o[e]})),r},getConditionsDT:function(e){var n,i,r,o=[],a=this.conditions;for(n in a)r=(i=a[n])[e+"List"],(i[e]&&0!==r||r)&&o.push(n);return o},getFilterUI:function(n,i){var r=n.column,o=r.filterFn,r=(0===n.indx?r.filter:{})||{},a=this.conditions[n.condition]||{},l=a.filterFn,a=a.filter||{},s=(delete r.type,o=o&&o.call(i,n)||{},l=l&&l.call(this,n,i)||{},e.extend({},a,l,r,o));return s.condition=n.condition,s.init=[],s.options=[],[o,r,l,a].forEach(function(e){e.init&&s.init.push(e.init),e.options&&s.options.push(e.options)}),s},options:function(e){var n=e.column,e=e.filterUI,i=e.groupIndx,n=n.dataIndx;return this.getDataCascade(n,i,e.diExtra)},getOptions:function(e,n,i){for(var r,o=n.options,a=e.dataIndx,l={column:e,dataIndx:a,filterUI:n,condition:n.condition},s=0,d=o.length;s<d;s++)if((r=o[s])&&(r="function"==typeof r?r.call(i,l):r))return r=i.getPlainOptions(r,a),i.removeNullOptions(r,n.dataIndx||a,n.groupIndx);return[]},rangeInit:function(n){var i=this,r=n.column,o=n.$editor,a=n.headMenu,l=n.filterUI;a||o.parent().off("click keydown").on("click keydown",function(a){var s,d;"keydown"==a.type&&a.keyCode!=e.ui.keyCode.DOWN||e("#"+(a=i.uuid+"_"+r.dataIndx)).length||(s=new pq.cFilterMenu.select(i,r),d=(a=e("<div id='"+a+"' style='width:270px;' class='pq-theme'><div></div></div>").appendTo(i.$header)).children(),pq.makePopup(a[0],o),a.position({my:"left top",at:"left bottom",of:n.$editor}),s.create(d,l))})},getType:function(e,n){var i=this.conditions[e]||{},r=i.filterFn;return(i.filter||{}).type||(r?r.call(this,{condition:e,column:n}):{}).type}}),(i.cFilterData=n).conditions={equal:function(e,n){return e==n},notequal:function(){return!r.equal.apply(this,arguments)},contain:function(e,n){return -1!=(e+"").indexOf(n)},notcontain:function(){return!r.contain.apply(this,arguments)},empty:function(e){return 0==e.length},notempty:function(){return!r.empty.apply(this,arguments)},begin:function(e,n){return 0==(e+"").indexOf(n)},notbegin:function(){return!r.begin.apply(this,arguments)},end:function(e,n){var i=(e+="").lastIndexOf(n+="");if(-1!=i&&i+n.length==e.length)return!0},notend:function(){return!r.end.apply(this,arguments)},regexp:function(e,n){if(n.test(e))return n.lastIndex=0,!0},great:function(e,n){return n<e},gte:function(e,n){return n<=e},between:function(e,n,i){return n<=e&&e<=i},range:function(n,i){return -1!=e.inArray(n,i)},less:function(e,n){return e<n},lte:function(e,n){return e<=n}});n.convert=function(e,n){return null==e||""===e?"":("string"==n?e=(e+"").trim().toUpperCase():"date"==n?e=Date.parse(e):"number"==n?+e==e&&(e=+e):"bool"==n&&(e=String(e).toLowerCase()),e)},n.convertEx=function(e,n,i,r){var n=pq.getDataType({dataType:n}),o=pq.filter.conditions[i];return o[n]?this.convert(e,n):o.string?(r&&(e=pq.format(r,e)),"regexp"==i?e:this.convert(e,"string")):o.number?this.convert(e,"number"):void 0},n.prototype={addMissingConditions:function(e){var n=this.that;e.forEach(function(e){var i=n.getColumn({dataIndx:e.dataIndx}).filter||{};e.condition=void 0===e.condition?pq.filter.getVal(i)[2]:e.condition})},clearFilters:function(e){e.forEach(function(e){var e=e.filter,n=pq.filter.conditions;e&&(e.crules||[]).forEach(function(e){(n[e.condition]||{}).nr&&(e.condition=void 0),e.value=e.value2=void 0})})},compatibilityCheck:function(e){var n=e.data,i="Incorrect filter parameters. Please check upgrade guide";if(n){if(n=n[0]){if(n.hasOwnProperty("dataIndx")&&n.hasOwnProperty("value"))throw i}else if(!e.rules)throw i}},copyRuleToColumn:function(e,n,i){var n=n.filter=n.filter||{},r=e.crules||[],o=r[0],a=(o||e).condition,l=(o||e).value,s=(o||e).value2;"remove"==i?(n.on=!1,n.crules=a?[{condition:a,value:"range"==a?[]:void 0}]:void 0):(n.on=!0,n.mode=e.mode,n.crules=o?r:[{condition:a,value:l,value2:s}])},filter:function(e){this.compatibilityCheck(e=e||{});var n,i,r=this.that,o=r.options,a=!1,l=e.data,s=e.rules=e.rules||(e.rule?[e.rule]:[]),d=!l,c=o.dataModel,o=o.filterModel,u=e.mode||o.mode,h=e.oper,f="replace"==h,p=d?r.colModel:this.getCMFromRules(s),g=0,m=s.length;if("remove"!=h&&this.addMissingConditions(s),d){if(!1===r._trigger("beforeFilter",null,e))return;for(null!=e.header&&(a=e.header),f&&this.clearFilters(p);g<m;g++)n=s[g],i=r.getColumn({dataIndx:n.dataIndx}),this.copyRuleToColumn(n,i,h)}else for(;g<m;g++)n=s[g],i=p[g],this.copyRuleToColumn(n,i);var v={header:a,CM:p,data:l,rules:s,mode:u};if("remote"!=c.location||"local"==o.type)return v.source="filter",v.trigger=!1,r._onDataAvailable(v);r.remoteRequest({apply:d,CM:p,callback:function(){return r._onDataAvailable(v)}})},hideRows:function(e,n,i){for(var r,o=0,a=n.length;o<a;o++)(r=n[o]).pq_hidden=r.pq_filter=!this.isMatchRow(r,e,i)},filterLocalData:function(e){var n=this.that,i=(e=e||{}).data,r=!i,o=r?n.colModel:e.CM,a=this.getRulesFromCM({CM:o,apply:r}),o=n.options,l=o.dataModel,s=n.iSort,d=i||l.data,c=l.dataUF=l.dataUF||[],u=[],h=[],i=o.filterModel,o={filters:a,mode:void 0,data:d},f=e.mode||i.mode;if(i.hideRows)o.hideRows=!0,!1!==n._trigger("customFilter",null,o)&&this.hideRows(a,d,f);else{if(r){if(c.length){for(var p=!0,g=0,m=c.length;g<m;g++)d.push(c[g]);c=l.dataUF=[]}else{if(!a.length)return{data:d,dataUF:c};s.saveOrder()}}if(i.on&&f&&a&&a.length){if(d.length){if(!1===n._trigger("customFilter",null,o))u=o.dataTmp,h=o.dataUF;else for(g=0,m=d.length;g<m;g++){var v=d[g];(this.isMatchRow(v,a,f)?u:h).push(v)}}d=u,c=h,0==s.readSorter().length&&(d=s.sortLocalData(d)),r&&(l.data=d,l.dataUF=c)}else p&&r&&(o={data:d=0==s.readSorter().length?s.sortLocalData(d):d},!1===n._trigger("clearFilter",null,o)&&(d=o.data),l.data=d,n._queueATriggers.filter={ui:{type:"local"}})}return r&&(n._queueATriggers.filter={ui:{type:"local",rules:a}}),{data:d,dataUF:c}},_getRulesFromCM:function(i,r,o,a,l,s,d){if("between"==o)""===a||null==a?a=d(l,s,o="lte"):""===l||null==l?a=d(a,s,o="gte"):(a=d(a,s,o),l=d(l,s,o));else if("regexp"==o){if("remote"==i)a=a.toString();else if("string"==typeof a)try{var c=r.modifiers||"gi";a=RegExp(a,c)}catch(u){a=/.*/}}else if("range"==o||e.isArray(a)){if(null==a)return;if("function"==typeof a.push){if(0===a.length)return;if("range"!=o)a=d(a[0],s,o);else for(var h=0,f=(a=a.slice()).length;h<f;h++)a[h]=d(a[h],s,o)}}else o&&(a=d(a,s,o),null!=l&&(l=d(l,s,o)));return[a,l,c="remote"==i?"":((r.conditions||{})[o]||{}).compare||pq.filter.conditions[o].compare||n.conditions[o],o]},getRulesFromCM:function(e){var n=e.CM;if(!n)throw"CM N/A";function r(e,n,i){return d?(e=null==e?"":e).toString():u.convertEx(e,n,i)}for(var o=this,a=n.length,l=0,s=e.location,d="remote"===s,c=[],u=i.cFilterData;l<a;l++){var h,f,p,g,m,v,$,x,w=n[l],y=w.filter;y&&(h=w.dataIndx,x=w.dataType,p=y.crules||[y],f=[],x=x&&"stringi"!=x&&"function"!=typeof x?x:"string",p.forEach(function(e){$=e.condition,g=e.value,m=e.value2,$&&o.isCorrect($,g,m)&&($=o._getRulesFromCM(s,y,$,g,m,x,r))&&(g=$[0],m=$[1],v=$[2],f.push({condition:$[3],value:g,value2:m,cbFn:v}))}),f.length&&(p={dataIndx:h,dataType:x},d&&1==f.length?(p.value=f[0].value,p.value2=f[0].value2,p.condition=f[0].condition):(p.crules=f,p.mode=y.mode,d||(p.column=w)),c.push(p)))}return(e.apply||d)&&this.sortRulesAndFMIndx(c),c},getCMFromRules:function(e){var n=this.that;return e.map(function(e){return e=n.getColumn({dataIndx:e.dataIndx}),pq.copyObj({},e,["parent"])})},getQueryStringFilter:function(){var e=this.that,n=e.options,i=n.stringify,n=n.filterModel,r=n.mode,o=e.colModel,a=n.newDI||[],o=this.getRulesFromCM({CM:o,location:"remote"}),l="";return n&&n.on&&o&&(o.length?(n={mode:r,data:o},l=i?JSON.stringify(n):n):(l="",a.length&&e._trigger("clearFilter"))),l},isCorrect:function(e,n,i){if(e=pq.filter.conditions[e])return!!(null!=n&&""!==n||null!=i&&""!==i||e.nr);throw"filter condition NA"},isMatchCell:function(e,i){for(var r,o,a,l,s=e.dataIndx,d=this.that,c=e.column,u=e.dataType,h=e.mode,f=[],p=e.crules,g=p.length,m=i[s],v=0;v<g;v++)l=(a=p[v]).condition,r=a.value,o=a.value2,a=a.cbFn,l&&(l="regexp"===l?null==m?"":m:n.convertEx(m,u,l,c),f.push(!!a.call(d,l,r,o,i,c)));if(g=f.length,"AND"===h){for(v=0;v<g;v++)if(!f[v])return!1;return!0}for(v=0;v<g;v++)if(f[v])return!0;return!1},isMatchRow:function(e,n,i){var r,o,a=0,l=n.length,s="AND"==i,d=!s;if(0==l)return!0;for(;a<l;a++){if(r=n[a],(o=this.isMatchCell(r,e))&&(r.found=!0),d&&o)return!0;if(s&&!o)return!1}return s},onFilterChange:function(){var e=this.that,n=e.options,i=e.columns,r=n.filterModel,o="remote"==r.type,a=r.oldDI||[],n=!n.dataModel.data.length,l="pq-col-filtered",s=o||n,o=(r.rules||[]).reduce(function(e,n){return(n.found||s)&&e.push(n.dataIndx),e},[]);a.forEach(function(n){var r=e.getCellHeader({dataIndx:n}),o=i[n];r.length&&(r.removeClass(l),e.getCellFilter({dataIndx:n}).removeClass(l)),o.clsHead=(o.clsHead||"").split(" ").filter(function(e){return e!==l}).join(" ")}),o.forEach(function(n){var r=e.getCellHeader({dataIndx:n}),o=i[n];r.length&&(r.addClass(l),e.getCellFilter({dataIndx:n}).addClass(l)),o.clsHead=(o.clsHead||"")+" "+l}),r.oldDI=r.newDI=o},onLoad:function(){var e=this.that.options.dataModel.dataUF;e&&(e.length=0)},sortRulesAndFMIndx:function(e){var n=this.that.options.filterModel,i=n.newDI;e.sort(function(e,n){return e=e.dataIndx,n=n.dataIndx,e=i.indexOf(e),n=i.indexOf(n),0<=e&&0<=n?e-n:0<=e?-1:0<=n?1:0}),n.rules=e}}}(jQuery),function(e){var n=e.paramquery,i=n.cSort=function(e){this.that=e,this.sorters=[],this.tmpPrefix="pq_tmp_",this.cancel=!1},r=(n.pqGrid.prototype.sort=function(e){if((e=e||{}).data)return this.iSort._sortLocalData(e.sorter,e.data);var n,i,r,o,a,l=this,s=this.options,d=s.dataModel,c=d.data,u=s.sortModel.type;(c&&c.length||"local"!=u)&&(s=s.editModel,i=(n=this.iSort).getSorter(),r=e.evt,o=null==e.single?n.readSingle():e.single,a=n.readCancel(),((a=e.sorter?e.addon?(e.single=o,e.cancel=a,n.addon(e)):e.sorter:n.readSorter()).length||i.length)&&(s.indices&&l.blurEditor({force:!0}),(s={dataIndx:a.length?a[0].dataIndx:null,oldSorter:i,sorter:a,source:e.source,single:o},!1===l._trigger("beforeSort",r,s))?n.cancelSort():(n.resumeSort(),"local"==u&&n.saveOrder(),n.setSorter(a),n.setSingle(o),n.writeSorter(a),n.writeSingle(o),"local"==u?(d.data=n.sortLocalData(c,!e.skipCustomSort),this._queueATriggers.sort={evt:r,ui:s},!1!==e.refresh&&this.refreshView()):"remote"==u&&(this._queueATriggers.sort={evt:r,ui:s},e.initByRemote||this.remoteRequest({initBySort:!0,callback:function(){l._onDataAvailable()}})))))},i.prototype={addon:function(n){var i,r,o=(n=n||{}).sorter[0],a=o.dataIndx,l=o.dir,s=n.single,d=n.cancel,c=this.readSorter(),u=c[0];if(null==s)throw"sort single N/A";return null!=a&&(s&&!n.tempMultiple?(u=(c=c.length?[c[0]]:[])[0])&&u.dataIndx==o.dataIndx?""==(r="up"===(i=u.dir)?"down":d&&"down"===i?"":"up")?c.length--:u.dir=r:c[0]=e.extend({},o,{dir:r=l||"up"}):-1<(s=this.inSorters(c,a))?"up"==(i=c[s].dir)?c[s].dir="down":d&&"down"==i||1!=c.length?c.splice(s,1):c[s].dir="up":c.push(e.extend({},o,{dir:"up"}))),c},cancelSort:function(){this.cancel=!0},resumeSort:function(){this.cancel=!1},readSorter:function(){var e=this.that,n=e.columns,e=(e.options.sortModel.sorter||[]).filter(function(e){return!!n[e.dataIndx]});return pq.arrayUnique(e,"dataIndx")},setSingle:function(e){this.single=e},getSingle:function(){return this.single},readSingle:function(){return this.that.options.sortModel.single},setCancel:function(e){this.cancel=e},readCancel:function(){return this.that.options.sortModel.cancel},saveOrder:function(e){var n,i=this.that,r=i.options.dataModel,o=i.pdata||[];if(!(r.dataUF||[]).length&&(!this.getSorter().length||o[0]&&null==o[0].pq_order))for(var a=0,l=(e=i.get_p_data()).length;a<l;a++)(n=e[a])&&(n.pq_order=a)},getCancel:function(){return this.cancel},getQueryStringSort:function(){if(this.cancel)return"";var e=this.that,n=this.sorters,e=e.options.stringify;return n.length?e?JSON.stringify(n):n:""},getSorter:function(){return this.sorters},setSorter:function(e){this.sorters=e.slice(0)},inSorters:function(e,n){for(var i=0;i<e.length;i++)if(e[i].dataIndx==n)return i;return -1},sortLocalData:function(e,n){var i=this.sorters;return i.length||e.length&&null!=e[0].pq_order&&(i=[{dataIndx:"pq_order",dir:"up",dataType:"integer"}]),this._sortLocalData(i,e,n)},compileSorter:function(e,n){var i=this.that,o=i.columns,i=i.options,a=[],l=[],s=[],d=this.tmpPrefix,c=i.sortModel,u=c.useCache,h=c.ignoreCase,f=e.length;n=n||i.dataModel.data;for(var p=0;p<f;p++){var g=e[p],m=g.sortIndx||g.dataIndx,v=o[m]||{},$="up"==(g.dir=g.dir||"up")?1:-1,x=pq.getFn(v.sortType),v="string"==(v=v.dataType||g.dataType||"string")&&h?"stringi":v,g=u&&"date"==v,w=g?d+m:m;l[p]=w,s[p]=$,a[p]=x?function(e,n){return function(i,r,o,a){return n(i,r,o,a,e)}}(x,r.sort_sortType):"integer"==v||"float"==v?r.sort_number:"function"==typeof v?function(e,n){return function(i,r,o,a){return n(i,r,o,a,e)}}(v,r.sort_dataType):"date"==v?r["sort_date"+(g?"_fast":"")]:"bool"==v?r.sort_bool:"stringi"==v?r.sort_locale:r.sort_string,g&&this.addCache(n,v,m,w)}return this._composite(a,l,s,f)},_composite:function(e,n,i,r){return function(o,a){for(var l=0,s=0;s<r&&0==(l=e[s](o,a,n[s],i[s]));s++);return l}},_sortLocalData:function(e,n,i){if(!n)return[];if(!n.length||!e||!e.length)return n;var r=this.that,o=r.options.sortModel,a=this.compileSorter(e,n),l={sort_composite:a,data:n,sorter:e};return i&&!1===r._trigger("customSort",null,l)?n=l.data:n.sort(a),o.useCache&&this.removeCache(e,n)(),n},addCache:function(e,n,i,o){for(var a=r["get_"+n],l=e.length;l--;){var s=e[l];s[o]=a(s[i])}},removeCache:function(e,n){var i=this.tmpPrefix;return function(){for(var r=e.length;r--;){var o=i+e[r].dataIndx,a=n.length;if(a&&n[0].hasOwnProperty(o))for(;a--;)delete n[a][o]}}},writeCancel:function(e){this.that.options.sortModel.cancel=e},writeSingle:function(e){this.that.options.sortModel.single=e},writeSorter:function(e){this.that.options.sortModel.sorter=e}},{get_date:function(e){return!e||isNaN(e=Date.parse(e))?0:e},sort_number:function(e,n,i,r){return((e=(e=e[i])?+e:0)-(n=(n=n[i])?+n:0))*r},sort_date:function(e,n,i,r){return e=e[i],n=n[i],((e=e?Date.parse(e):0)-(n=n?Date.parse(n):0))*r},sort_date_fast:function(e,n,i,r){return(e[i]-n[i])*r},sort_dataType:function(e,n,i,r,o){return o(e[i],n[i])*r},sort_sortType:function(e,n,i,r,o){return o(e,n,i)*r},sort_string:function(e,n,i,r){return e=e[i]||"",n=n[i]||"",i=0,n<e?i=1:e<n&&(i=-1),i*r},sort_locale:function(e,n,i,r){return e=e[i]||"",n=n[i]||"",e.localeCompare(n)*r},sort_bool:function(e,n,i,r){return e=e[i],n=n[i],i=0,e&&!n||!1===e&&null==n?i=1:(n&&!e||!1===n&&null==e)&&(i=-1),i*r}});pq.sortObj=r}(jQuery),function(e){function n(e,n,i){var r=0,o=n,n=e.length;for(i=n<i?n:i;o<i;o++)!0!==e[o].pq_hidden&&r++;return r}function i(e){var n=this;n.that=e,n.mc=null,e.on("dataReadyDone colMove groupShowHide",function(i,r){e.options.mergeCells&&"pager"!==r.source&&n.init()}),e.on("colAdd colRemove",n.alterColumn.bind(n)).on("change",n.onChange.bind(n)),e.Merge=function(){return n}}e.paramquery.pqGrid.prototype.calcVisibleRows=n,(e.paramquery.cMerge=i).prototype={auto:function(e,n){var i=this.that,r=i.pdata;return n=n||[],e.forEach(function(e){for(var o=1,a=i.colIndxs[e],l=r.length;l--;){var s=r[l][e],d=r[l-1]?r[l-1][e]:void 0;void 0!==d&&s==d?o++:1<o&&(n.push({r1:l,c1:a,rc:o,cc:1}),o=1)}}),n},calcVisibleColumns:function(e,n,i){var r=0,o=e.length;for(i=o<i?o:i;n<i;n++)!0!==e[n].hidden&&r++;return r},findNextVisibleColumn:function(e,n,i){for(var r,o=n;o<n+i;o++){if(!(r=e[o]))return -1;if(!r.hidden)return o}},findNextVisibleRow:function(e,n,i){for(var r,o=n;o<n+i;o++){if(!(r=e[o]))return -1;if(!r.pq_hidden)return o}},getData:function(e,n,i){var r=this.mc;if(r[e]&&(r=r[e][n]))return(e=r.data)?e[i]:null},inflateRange:function(e,n,i,r){var o=this.that,a=!1,l=o.riOffset+o.pdata.length-1,s=o.colModel.length-1,d=this.mc2;if(!d)return[e,n,i,r];for(var c=0,u=d.length;c<u;c++){var h=d[c],f=h.r1,p=h.c1,g=l<(g=f+h.rc-1)?l:g,h=s<(h=p+h.cc-1)?s:h;if((f<e&&e<=g||f<=i&&i<g)&&n<=h&&p<=r||(p<n&&n<=h||p<=r&&r<h)&&e<=g&&f<=i){a=!0,e=f<e?f:e,n=p<n?p:n,i=i<g?g:i,r=r<h?h:r;break}}return a?this.inflateRange(e,n,i,r):[e,n,i,r]},init:function(){for(var e=this.that,i=this.findNextVisibleColumn,r=this.findNextVisibleRow,o=this.calcVisibleColumns,a=e.colModel,l=e.options.mergeCells||[],s=e.get_p_data(),d=[],c=[],u=0,h=l.length;u<h;u++){var f=l[u],p=f.r1,g=p,m=s[p],v=f.c1,$=v,x=a[v],w=f.rc,y=f.cc;if(x&&m&&(x.hidden&&($=i(a,v,y)),x=o(a,v,v+y),m.pq_hidden&&(g=r(s,p,w)),!((m=n(s,p,p+w))<1||x<1))){d.push({r1:p,c1:v,rc:w,cc:y}),c[g]=c[g]||[];for(var C={show:(c[g][$]={show:!0,rowspan:m,colspan:x,o_rowspan:w,o_colspan:y,style:f.style,cls:f.cls,attr:f.attr,r1:p,c1:v,v_r1:g,v_c1:$},!1),r1:p,c1:v,v_r1:g,v_c1:$},_=p;_<p+w;_++){c[_]=c[_]||[];for(var b=v;b<v+y;b++)_==g&&b==$||(c[_][b]=C)}}}e._mergeCells=0<c.length,this.mc=c,this.mc2=d},ismergedCell:function(e,n){var i,r,o=this.mc;return!!(o&&o[e]&&(i=o[e][n]))&&(o=i.v_r1,r=i.v_c1,e!=o||n!=r||{o_ri:i.r1,o_ci:i.c1,v_rc:i.rowspan,v_cc:i.colspan,o_rc:i.o_rowspan,o_cc:i.o_colspan})},isRootCell:function(e,n,i){var r=this.mc;if(r&&r[e]&&(o=r[e][n])){if("o"==i)return e==o.r1&&n==o.c1;var i=o.v_r1,o=o.v_c1;return i==e&&o==n?{rowspan:(e=r[i][o]).rowspan,colspan:e.colspan}:void 0}},removeData:function(e,n,i){this.that;var r=this.mc;r&&r[e]&&(r=r[e][n])&&(e=r.data)&&(e[i]=null)},getRootCell:function(e,n){var i,r=this.mc;if(r&&r[e]&&(e=r[e][n]))return n=e.v_r1,i=e.v_c1,{o_ri:(e=r[n][i]).r1,o_ci:e.c1,v_ri:n,v_ci:i,v_rc:e.rowspan,v_cc:e.colspan,o_rc:e.o_rowspan,o_cc:e.o_colspan}},getRootCellO:function(e,n,i,r){var o,r="o"==(r=r||"o"),a=this.getRootCell(e,n);return a?(o={rowIndx:a[r?"o_ri":"v_ri"],colIndx:a[r?"o_ci":"v_ci"]},this.that.normalize(o)):(o=i?{rowIndx:e,colIndx:n}:o)?this.that.normalize(o):null},getRootCellV:function(e,n,i){return this.getRootCellO(e,n,i,"v")},getClsStyle:function(e,n){return this.mc[e][n]},getMergeCells:function(e,n,i){for(var r,o,a,l=this.that,s=l.options.mergeCells,d=l.riOffset,c=d+i,u=[],h=s?s.length:0,f=0;f<h;f++)o=(r=s[f]).r1,a=r.c1,(!n||d<=o&&o<c)&&(n&&(o-=d),u.push({r1:o+=e,c1:a,r2:o+r.rc-1,c2:a+r.cc-1}));return u},alterColumn:function(e,n){for(var i=this.that.options,n=n.args,r=n[1],o="number"!=typeof(a=n[0]),a=o?a.length:a,l=i.mergeCells||[],s=0,d=l.length;s<d;s++){var c=l[s],u=c.c1,h=c.cc;o?r<=u?c.c1=u+a:r<u+h&&(c.cc=h+a):r<u?c.c1=u-a:r<u+h&&0<h-a&&(c.cc=h-a),c.c2=null}this.init(l)},onChange:function(e,n){for(var i,r=this.that.options,o=n.addList,a=n.deleteList,l=r.mergeCells||[],s=0,d=l.length;s<d;s++){for(var c=l[s],u=c.r1,h=c.rc,f=0,p=o.length;f<p;f++)(i=o[f].rowIndx)<=u?(u=c.r1=u+1,c.r2=null):i<u+h&&(h=c.rc=h+1,c.r2=null);for(f=0,p=a.length;f<p;f++)(i=a[f].rowIndx)<u?(u=c.r1=u-1,c.r2=null):i<u+h&&1<h&&(h=c.rc=h-1,c.r2=null)}this.init(l)},setData:function(e,n,i){var r=this.mc;r[e]&&(r=r[e][n])&&(r.data=i)}}}(jQuery),function(e){var n=e.paramquery,i=pq.mixin,r=(n.pqGrid.defaults.groupModel={agg:{},cascade:!0,cbId:"pq_group_cb",collapsed:[],dataIndx:[],fixCols:!0,groupCols:[],header:!0,headerMenu:!0,icon:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],id:"pq_gid",parentId:"parentId",childstr:"children",menuItems:["merge","fixCols","grandSummary"],on:!1,refreshOnChange:!0,pivotColsTotal:"after",separator:"_",source:"checkboxGroup",showSummary:[],summaryInTitleRow:"collapsed",summaryEdit:!0,title:[],titleDefault:"{0} ({1})"},pq.aggregate={sum:function(e){for(var n,i=0,r=e.length;r--;)null!=(n=e[r])&&(i+=+n);return i},avg:function(e,n){try{var i=pq.formulas.AVERAGE(e)}catch(r){i=r}return isNaN(i)?null:i},flatten:function(e){return e.filter(function(e){return null!=e})},max:function(e,n){var i,r,o,a,l,n=pq.getDataType(n);if(i=(e=this.flatten(e)).length){if("number"==n)for(r=+e[0];i--;)r=r<(o=e[i])||isNaN(r)?o:r;else if("date"==n){for(r=Date.parse(e[0]),a=e[0];i--;)(r<(l=Date.parse(e[i]))||isNaN(r))&&(r=l,a=e[i]);r=a}else e.sort(),r=e[i-1];return r}},min:function(e,n){var i,r,o,a,n=pq.getDataType(n);if(a=(e=this.flatten(e)).length){if("number"==n)for(i=+e[0];a--;)i=(r=+e[a])<i||isNaN(i)?r:i;else if("date"==n){for(i=Date.parse(e[0]),o=e[0];a--;)((r=Date.parse(e[a]))<i||isNaN(i))&&(i=r,o=e[a]);i=o}else e.sort(),i=e[0];return i}},count:function(e){return this.flatten(e).length},stdev:function(e){try{var n=pq.formulas.STDEV(e)}catch(i){n=i}return isNaN(n)?null:n},stdevp:function(e){try{var n=pq.formulas.STDEVP(e)}catch(i){n=i}return isNaN(n)?null:n}},n.cGroup=function(e){var n=this,i=e.options,r=n.Model=i.groupModel;n.cbId=r.cbId,n.childstr=r.childstr,n.id=r.id,n.parentId=r.parentId,n.isGroup=!0,n.cache={},n.oldEditor=i.editor,n.prop="pq_group_prop",n.that=e,Object.defineProperty(r,"nodeClose",{get:function(){return n.fillState({})},set:function(e){n.nodeClose=e}}),r.on&&n.init()});r.beforeTrigger=function(e,n){return function(i){return!1===n._trigger("beforeGroupExpand",e,i)}},r.onGroupItemClick=function(n){return function(i){var r=e(i.target),o=e(this).data("indx");r.hasClass("pq-group-remove")?n.removeGroup(o):n.toggleLevel(o,i)}},r.prototype=e.extend({},i.ChkGrpTree,i.GrpTree,{addGroup:function(e,n){var i=this,r=i.that.options.groupModel.dataIndx||[],o=pq.objectify(r),r=r.slice();null==e||o[e]||(null==n?r.push(e):r.splice(n,0,e),i.option({dataIndx:r},"","",function(){i.triggerChange()}))},createHeader:function(){for(var n=this.that,i=this.$header,o=n.options,a=o.bootstrap,l=n.columns,s=a.on,d=o.groupModel,c=d.dataIndx,u=c.length;u--;)null==l[c[u]]&&c.splice(u,1);if(u=c.length,d.header&&d.on){if(i?i.empty():(i=this.$header=e("<div class='pq-group-header ui-helper-clearfix' ></div>").appendTo(n.$top)).on("click",".pq-group-item",r.onGroupItemClick(this)),u){for(var h=[],f=0;f<u;f++){var p=c[f],g=l[p],m=d.collapsed,v=(s?a.groupModel:d).icon,m=m[f]?v[1]:v[0];h.push("<div tabindex='0' class='pq-group-item' data-indx='",p,"' >","<span class='",this.toggleIcon,m,"' ></span>",g.pq_title||("string"==typeof g.title?g.title:p),"<span class='",this.groupRemoveIcon,"' ></span></div>")}i[0].innerHTML=h.join("")}this.initHeader(o,d)}else i&&(i.remove(),this.$header=null)},collapse:function(e){this.expand(e,!0)},collapseAll:function(e){this.expandAll(e,!0)},collapseTo:function(e){this.expandTo(e,!0)},concat:function(){var e=this.parentId,n=this.id,i=this.childstr;return function(r,o,a){var l=a[n];return o.forEach(function(n){n[e]=l,r.push(n)}),a[i]=o,r}},editorSummary:function(n,i){var r=this,o=r.oldEditor;return function(n){var a=n.rowData;if(a.pq_gsummary||a.pq_gtitle){var l,s,a=pq.aggregate,d=n.column,c=d.summary,c=c?c.edit:null,u=e.inArray,d=d.dataType,h=[""];if(-1<u(n.dataIndx,i.dataIndx)||!i.summaryEdit&&!c||!1===c)return!1;for(s in l=r.getAggOptions(d),a)-1<u(s,l)&&h.push(s);return 1!=h.length&&{type:"select",prepend:i.prepend,options:i.options||h,valueIndx:i.valueIndx,labelIndx:i.labelIndx,init:i.init||r.editorInit,getData:i.getData||r.editorGetData}}return"function"==typeof o?o.call(r.that,n):o}},editorInit:function(e){var n=e.column.summary,i=this.options.groupModel.dataIndx,i=(n=n||(e.column.summary={}))[i[e.rowData.pq_level]]||n.type;e.$cell.find("select").val(i)},editorGetData:function(e){var n=e.column,i=this.options.groupModel.dataIndx[e.rowData.pq_level],r=n.dataType,o=n.summary,e=e.$cell.find("select").val();return o[o[i]?i:"type"]=e,this.one("beforeValidate",function(e,i){i.allowInvalid=!0,i.track=!1,i.history=!1,n.dataType="string",this.one(!0,"change",function(e,i){n.dataType=r})}),e},expandTo:function(e,n){for(var i,r=this.that,o=!!n,a=e.split(","),l=a.length,s=this.childstr,d=this.getRoots(r.pdata),c=0;c<l&&(i=d[a[c]]);)o||(i.pq_close=o),d=i[s],c++;i&&(i.pq_close=o,!1!==r._trigger("group",null,{node:i,close:o})&&this.softRefresh())},expandAll:function(e,n){e=e||0,n=!!n,!1!==this.trigger({all:!0,close:n,level:e})&&(this.that.pdata.forEach(function(i){i.pq_level>=e&&(i.pq_close=n)}),this.createHeader(),this.softRefresh())},expand:function(e,n){e=e||0,!1!==this.trigger({close:!!n,level:e})&&(this.that.pdata.forEach(function(i){i.pq_level==e&&(i.pq_close=n)}),this.createHeader(),this.softRefresh())},flattenG:function(e,n,i,r){var o=i.dataIndx,a=this.id,l=this.parentId,s=this.childstr,d=i.separator,c=i.titleIndx,u=this.concat(),h=o.length,f=[];return function r(p,g,m,v){if(!h)return p;var $=g||0,x=(m=m||{})[s],w=o[$],y=i.collapsed[$];return n(p,w,e[w]).forEach(function(e){var n=e[1],e=e[0],i=(v?v+d:"")+e,o=n.length,o={pq_gtitle:!0,pq_level:$,pq_close:y,pq_items:o};o[a]=i,o[l]=m[a],o[s]=[],o[w]=e,c&&(o[c]=e),f.push(o),x&&x.push(o),$+1<h?r(n,$+1,o,i):f=u(f,n,o)}),f}},getAggOptions:function(e){return"integer"==e||"float"==e?e="number":"date"!==e&&(e="string"),this.that.options.summaryOptions[e].split(",")},getVal:function(n){var i=e.trim;return function(e,r,o){return e=e[r],(r=o.groupChange)?(r=pq.getFn(r))(e):(e=i(e),n?e.toUpperCase():e)}},getSumCols:function(){return this._sumCols},getSumDIs:function(){return this._sumDIs},group:function(e){return function(n,i,r){var o={},a=[];return n.forEach(function(n){n.pq_hidden=void 0;var l=e(n,i,r),s=o[l];null==s&&(o[l]=s=a.length,a[s]=[l,[]]),a[s][1].push(n)}),a}},groupData:function(e){var n=this.that,i=n.options.groupModel,r=this.getVal(i.ignoreCase),o=i.dataIndx,a=n.pdata,l=n.columns;this.setSumCols(o),n.pdata=this.flattenG(l,this.group(r),i,function(){})(a),n._trigger("before"+(e?"Pivot":"Group")+"Summary"),this.summaryT()},hideRows:function(e,n,i,r){for(var o,a=this.that.pdata,l=e,s=a.length;l<s;l++)if((o=a[l]).pq_gsummary)i||r?o.pq_level>=n&&(o.pq_hidden=!0):o.pq_level>n&&(o.pq_hidden=!0);else if(o.pq_gtitle){if(o.pq_level<=n)break;o.pq_hidden=!0}else o.pq_hidden=!0},init:function(){var e,n,i,r,o=this;o.onCMInit(),o._init||(o.mc=[],o.summaryData=[],e=(n=(r=o.that).options).groupModel,n=n.bootstrap.on,o.groupRemoveIcon="pq-group-remove "+(i=n?"glyphicon ":"ui-icon ")+(n?"glyphicon-remove":"ui-icon-close"),o.toggleIcon="pq-group-toggle "+i,r.on("cellClick",o.onCellClick(o)).on("cellKeyDown",o.onCellKeyDown2(o,e)).on(!0,"cellMouseDown",o.onCellMouseDown()).on("change",o.onChange(o,e)).on("dataReady",o.onDataReady(o,r)).on("beforeFilterDone",function(){o.saveState()}).on("columnDragDone",o.onColumnDrag(o)).on("colMove",o.onColMove.bind(o)).on("customSort",o.onCustomSort.bind(o)).on("valChange",o.onCheckbox(o,e)).on("refresh refreshRow",o.onRefresh(o,e)).on("refreshHeader",o.onRefreshHeader.bind(o)),(e.titleIndx||e.titleInFirstCol)&&r.on("CMInit",o.onCMInit.bind(o)),r.on("beforeCheck",o.onBeforeCheck.bind(o)),o.setCascadeInit(!0),o._init=!0)},initHeadSortable:function(){var e=this.that,n=this.$header,e=e.options;n.sortable({axis:"x",distance:3,tolerance:"pointer",cancel:".pq-group-menu",stop:this.onSortable(this,e)})},initHeadDroppable:function(){var e=this,n=e.that,i=e.$header;i&&(i.droppable({accept:function(i){if(!isNaN(i=+i.attr("pq-col-indx"))&&n.colModel[i])return e.acceptDrop},tolerance:"pointer",hoverClass:"pq-drop-hover",drop:e.onDrop(n,e)}),e.acceptDrop=!0)},initHeader:function(e,n){var i,r;this.$header&&(r=(i=this.$header).find(".pq-group-item"),i.data("uiSortable")||this.initHeadSortable(),r.length||i.append("<span class='pq-group-placeholder'>"+e.strGroup_header+"</span>"),n.headerMenu&&this.initHeaderMenu())},initHeaderMenu:function(){for(var n,i=this,r=i.that,o=r.BS_on,a=r.options,r=i.$header,l=["<ul class='pq-group-menu'><li>",o?"<span class='glyphicon glyphicon-chevron-left'></span>":"<div><span>&nbsp;</span></div>","<ul>"],s=a.groupModel,d=s.menuItems,c=0,u=d.length;c<u;c++)l.push("<li data-option='",n=d[c],"' class='pq-menu-item'>","<label>","<input type='checkbox' ",s[n]?"checked":"","/>",a["strGroup_"+n],"</label></li>");l.push("</ul></li></ul>"),(o=e(l.join("")).appendTo(r)).menu({icons:{submenu:"ui-icon-carat-1-w"},position:{my:"right top",at:"left top"}}),o.change(function(n){var r;"INPUT"==n.target.nodeName&&((r={})[n=e(n.target).closest("li").data("option")]=!a.groupModel[n],i.option(r))})},isOn:function(){var e=this.that.options.groupModel;return e.on&&(e.dataIndx||[]).length},getRC:function(e){var n=1,i=this;return(e[i.childstr]||[]).forEach(function(e){n+=i.getRC(e)}),n+(e.pq_child_sum?1:0)},initmerge:function(){var e,n=this,i=n.that,r=i.options,o=r.groupModel,a=o.merge,l=o.summaryInTitleRow,s=o.titleIndx,d=i.colModel.length,c=[],u=o.dataIndx,h=(u.length,i.pdata||[]);o.on&&(a?u.forEach(function(i,r){h.forEach(function(i){i.pq_gtitle&&r==i.pq_level&&(e=n.getRC(i),c.push({r1:i.pq_ri,rc:e,c1:r,cc:1}))})}):u.length&&h.forEach(function(e){!e.pq_gtitle||l&&(e.pq_close||"collapsed"!==l)||c.push({r1:e.pq_ri,rc:1,c1:s?i.colIndxs[s]:e.pq_level,cc:d})})),c.length?(n.mc=r.mergeCells=c,i.iMerge.init()):n.mc.length&&(n.mc.length=0,i.iMerge.init())},initcollapsed:function(){var e,n,i,r,o,a=this.that,l=a.options.groupModel,s=l.merge,d=l.summaryInTitleRow,c=this.nodeClose,u=a.pdata,h=this.id;if(u){for(var f=0,p=u.length;f<p;f++)(i=u[f]).pq_gtitle&&(r=i.pq_level,o=null,c&&null!=(n=c[e=i[h]])&&(delete c[e],o=i.pq_close=n),(o=null==o?i.pq_close:o)?this.hideRows(f+1,r,s,d):s&&(i.pq_hidden=!0));a._trigger("groupHideRows")}},updateItems:function(e){var n,i,r=this,o=0,a=r.childstr;return(e||r.that.pdata).forEach(function(e){e.pq_gtitle&&((i=(n=e[a]).length)&&n[0][a]?e.pq_items=r.updateItems(n):e.pq_items=i,o+=e.pq_items)}),o},removeEmptyParent:function(e){var n,i=this.that.pdata,r=this.childstr;e[r].length||(i=(r=(n=this.getParent(e))?n[r]:i).indexOf(e),r.splice(i,1),n&&this.removeEmptyParent(n))},addNodes:function(e,n,i){this.moveNodes(e,n,i,!0)},deleteNodes:function(e){this.moveNodes(e,null,null,null,!0)},moveNodes:function(e,n,i,r,o){var a,l,s,d,c=this,u=c.that,h=c.childstr,f=u.options,p=f.groupModel,g=p.dataIndx,m=c.getRoots(),v=n?n[h]:m,$=[],x=c.parentId,w=c.getUniqueNodes(e),y=0,C=v[0],_=v.length;if(i=null==i||_<=i?_:i,s=w.length){for(u._trigger("beforeMoveNode");y<s;y++)d=w[y],r?v.splice(i++,0,d):(l=(a=(a=c.getParent(d))?a[h]:m).indexOf(d),o?a.splice(l,1):a==v?i=pq.moveItem(d,v,l,i):(v.splice(i++,0,d),a.splice(l,1))),n&&a!=v&&(g.slice(0,n.pq_level+1).forEach(function(e){c.isFolder(d)?c.getChildrenAll(d).forEach(function(i){i[e]=n[e]}):d[e]=C[e]}),d[x]=C[x],d.pq_hidden=C.pq_hidden);v==m&&(u.pdata=v),c.updateItems(),c.summaryT(),u.pageData().forEach(function(e){e.pq_gtitle||e.pq_gsummary||$.push(e)}),f.dataModel.data=$,c.isCascade(p)&&(c.cascadeInit(),c.setValCBox()),u.iRefresh.addRowIndx(),c.initmerge(),u._trigger((r?"add":o?"delete":"move")+"Node",null,{args:arguments}),u.refresh({header:!1})}},onCellClick:function(n){return function(i,r){var o;r.rowData.pq_gtitle&&e(i.originalEvent.target).hasClass("pq-group-icon")&&(pq.isCtrl(i)?n[(o=r.rowData).pq_close?"expand":"collapse"](o.pq_level):n.toggleRow(r.rowIndxPage,i))}},onCellMouseDown:function(){return function(n,i){i.rowData.pq_gtitle&&e(n.originalEvent.target).hasClass("pq-group-icon")&&n.preventDefault()}},onCellKeyDown2:function(n,i){return function(r,o){return 0!=n.onCellKeyDown(r,o)&&(o.rowData.pq_gtitle&&0<=e.inArray(o.dataIndx,i.dataIndx)&&r.keyCode==e.ui.keyCode.ENTER?(n.toggleRow(o.rowIndxPage,r),!1):void 0)}},onChange:function(e,n){return function(i,r){n.source!=r.source&&"checkbox"!=r.source&&(e.summaryT(),e.that.refresh())}},onColumnDrag:function(e){return function(n,i){var i=i.column,r=i.colModel;r&&r.length||!1===i.groupable||i.denyGroup?e.acceptDrop=!1:e.initHeadDroppable()}},onCustomSort:function(e,n){var i,r=this.that,o=r.options.groupModel,a=o.dataIndx,l=n.sorter,s=(l[0]||{}).dataIndx,d=r.columns[s],c=a.indexOf(s);if(a.length&&1==l.length&&!(0<=c&&d.groupChange))return"pq_order"==s||(d.summary||{}).type?this._delaySort(n):(i=a.map(function(e){return{dataIndx:e,dir:l[0].dir}}).concat(l),i=pq.arrayUnique(i,"dataIndx"),this._delaySort(n,function(e){o.titleIndx==s?n.sort_composite=i.map(function(n){return r.iSort.compileSorter([n],e)}):n.sort_composite=i.map(function(n){if(n.dataIndx==s)return r.iSort.compileSorter([n],e)})}))},_delaySort:function(e,n){var i=this,r=i.that,o=r.pdata;if(o&&o.length)return r.one("skipGroup",function(){return n&&n(o),e.data=o,i.onCustomSortTree({},e),r.pdata=e.data,i.summaryRestore(),!1}),!1},summaryRestore:function(){var e=this.childstr;this.that.pdata=function n(i,r){var o=[];return i.forEach(function(i){o.push(i),n(i[e]||[],i).forEach(function(e){o.push(e)})}),r&&r.pq_child_sum&&o.push(r.pq_child_sum),o}(this.getRoots())},onDrop:function(e,n){return function(i,r){r=+r.draggable.attr("pq-col-indx"),r=e.colModel[r].dataIndx,n.addGroup(r),n.acceptDrop=!1}},onSortable:function(n,i){return function(){var r,o,a=[],l=i.groupModel.dataIndx;e(this).find(".pq-group-item").each(function(n,i){o=(o=e(i)).data("indx"),l[n]!==o&&(r=!0),a.push(o)}),r&&n.option({dataIndx:a},"","",function(){n.triggerChange()})}},onDataReady:function(e,n){return function(){var i=n.options.groupModel,r=i.dataIndx.length;i.on&&(r||i.grandSummary?(!1!==n._trigger("skipGroup")&&(e.groupData(),e.buildCache()),n.iRefresh.addRowIndx(),e.refreshColumns(),r&&(e.initcollapsed(),e.initmerge(),e.isCascade(i)&&e.cascadeInit())):e.refreshColumns(),e.setValCBox()),e.createHeader()}},onColMove:function(){var e=this.that.options.groupModel;if(e.titleInFirstCol)return this.that.refreshView(),!1;e.titleIndx||this.initmerge()},option:function(n,i,r,o){var a=n.dataIndx,l=this.that,a=a?a.length:0,s=l.options.groupModel,r={source:r,oldGM:e.extend({},s),ui:n},d=s.dataIndx;0!=l._trigger("beforeGroupOption",null,r)&&(n.agg&&this.updateAgg(n.agg,s.agg),s.on&&d.length&&(!1===n.on||0===a)&&this.showRows(),e.extend(s,n),o&&o(),this.init(),this.setOption(),l._trigger("groupOption",null,r),!1!==i&&l.refreshView())},showRows:function(){this.that.options.dataModel.data.forEach(function(e){e.pq_hidden&&(e.pq_hidden=void 0)})},renderBodyCell:function(e,n){var i,r=this,o=n.checkbox,a=n.dataIndx.length-(r.isPivot()?1:0),l=n.titleIndx,s=l?n.indent:0,d=s*a,c="";return a&&(d+=s),function(e){var a=e.rowData,s=e.column,u=s.renderLabel;if(!e.Export)return u=u&&u.call(r.that,e)||e.formatVal||e.cellData,{text:((e=(c=o&&l&&(i=r.renderCB(o,a,n.cbId))?i[0]:c)&&(s.useLabel||n.useLabel))?"<label>":"")+c+(null==u?"":u)+(e?"</label>":""),style:"text-indent:"+d+"px;"}}},renderCell:function(e,n){var i=this.renderTitle(e,n),r=this.renderBodyCell(e,n),o=this.renderSummary(e);return function(e,a){e._renderG=function(e){var l=e.rowData,s=l.pq_gtitle;return a&&s?i(e):s||l.pq_gsummary?o(e):n.titleIndx==e.dataIndx?r(e):void 0}}},renderSummary:function(e){var n=this.that,i=e.groupModel.dataIndx;return function(r){var o=r.rowData,a=r.column,l=a.summary;if(l&&(o=l[i[o.pq_level]]||l.type))return"function"==typeof(l=e.summaryTitle[o])?l.call(n,r):("number"!=typeof(o=null==(o=r.formatVal)&&null==(o=r.cellData)?"":o)||a.format||parseInt(o)===o||(o=o.toFixed(2)),l?l.replace("{0}",o):o)}},updateformatVal:function(e,n,i){e=e.dataIndx[i],(i=this.that.columns[e])&&i.format&&i!=n.column&&(n.formatVal=pq.format(i,n.cellData))},renderTitle:function(e,n){var i,r,o=this,a=o.that,l=e.rtl,s=n.checkbox,e=e.bootstrap,d=["pq-group-title-cell"],c=n.titleIndx,u=n.indent,h=e.on,e=(h?e.groupModel:n).icon,f=h?["glyphicon "+e[0],"glyphicon "+e[1]]:["ui-icon "+e[0],"ui-icon "+e[1]];return function(e){var h,p,g,m=e.rowData,v=e.column,$=v.useLabel;if(null!=e.cellData)return m.children.length,h=m.pq_close,p=m.pq_level,g=n.title,o.updateformatVal(n,e,p),g=null==(g="function"==typeof(g=v.renderLabel||g[p]||n.titleDefault)?g.call(a,e):g.replace("{0}",e.formatVal||e.cellData).replace("{1}",m.pq_items))?e.formatVal||e.cellData:g,v="pq-group-icon "+f[h?1:0],e.Export?g:(s&&c&&o.isCascade(n)&&(i=o.renderCB(s,m,n.cbId))&&(r=i[0],i[1]&&d.push(i[1])),{text:[($=r&&(null!=$?$:n.useLabel))?"<label>":"","<span class='",v,"'></span>",r,g,$?"</label>":""].join(""),cls:d.join(" "),style:"text-align:"+(l?"right":"left")+";text-indent:"+u*p+"px;"})}},triggerChange:function(){this.that._trigger("groupChange")},removeGroup:function(e){var n=this;n.option({dataIndx:n.that.options.groupModel.dataIndx.filter(function(n){return n!=e})},"","",function(){n.triggerChange()})},refreshColumns:function(){for(var e,n,i,r=this.that,o=r.options,a=o.groupModel,l=a.on,s=a.fixCols,d=this.renderCell(o,a),c=r.columns,u=a.dataIndx,h=u.length,f=r.colModel,p=f.length;p--;)(e=f[p])._renderG&&delete e._renderG,e._nodrag&&(delete e._nodrag,delete e._nodrop),l&&(n=e.summary)&&n.type&&d(e);if(o.editor=l?this.editorSummary(o,a):void 0,l){if(a.titleIndx)d(e=c[a.titleIndx],!0);else{for(p=h-1;0<=p;p--)d(e=c[u[p]],!0);if(s&&!a.titleInFirstCol)for(p=0;p<h;p++)(e=f[i=r.getColIndx({dataIndx:u[p]})])._nodrag=e._nodrop=!0,i!=p&&(r.iDragColumns.moveColumn(i,p,!0),r.refreshCM(null,{group:!0}))}}},saveState:function(){var e=this.nodeClose=this.nodeClose||{};this.fillState(e)},setSumCols:function(e){var n=[],i=[];return e=pq.objectify(e),this.that.colModel.forEach(function(r){var o=r.summary;o&&o.type&&(e[o=r.dataIndx]||(n.push(r),i.push(o)))}),this._sumCols=n,this._sumDIs=i,[n,i]},setOption:function(){this._init&&(this.refreshColumns(),this.summaryData.length=0,this.initmerge())},softRefresh:function(){var e=this.that;this.pdata=null,e.pdata.forEach(function(e){delete e.pq_hidden}),this.initcollapsed(),this.initmerge(),e.refresh({header:!1})},toggleLevel:function(n,i){var r=this.that.options.groupModel,o=r.collapsed,n=e.inArray(n,r.dataIndx),r=pq.isCtrl(i)?"All":"";this[(o[n]?"expand":"collapse")+r](n)},trigger:function(e){var n,i,o,a=e.evt,l=e.rd,s=e.level,d=e.all,c=e.close,e=this.that,u=e.options.groupModel,h=u.dataIndx,f=u.collapsed,u=r.beforeTrigger(a,e),a={};if(l){if(i=l[h[n=l.pq_level]],u(a={level:n,close:c=!l.pq_close,group:i}))return!1;l.pq_close=c}else if(d){if(u(a={all:!0,close:c,level:s}))return!1;for(o=s;o<h.length;o++)f[o]=c}else if(null!=s){if(u(a={level:s,close:c}))return!1;f[s]=c}return e._trigger("group",null,a)},toggleRow:function(e,n){e=this.that.pdata[e],!1!==this.trigger({evt:n,rd:e})&&this.softRefresh()}}),n.pqGrid.prototype.Group=function(e){var n=this.iGroup;if(null==e)return n;n.expandTo(e.indx)}}(jQuery),function(e){var n=e.paramquery,i=n.pqGrid.prototype,r=i.options,o=(e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iDrag=new o(n)}),n.cDrag=function(e){var n=this,i=e.options,r=n.rtl=i.rtl,o=i.dragModel;o.on&&(n.that=e,i.postRenderInterval=i.postRenderInterval||-1,n.model=o,n.ns=".pq-drag",o.tmplDragN=n.rtlfy(r,o.tmplDragN),o.tmplDrag=n.rtlfy(r,o.tmplDrag),e.on("CMInit",n.onCMInit.bind(n)).on("create",n.onCreate.bind(n)))});i.Drag=function(){return this.iDrag},r.dragModel={afterDrop:function(){},beforeDrop:function(e,n){var i=this.Drag(),r=i.getUI().nodes,o=this,a=this.Tree(),l=this.Group();a.isOn()?o=a:l.isOn()&&(o=l),i.clean(),o.deleteNodes(r)},diDrag:-1,dragNodes:function(e){return[e]},contentHelper:function(e,n){var i=n[0],n=n.length;return e.map(function(e){return i[e]}).join(", ")+(1<n?" ( "+n+" )":"")},clsHandle:"pq-drag-handle",clsDnD:"pq-dnd",clsNode:"pq-dnd-drag",iconAccept:"ui-icon ui-icon-check",iconReject:"ui-icon ui-icon-cancel",tmplDragN:"<span class='ui-icon ui-icon-grip-dotted-vertical pq-drag-handle' style='cursor:move;position:absolute;left:2px;top:4px;'>&nbsp;</span>",tmplDrag:"<span class='ui-icon ui-icon-grip-dotted-vertical pq-drag-handle' style='cursor:move;vertical-align:text-bottom;touch-action:none;float:left;'>&nbsp;</span>",cssHelper:{opacity:.7,position:"absolute",height:25,width:200,overflow:"hidden",background:"#fff",border:"1px solid",boxShadow:"4px 4px 2px #aaaaaa",zIndex:1001},tmplHelper:"<div class='pq-border-0 pq-grid-cell' style='pointer-events: none;'><span class='pq-icon' style='vertical-align:text-bottom;margin:0 5px;'></span><span></span></div>"},o.prototype={addIcon:function(e){this.$helper.find(".pq-icon").attr("class","").addClass("pq-icon "+e)},addAcceptIcon:function(){this.addIcon(this.model.iconAccept)},addRejectIcon:function(){this.addIcon(this.model.iconReject)},getHelper:function(n){var i=this.that,r=this.model,o=r.clsNode,a=e(n.target).closest(".pq-grid-cell,.pq-grid-number-cell"),a=this.cellObj=i.getCellIndices({$td:a}),l=r.diHelper||[r.diDrag],s=a.rowData,a=a.nodes=r.dragNodes.call(i,s,n),s=r.contentHelper.call(i,l,a),n=this.$helper=e(r.tmplHelper);return n.find("span:eq(1)").html(s),a.forEach(function(e){i.addClass({rowData:e,cls:o})}),this.addRejectIcon(),n.addClass("pq-theme pq-drag-helper").css(r.cssHelper).data("Drag",this),n[0]},getUI:function(){return this.cellObj},grid:function(){return this.that},isSingle:function(){return 1==this.getData().length},onCMInit:function(){var n=this.that,i=this.model,r=i.isDraggable,o=n.columns[i.diDrag],a=o?i.tmplDrag:i.tmplDragN;(o||n.options.numberCell).postRender=function(i){r&&!r.call(n,i)||e(i.cell).prepend(a)}},onCreate:function(){var n=this,i=n.model,r={top:20},o=-1==i.diDrag;n.that.on(!0,"cellMouseDown",n.onCellMouseDown.bind(n)),r[n.rtl?"right":"left"]=2,n.ele=n.that.$cont.children(":first").addClass(i.clsDnD+(o?" pq-drag-number":"")).draggable(e.extend({cursorAt:r,containment:"document",appendTo:"body"},i.options,{handle:"."+i.clsHandle,helper:n.getHelper.bind(n),revert:n.revert.bind(n)}))},onDrop:function(e,n,i){this.model[e].call(this.that,n,i)},clean:function(){var e=this;e.getUI().nodes.forEach(function(n){e.that.removeClass({rowData:n,cls:e.model.clsNode})})},revert:function(n){this.clean(),n||this.$helper.hide("explode",function(){e(this).remove()})},rtlfy:function(e,n){var i={left:"right",right:"left"};return e?n.replace(/left|right/g,function(e){return i[e]}):n},onCellMouseDown:function(n){var i=this.model;e(n.originalEvent.target).closest("."+i.clsHandle).length&&n.preventDefault()},over:function(e,n){this.addAcceptIcon()},out:function(e,n){this.addRejectIcon()}}}(jQuery),function(e){var n=e.paramquery,i=n.pqGrid.prototype,r=i.options,o=(e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iDrop=new o(n)}),i.Drop=function(){return this.iDrop},r.dropModel={accept:".pq-dnd",clsParent:"pq-dnd-parent",drop:function(e,n){function i(e,n){var i,r,l;(u||n)&&(n=s.iDrop.parent,(l=(r=e.getChildren(n)).length)&&(i=u?u==n?h?null:0:r.indexOf(u)+(h?0:1):l),o?e.moveNodes(a,n,i):e.addNodes(a,n,i))}var r,o,a,l=n.helper.data("Drag"),s=this,d=s.Group(),c=s.Tree(),u=n.rowData,h=.5>=n.ratioY(),n=null==(n=n.rowIndx)?n:n+(h?0:1);l&&(r=l.getUI(),o=l.grid()==s,a=r.nodes,d.isOn()?i(d):c.isOn()?i(c,!0):o?s.moveNodes(a,n):s.addNodes(a,n))},getParent:function(e,n){var i,r,o=n.rowData,a=this.options,l=a.dropModel.divider,s=this.Group(),d=s.isOn(),c=this.Tree(),u=c.isOn();if(o)return u?r=l?(i=(u=this.widget()).offset().left,r=(n=n.helper).offset().left,(a.rtl?i+u.width()-r-n.width()>l:l<r-i)?o:c.getParent(o)):c.getParent(o):d&&(r=s.getParent(o)),r}},n.cDrop=function(e){var n=e.options,i=n.dropModel;(this.model=i).on&&(this.that=e,this.rtl=n.rtl,this.ns=".pq-drop",e.on("create",this.onCreate.bind(this)))});o.prototype={addUI:function(n,i,r){var o=this;n.$cell=r,n.ratioY=function(){return o.ratioY(i,r)},e.extend(n,o.that.getCellIndices({$td:r}))},callFn:function(e,n,i){if(e=this.model[e])return e.call(this.that,n,i)},feedback:function(e,n){var i,r,o;n.length&&(i=(o=this.getCellY(n))[0],r=this.that.$cont,e=this.ratioY(e,n),n=r.offset().left,o=o[1],this.$feedback=this.$feedback||this.newF(),this.$feedback.css({top:e<=.5?i-1:o-1,left:n,width:r[0].clientWidth,zIndex:1e4}),r.css("cursor","copy"))},getCell:function(e){return e.closest(".pq-grid-cell,.pq-grid-number-cell")},getCellY:function(e){var n=e.offset().top;return[n,n+e[0].offsetHeight]},getDrag:function(e){return e.helper.data("Drag")},isOn:function(){return this.model.on},isOver:function(){},newF:function(){return e("<svg class='pq-border-0' style='box-sizing:border-box;position:absolute;border-width:1.5px;border-style:dashed;pointer-events:none;height:0;'></svg>").appendTo(document.body)},onCreate:function(){this.that.$cont.droppable(e.extend({tolerance:"pointer"},this.model.options,{accept:this.model.accept,over:this.onOver.bind(this),out:this.onOut.bind(this),drop:this.onDrop.bind(this)}))},onOver:function(n,i){var r=this,o=r.model.divider,a=r.Drag=r.getDrag(i);i.draggable.on("drag.pq",r.onDrag.bind(r)),o&&(r.$left=e("<svg class='pq-border-0' style='position:absolute;width:0;height:100%;"+(r.rtl?"right:":"left:")+o+"px;top:0;border-style:dashed;border-width:1.5px;pointer-events:none;'></svg>").appendTo(r.that.$cont)),a&&a.over(n,i),r.isOver=function(){return!0},r.callFn("over",n,i)},onOut:function(e,n){n.draggable.off("drag.pq"),this.removeFeedback();var i=this.getDrag(n),r=this.$left;r&&r.remove(),i&&i.out(e,n),this.isOver=function(){},this.callFn("out",e,n)},setParent:function(e){var n=this.that,i=this.model.clsParent,r=this.parent;r!=e&&(r&&n.removeClass({rowData:r,cls:i}),e&&n.addClass({rowData:e,cls:i})),this.parent=e},setDeny:function(e,n,i){var r=this.Drag;this.denyDrop=!1===this.callFn("isDroppable",e,n),this.denyDrop?(r&&r.out(),this.removeFeedback()):(r&&r.over(),this.feedback(e,i),this.setParent(this.callFn("getParent",e,n)))},onDrag:function(e,n){var i=pq.elementFromXY(e),r=this.getCell(i);(r.length||this.that.$cont[0].contains(i[0]))&&(this.addUI(n,e,r),this.setDeny(e,n,r))},onDropX:function(e,n){function i(i){if(a&&a.grid()!=r)a.onDrop(i,e,n);else try{o.draggable("instance").options[i].call(o[0],e,n)}catch(l){}}var r=this.that,o=n.draggable,a=n.helper.data("Drag");i("beforeDrop"),this.callFn("drop",e,n),this.setParent(),i("afterDrop")},onDrop:function(e,n){var i,r=pq.elementFromXY(e);this.onOut(e,n),this.denyDrop||((i=this.getCell(r)).length||this.that.$cont[0].contains(r[0]))&&(this.addUI(n,e,i),this.onDropX(e,n))},onMouseout:function(){this.removeFeedback()},onMouseup:function(){this.removeFeedback(),e(document).off(this.ns),this.that.$cont.off(this.ns)},ratioY:function(e,n){if(n.length)return(e.pageY-(n=(e=this.getCellY(n))[0]))/(e[1]-n)},removeFeedback:function(){var e=this;e.$feedback&&(e.$feedback.remove(),e.$feedback=null),e.that.$cont.css("cursor",""),requestAnimationFrame(function(){e.setParent()})}}}(jQuery),function(e){var n=e.paramquery,i=(n.pqGrid.defaults.contextMenu={preInit:function(e){if(pq.isCtrl(e))return!1},init:function(e,n){var i,r;n.$td&&(i={r1:n.rowIndx,c1:n.colIndx,rc:1,cc:1},-1==(r=this.Selection()).indexOf(i)&&(r.removeAll(),this.Range(i).select()),this.focus(n))}},e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iContext=new i(n)}),n.cContext=function(e){var n=e.options;this.model=n.contextMenu,this.that=e,this.ns=".pq-cmenu",this.rtl=n.rtl,e.on("context",this.onContext.bind(this)).on("destroy",this.removeMenu.bind(this))});i.prototype={createMenu:function(n){n=n.filter(function(e){return null!=e});var i,r=this,o="";return n.forEach(function(e,n){o+=r.getItemHtml(e,n)}),(i=e("<div dir='"+(r.rtl?"rtl":"ltr")+"' class='pq-cmenu pq-theme pq-popup'><table>"+o+"</table></div>").appendTo(document.body)).find(".pq-cmenu-item").each(function(i,r){e(r).data("item",n[i])}),i.on("mouseover",r.onMouseOver.bind(r)).on("remove",r.onRemove(r)),i},get$Item:function(n){return e(n.target).closest(".pq-cmenu-item")},getItem:function(e){return this.get$Item(e).data("item")},getItemHtml:function(e,n){var i,r;return"separator"==e?"<tr class='pq-cmenu-item'><td colspan=4 class='pq-bg-3' style='height:1px;padding:0;'></td></td>":(i=e.style,r=e.tooltip,"<tr class='pq-cmenu-item "+(e.disabled?"pq_disabled":"")+" "+(e.cls||"")+"' indx="+n+"><td><span class='"+(e.icon||"")+"' /></td><td "+(i?'style="'+i+'"':"")+" "+(r?'title="'+r+'"':"")+">"+e.name+"</td><td>"+(e.shortcut||"")+"</td><td><span class='"+(e.subItems?"pq-submenu ui-icon ui-icon-triangle-1-"+(this.rtl?"w":"e"):"")+"' /></td></tr>")},onContext:function(e,n){if(this.model.on)return this.showMenu(e,n)},onRemove:function(n){return function(){e(this).find(".pq-cmenu-item").each(n.removeSubMenu)}},onMouseDown:function(e){this.getItem(e)||this.removeMenu()},onclickDoc:function(e){var n,i=this.getItem(e);i&&!i.disabled&&(n=i.action)&&!1!==n.call(this.that,e,this.ui,i)&&this.removeMenu()},onMouseOver:function(e){var n=this.rtl,i=this.getItem(e),e=this.get$Item(e),i=(i||{}).subItems;e.siblings().each(this.removeSubMenu),i&&i.length&&!e[0].subMenu&&((i=this.createMenu(i)).position({my:n?"right top":"left top",at:n?"left top":"right top",of:e,collision:"flipfit"}),e[0].subMenu=i)},removeMenu:function(){this.$menu&&(this.$menu.remove(),delete this.$menu,e(document.body).off(this.ns))},removeSubMenu:function(e,n){var i="subMenu";n[i]&&(n[i].remove(),delete n[i])},showMenu:function(n,i){var r=this,o=r.rtl,a=r.model,l=r.ns,s=r.that,d=r.$menu,c=i.type,c="function"==typeof(c=a[c+"Items"]||(c?a.items:a.miscItems))?c.call(s,n,i):c;if(d&&r.removeMenu(),c&&c.length&&!1!==a.preInit.call(s,n,i))return a.init.call(s,n,i),r.ui=i,(d=r.$menu=r.createMenu(c)).position({my:(o?"right":"left")+" top",of:n,collision:"fit"}),e(document.body).on("click"+l,r.onclickDoc.bind(r)).on("mousedown"+l+" touchstart"+l,r.onMouseDown.bind(r)),!1}}}(jQuery),function(e){e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iAnim=new i(n)});var n=e.paramquery,i=n.cAnim=function(e){var n=this.model=e.options.animModel;this.grid=e,this.nodes=[],n.on&&e.on(n.events,this.onBefore.bind(this))},r=n.pqGrid.prototype,o=r.options;r.Anim=function(){return this.iAnim},o.animModel={duration:290,events:"beforeSortDone beforeFilterDone beforeRowExpandDone beforeGroupExpandDone beforeMoveNode beforeAutoRowHeight beforeValidateDone beforeTreeExpandDone onResizeHierarchy",eventsH:"beforeColAddDone beforeColRemoveDone beforeHideColsDone beforeColumnCollapseDone beforeColMoveDone beforeFlex columnResize"},n.mixAnim={cleanUp:function(){(this.data||[]).forEach(function(e){e.pq_top=e.pq_hideOld=void 0}),this.data=this.render=null},stop:function(){this.nodes.forEach(function(e){e.stop()}),this.nodes=[]}},i.prototype=e.extend({isActive:function(){return this._active},onBefore:function(e,n){if(!e.isDefaultPrevented()&&!this.data){var i,r=this,e=r.grid,o=e.iRenderB,a=r.data=o.data,l=r.render=[];try{r.htTbl=o.dims.htTbl,o.eachV(function(e,n){i=o.get$Row(n),e.pq_render=1,l.push([e,i.clone(),i.map(function(e,n){return n.parentNode})])}),a.forEach(function(e,n){e.pq_top=o.getTop(n),e.pq_hideOld=e.pq_hidden}),e.one("refresh",r.oneRefresh.bind(r)),setTimeout(function(){r.cleanUp()})}catch(s){r.data=null}}},oneRefresh:function(){var n,i,r,o,a,l,s;this.data&&(i=(n=this).grid.iRenderB,r=n.model.duration,o=e([i.$tbl_left[0],i.$tbl_right[0]]),a=n.htTbl,l=i.dims.htTbl,n.stop(),n._active=!0,l<a&&o.css("height",a),setTimeout(function(){o.css("height",i.dims.htTbl),n._active=!1},r),i.eachV(function(e,o){delete e.pq_render;var a,l=i.getTop(o),d=e.pq_top;(d!=l||e.pq_hideOld)&&(s=i.get$Row(o),o=null==d||e.pq_hideOld?(a={opacity:0},{opacity:1}):(a={top:d},{top:l}),s.css(a).animate(o,r),n.nodes.push(s))}),n.render.forEach(n.removeRows.bind(n)),n.cleanUp())},removeRows:function(n){var i,r=n[0],o=r.pq_ri,a=this.model.duration,l={opacity:1,top:r.pq_top};if(r.pq_render){if(delete r.pq_render,(i=n[1].each(function(i,r){e(r).removeAttr("id").appendTo(n[2][i]).children().removeAttr("id")})).css(l),null==o||r.pq_hidden)l={opacity:0};else try{l={top:this.grid.iRenderB.getTop(o)}}catch(s){l={opacity:0}}i.animate(l,a,function(){this.parentNode&&this.parentNode.removeChild(this)}),this.nodes.push(i)}}},n.mixAnim)}(jQuery),function(e){e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iAnimH=new i(n)});var n=e.paramquery,i=n.cAnimH=function(e){var n=e.options,i=this.model=n.animModel;this.grid=e,this.rtl=n.rtl?"right":"left",this.nodes=[],i.on&&e.on(i.eventsH,this.onBeforeCol.bind(this))};n.pqGrid.prototype.AnimH=function(){return this.iAnimH},i.prototype=e.extend({get$Col:function(){var e=this.grid,n=e.iRenderB,i=e.iRenderHead,r=e.iRenderSum,o=n.getAllCells(),a=i.getAllCells(),l=r.getAllCells();return function(e){return n.get$Col(e,o).add(i.get$Col(e,a)).add(r.get$Col(e,l))}},onBeforeCol:function(e){if(!e.isDefaultPrevented()&&!this.data){var n,e=this.grid,i=this.data=e.getColModel(),r=this.get$Col(),o=e.iRenderB,a=this.render=[];try{i.forEach(function(e,n){e.pq_hideOld=e.hidden,e.pq_top=o.getLeft(n)})}catch(l){return void this.cleanUp()}o.eachH(function(e,i){n=r(i),e.pq_render=1,a.push([e,n.clone(),n.map(function(e,n){return n.parentNode.id})])}),e.one("softRefresh refresh",this.oneRefreshCol.bind(this))}},oneRefreshCol:function(){var e,n,i,r,o;this.data&&(n=(e=this).grid.iRenderB,i=e.model.duration,r=e.get$Col(),e.stop(),n.eachH(function(a,l){delete a.pq_render;var s=n.getLeft(l),d=a.pq_top,c=e.rtl,u={opacity:0},h={opacity:1},f={};(d!=s||a.pq_hideOld)&&(o=r(l),null==d?o.css(u).animate(h,i):a.pq_hideOld?(u[c]=d,h[c]=s,o.css(u).animate(h,i)):(f[c]=s,o.css(c,d).animate(f,i)),e.nodes.push(o))}),e.render.forEach(e.removeCols.bind(e)),e.cleanUp())},removeCols:function(n){var i,r=n[0],o=this.model.duration,a=this.grid,l=a.iRenderB,a=a.colIndxs[r.dataIndx];r.pq_render&&(delete r.pq_render,i=n[1].each(function(i,r){e(r).removeAttr("id").appendTo(document.getElementById(n[2][i]))}),r=null==a||r.hidden?(i.css("opacity",1),{opacity:0}):{left:l.getLeft(a)},i.animate(r,o,function(){this.parentNode&&this.parentNode.removeChild(this)}),this.nodes.push(i))}},n.mixAnim)}(jQuery),function(e){var n=e.paramquery,i=n.pqGrid.defaults,r=(e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iFillHandle=new r(n)}),i.fillHandle="all",i.autofill=!0,n.cFillHandle=function(e){var n=this;n.$wrap,n.locked,n.sel,n.that=e,n.rtl=e.options.rtl,e.on("selectChange",n.onSelectChange(n)).on("selectEnd",n.onSelectEnd(n)).on("assignTblDims",n.onRefresh(n)).on("keyDown",n.onKeyDown.bind(n))});r.prototype={getLT:function(e,n,i,r){return Math.min((e-=n/2)+n,i["offset"+r])-n},create:function(){var n,i,r,o=this.that;this.locked||(this.remove(),1===(r=o.Selection().address()).length&&(i=(r=r[0]).r2,r=r.c2,n="parentNode",i=o.iMerge.getRootCellO(i,r,!0),(r=o.getCell(i)).length&&!1!==o._trigger("beforeFillHandle",null,i)&&(n=(r=r[0][n][n])[n],o=o.iRenderB.getCellCoords(i.rowIndxPage,i.colIndx),i=this.getLT(o[2],10,r,"Width"),o={position:"absolute",top:this.getLT(o[3],10,r,"Height"),height:10,width:10,background:"#333",cursor:"crosshair",border:"2px solid #fff",zIndex:1},r=e("<div class='pq-fill-handle'></div>").appendTo(n),o[this.rtl?"right":"left"]=i,r.css(o),this.$wrap=r,this.setDraggable(),this.setDoubleClickable())))},onSelectChange:function(e){return function(){e.remove()}},onSelectEnd:function(e){return function(){this.options.fillHandle&&e.create()}},onRefresh:function(e){var n;return function(){this.options.fillHandle?(clearTimeout(n),n=setTimeout(function(){e.that.element&&e.create()},50)):e.remove()}},remove:function(){var e=this.$wrap;e&&e.remove()},setDoubleClickable:function(){var e=this.$wrap;e&&e.on("dblclick",this.onDblClick(this.that,this))},setDraggable:function(){var e=this.$wrap,n=this.that.$cont;e&&e.draggable({helper:function(){return"<div style='height:10px;width:10px;cursor:crosshair;'></div>"},appendTo:n,start:this.onStart.bind(this),drag:this.onDrag.bind(this),stop:this.onStop.bind(this)})},patternDate:function(e){var n=this;return function(i){var r=new Date(e);return r.setDate(r.getDate()+(i-1)),n.formatDate(r)}},formatDate:function(e){return e.getMonth()+1+"/"+e.getDate()+"/"+e.getFullYear()},patternDate2:function(e,n){var i,r=new Date(e),n=new Date(n),o=this,a=n.getDate()-r.getDate(),l=n.getMonth()-r.getMonth(),s=n.getFullYear()-r.getFullYear();return(l||s)&&(a||l)&&(s||a)?(r=Date.parse(r),i=Date.parse(n)-r,function(e){return e=new Date(r+i*(e-1)),o.formatDate(e)}):function(n){var i=new Date(e);return a?i.setDate(i.getDate()+a*(n-1)):l?i.setMonth(i.getMonth()+l*(n-1)):i.setFullYear(i.getFullYear()+s*(n-1)),o.formatDate(i)}},getDT:function(e){for(var n,i,r,o=e.length,a=0,l=pq.valid;a<o;a++){if(n=e[a],l.isFloat(n)?r="number":l.isDate(n)&&(r="date"),i&&i!=r)return"string";i=r}return r},pattern:function(e){var n=this.getDT(e);if("string"==n||!n)return!1;var i,r,o,a=e.length,n="date"===n;return n||(e=e.map(function(e){return+e})),2===a?n?this.patternDate2(e[0],e[1]):(i=e[1]-e[0],r=e[0]-i,function(e){return i*e+r}):3===a&&(i=(e[2]-2*e[1]+e[0])/2,r=e[1]-e[0]-3*i,o=e[0]-i-r,function(e){return i*e*e+r*e+o})},autofillVal:function(e,n,i,r){var o,a,l,s,d,c=this.that,u=e.r1,h=e.c1,f=e.r2,p=e.c2,e=n.r1,g=n.c1,m=n.r2,v=n.c2,$=[];if(r){for((s={r1:u,r2:f}).c1=g<h?g:p+1,s.c2=g<h?h-1:v,d=g-h,a=g;a<=v;a++)if(d++,a<h||p<a)for(o=0,l=u;l<=f;l++)$.push(i[o](d,a)),o++}else for((s={c1:h,c2:p}).r1=e<u?e:f+1,s.r2=e<u?u-1:m,d=e-u,a=e;a<=m;a++)if(d++,a<u||f<a)for(o=0,l=h;l<=p;l++)$.push(i[o](d,a)),o++;return c.Range(s).value($),c.focus(),!0},autofill:function(e,n){var i,r,o,a,l,s,d,c,u=this.that,h=u.colModel,f=u.get_p_data(),p=[],g=e.r1,m=e.c1,v=e.r2,$=e.c2,x=n.c1!=m||n.c2!=$;if(x){for(l=g;l<=v;l++){if(u._trigger("autofillSeries",null,d={sel:{r:l,c:m},x:!0}),!(c=d.series))return;p.push(c)}return this.autofillVal(e,n,p,x)}for(s=m;s<=$;s++){for(r=(i=h[s]).dataType,a=i.dataIndx,o=[],l=g;l<=v;l++)o.push(f[l][a]);if(u._trigger("autofillSeries",null,d={cells:o,sel:{r1:g,c:s,r2:v,r:g}}),!(c=d.series||this.pattern(o,r)))return;p.push(c)}return this.autofillVal(e,n,p)},onKeyDown:function(n){var i,r;!this.oldAF&&pq.isCtrl(n)&&(r=(i=this).that.options,i.oldAF=r.autofill,r.autofill=!1,e(document.body).one("keyup",function(){r.autofill=i.oldAF,delete i.oldAF}))},onStop:function(){var e=this.that,n=e.options.autofill,i=this.sel,r=e.Selection().address()[0];i.r1==r.r1&&i.c1==r.c1&&i.r2==r.r2&&i.c2==r.c2||n&&this.autofill(i,r)||(e.Range(i).copy({dest:r}),e.focus()),this.locked=!1},onStart:function(){this.locked=!0,this.sel=this.that.Selection().address()[0]},onDrag:function(n){var i,r,o,a,l,s,d=this.that,c=d.options.fillHandle,u="all"==c,h=u||"horizontal"==c,c=u||"vertical"==c,f=n.clientX-10,n=n.clientY,f=document.elementFromPoint(f,n),n=e(f).closest(".pq-grid-cell");n.length&&(f=d.getCellIndices({$td:n}),i=(n=this.sel).r1,r=n.c1,a={r1:i,c1:r,r2:o=n.r2,c2:n=n.c2},l=function(e,n){a[e]=n,d.Range(a).select()},s=f.rowIndx,f=f.colIndx,u&&s<=o&&i<=s||h&&!c?n<f?l("c2",f):f<r&&l("c1",f):c&&(o<s?l("r2",s):s<i&&l("r1",s)))},onDblClick:function(e,n){return function(){var i=e.options,r=i.fillHandle;if("all"==r||"vertical"==r){for(var o,r=e.Selection().address()[0],a=r.c2,l=r.r2+1,s=i.dataModel.data,d=e.getColModel()[a].dataIndx;o=s[l];){if(null!=o[d]&&""!==o[d]){l--;break}l++}n.onStart(),e.Range({r1:r.r1,c1:r.c1,r2:l,c2:a}).select(),n.onStop()}}}}}(jQuery),function(e){e(document).on("pqGrid:bootup",function(e,i){new n(i.instance)});var n=e.paramquery.cScroll=function(e){this.that=e,this.ns=".pqgrid-csroll",this.rtl=e.options.rtl,e.on("create",this.onCreate.bind(this))};n.prototype={onCreate:function(){var n=this.that;e(n.iDrop&&n.iDrop.isOn()?document:n.$cont).on("mousedown",this.onMouseDown.bind(this))},onMouseDown:function(n){var i=this.that,n=e(n.target),r=(this.$draggable=n.closest(".ui-draggable")).length,o=this.ns;(r||n.closest(i.$cont).length)&&(i=n.closest(".pq-fill-handle").length,e(document).on("mousemove"+o,this[r&&!i?"onMouseMove":"process"].bind(this)).on("mouseup"+o,this.onMouseUp.bind(this)))},onMouseMove:function(e){var n=this.that;(this.capture||pq.elementFromXY(e).closest(n.$cont).length&&n.iDrop.isOver())&&(this.capture=!0,this.process(e))},onMouseUp:function(){e(document).off(this.ns),this.capture=!1},process:function(e){var n=this.that.$cont,i=n[0].offsetHeight,r=n[0].offsetWidth,n=n.offset(),o=n.top,n=n.left,i=o+i,r=n+r,a=e.pageY,e=e.pageX,l=a-i,s=e-r,d=o-a,c=n-e;n<e&&e<r&&(0<l||0<d)?0<l?this.scrollV(l,!0):0<d&&this.scrollV(d):o<a&&a<i&&(0<s?this.scrollH(s,!0):0<c&&this.scrollH(c))},scrollH:function(e,n){this.scroll(e,this.rtl?!n:n,!0)},scrollV:function(e,n){this.scroll(e,n)},scroll:function(e,n,i){var r=this.that.iRenderB,o=r.getContRight()[0],a=o[i?"scrollWidth":"scrollHeight"],o=pq[i?"scrollLeft":"scrollTop"](o),a=(e=Math.pow(e,a<1e3?1:1+(a-1e3)/a),o+(n?e:-e));r[i?"scrollX":"scrollY"](a)}}}(jQuery),function(){var e=jQuery.paramquery;e.cFormula=function(e){var n=this;n.that=e,n.oldF=[],e.one("ready",function(){e.on("CMInit",n.onCMInit.bind(n))}).on("beforePivotSummary",n.calcMainData.bind(n)).on("dataAvailable",n.onDA.bind(n)).on(!0,"change",n.onChange.bind(n))},e.cFormula.prototype={onCMInit:function(){this.isFormulaChange(this.oldF,this.formulas())&&this.calcMainData()},callRow:function(e,n,i){var r=this.that,o=0;if(e)for(;o<i;o++){var a=n[o],l=a[0],s=a[1];e[l.dataIndx]=s.call(r,e,l,a[2])}},onDA:function(){this.calcMainData()},isFormulaChange:function(e,n){var i=!1,r=0,o=e.length;if(o==n.length){for(;r<o;r++)if(e[r][1]!=n[r][1]){i=!0;break}}else i=!0;return i},calcMainData:function(){var e=this.formulaSave(),n=this.that,i=e.length;if(i){for(var r=n.options.dataModel.data,o=r.length;o--;)this.callRow(r[o],e,i);n._trigger("formulaComputed")}},onChange:function(e,n){function i(e){o.callRow(e.rowData,l,s)}var r,o=this,a=o.that,l=o.formulas(),s=l.length,d=n.addList,n=n.updateList;s&&(d.forEach(i),n.forEach(i),1!=n.length||d.length||(r=n[0],l.forEach(function(e){a.refreshCell({rowIndx:r.rowIndx,dataIndx:e[0].dataIndx})})))},formulas:function(){var e,n,i,r=this.that,o=[],a=r.colIndxs;return(r.options.formulas||[]).forEach(function(l){i=l[0],(e=r.getColumn({dataIndx:i}))&&(n=l[1])&&o.push([e,n,a[i]])}),o},formulaSave:function(){var e=this.formulas();return this.oldF=e}}}(),function(e){var n=e.paramquery,i=(n.pqGrid.defaults.treeModel={cbId:"pq_tree_cb",source:"checkboxTree",childstr:"children",iconCollapse:["ui-icon-triangle-1-se","ui-icon-triangle-1-e"],iconFolder:["ui-icon-folder-open","ui-icon-folder-collapsed"],iconFile:"ui-icon-document",id:"id",indent:18,parentId:"parentId",refreshOnChange:!0},n.pqGrid.prototype.Tree=function(){return this.iTree},e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iTree=new i(n)}),n.cTree=function(e){var n=this;n.Model=e.options.treeModel,n.that=e,n.fns={},n.init(),n.isTree=!0,n.cache={},n.di_prev,n.chkRows=[],Object.defineProperty(n.Model,"nodeClose",{get:function(){return n.fillState({})},set:function(e){n.nodeClose=e}})});i.prototype=e.extend({},pq.mixin.ChkGrpTree,pq.mixin.GrpTree,{addNodes:function(e,n,i){var r,o,a,l,s,d=this,c=d.that,u=c.options.dataModel,h=d.Model,u=u.data,f=d.parentId,p=d.childstr,g=d.id,m={},v=[],$=0,x=d.cache,w=[];if(e.forEach(function(e){l=e[f],s=s||x[l],d.eachChild(e,function(e,n){var i=e[g];x[i]||m[i]||(m[i]=e,n&&(e[f]=n[g]),v.push(e))},n||x[l])}),v.forEach(function(e){m[l=e[f]]||x[l]||delete e[f]}),a=(o=(e=((n=n||s)||{})[p]||d.getRoots()||[]).length)&&0!=i?null==i||o<i?e[o-1]:e[i-1]:n,r=u.indexOf(a)+1,o=v.length){for(;$<o;$++)a=v[$],w.push({newRow:a,rowIndx:r++});c._digestData({addList:w,checkEditable:!1,source:"addNodes",history:h.historyAdd}),d.refreshView()}},updateId:function(e,n){var i=this.id,r=this.parentId,o=e[i],a=this.cache;a[n]||(a[e[i]=n]=e,delete a[o],(this.getChildren(e)||[]).forEach(function(e){e[r]=n}))},collapseAll:function(e){this[e?"expandNodes":"collapseNodes"](this.that.options.dataModel.data)},collapseNodes:function(e,n,i){for(var r,o=0,a=this.that,l=e.length,s=[],d=!i;o<l;o++)r=e[o],this.isFolder(r)&&this.isCollapsed(r)!==d&&s.push(r);if(s.length&&(i={close:d,nodes:s},!1!==a._trigger("beforeTreeExpand",n,i))){for(l=s.length,o=0;o<l;o++)(r=s[o]).pq_close=d;a._trigger("treeExpand",n,i),this.setCascadeInit(!1),this.refreshView()}},deleteNodes:function(e){var n,i,r=this.that,o=this.Model,a=0,l={},s=this.id,d=[];if(e){for(n=e.length;a<n;a++)i=e[a],this.eachChild(i,function(e){var n=e[s];l[n]||(l[n]=1,d.push({rowData:e}))});r._digestData({deleteList:d,source:"deleteNodes",history:o.historyDelete}),this.refreshView()}},makeLeaf:function(e){e[this.childstr]=e.pq_close=e.pq_child_sum=void 0},expandAll:function(){this.collapseAll(!0)},expandNodes:function(e,n){this.collapseNodes(e,n,!0)},expandTo:function(e){for(var n=[];e.pq_close&&n.push(e),e=this.getParent(e););this.expandNodes(n)},exportCell:function(e,n){for(var i="",r=0;r<n;r++)i+="- ";return i+(null==e?"":e)},filter:function(e,n,i,r,o,a,l){function s(e,n){u=n||u,l?e.pq_hidden=e.pq_filter=!n:(n?o:a).push(e)}for(var d,c,u,h,f=this.childstr,p=this.Model.filterShowChildren,g=0,m=e.length;g<m;g++){if(c=!1,h=(d=e[g])[f]){if(p&&i.isMatchRow(d,n,r)){this.eachChild(d,function(e){s(e,!0)}),u=!0;continue}(c=this.filter(h,n,i,r,o,a,l))&&s(d,!0)}c||s(d,i.isMatchRow(d,n,r))}return u},getFormat:function(){for(var e,n,i=this.that.options.dataModel.data,r=0,o=i.length,a=this.parentId,l=this.childstr;r<o&&null==(e=i[r])[a];r++)if((n=e[l])&&n.length)return this.getParent(n[0])==e?"flat":"nested";return"flat"},getLevel:function(e){return e.pq_level},_groupById:function(e,n,i,r,o){for(var a=this.childstr,l=0,s=i.length;l<s;l++){var d=i[l],c=d[n];d.pq_level=o,e.push(d),(c=r[c])?(d[a]=c,this._groupById(e,n,c,r,o+1)):(null!=d.pq_close||d[a])&&(d[a]=[])}},groupById:function(e){for(var n,i,r,o=this.id,a=this.parentId,l={},s=[],d=0,c=e.length;d<c;d++)(i=(i=l[n=null==(n=(r=e[d])[a])?"":n])?i:l[n]=[]).push(r);return this._groupById(s,o,l[""]||[],l,0),s},init:function(){var e=this,n=e.that,i=n.options,r=e.Model,o=r.cbId,a=e.dataIndx=r.dataIndx;e.cbId=o,e.prop="pq_tree_prop",e.id=r.id,e.parentId=r.parentId,e.childstr=r.childstr,e.onCMInit(),a?e._init||(e.on("CMInit",e.onCMInit.bind(e)).on("dataAvailable",e.onDataAvailable.bind(e)).on("dataReadyAfter",e.onDataReadyAfter.bind(e)).on("beforeCellKeyDown",e.onBeforeCellKeyDown.bind(e)).on("customSort",e.onCustomSortTree.bind(e)).on("customFilter",e.onCustomFilter.bind(e)).on("clearFilter",e.onClearFilter.bind(e)).on("change",e.onChange(e,n,r)).on("cellClick",e.onCellClick.bind(e)).on("refresh refreshRow",e.onRefresh(e,r)).on("valChange",e.onCheckbox(e,r)).on("refreshHeader",e.onRefreshHeader.bind(e)).on("beforeCheck",e.onBeforeCheck.bind(e)),e.setCascadeInit(!0),e._init=!0):e._init&&(e.off(),e._init=!1),e._init&&(i.groupModel.on=r.summary)},initData:function(){var e=this.that.options.dataModel;e.data=this["flat"==this.getFormat()?"groupById":"flatten"](e.data),this.buildCache()},isCollapsed:function(e){return!!e.pq_close},isOn:function(){return null!=this.Model.dataIndx},moveNodes:function(e,n,i,r){var o,a,l,s,d,c,u,h=this,f=arguments,p=h.that,g=i,m=h.parentId,v=h.id,$=h.childstr,x=p.options,w=h.Model,x=x.dataModel,y=h.getRoots(),C=!r,_=n?n[$]=n[$]||[]:y,b=_.length,I=h.getUniqueNodes(e),i=null==i||b<=i?b:i,q=_;if(n&&(a=n[v]),c=I.length){if(p._trigger("beforeMoveNode",null,{args:f}),C&&1<c){for(u=I[0],s=(o=(l=h.getParent(u))?l[$]:y).indexOf(u),d=1;d<c;d++)if(o[d+s]!=I[d]){C=!1;break}}for(d=0;d<c;d++)u=I[d],s=(o=(l=h.getParent(u))?l[$]:y).indexOf(u),l==n?i=pq.moveItem(u,q,s,i):(q.splice(i++,0,u),o.splice(s,1)),w.leafIfEmpty&&l&&h.isEmpty(l)&&h.makeLeaf(l),u[m]=a;w.historyMove&&C&&p.iHistory.push({callback:function(i){var r=s;n==l&&g<r&&(r+=1),h.moveNodes(e,i?n:l,i?g:r,!0)}}),x.data=h.flatten(y),p._trigger("moveNode",null,{args:f}),p.refreshView()}},off:function(){var e,n=this.fns,i=this.that;for(e in n)i.off(e,n[e]);this.fns={}},on:function(e,n){return this.fns[e]=n,this.that.on(e,n),this},onCellClick:function(n,i){i.dataIndx==this.dataIndx&&e(n.originalEvent.target).hasClass("pq-group-icon")&&(pq.isCtrl(n)?this[i.rowData.pq_close?"expandAll":"collapseAll"]():this.toggleNode(i.rowData,n))},onBeforeCellKeyDown:function(n,i){var r,o=this.that,a=i.rowData,l=i.dataIndx,n=n.keyCode,s=e.ui.keyCode;if(l==this.dataIndx)return this.isFolder(a)&&(r=a.pq_close,n==s.ENTER&&!o.isEditable({rowIndx:a.pq_ri,dataIndx:l})||!r&&n==s.LEFT||r&&n==s.RIGHT)?(this.toggleNode(a),!1):n==s.SPACE&&(l=o.getCell(i).find("input[type='checkbox']")).length?(l.click(),!1):void 0},hasSummary:function(){var e=this.Model;return e.summary||e.summaryInTitleRow},onChange:function(e,n,i){return function(r,o){var a=o.source||"",l=o.addList.length,o=o.deleteList,s=o.length;-1==a.indexOf("checkbox")&&(("undo"==a||"redo"==a)&&(l||s)?e.refreshViewFull():e.hasSummary()&&i.refreshOnChange&&!l&&!s?(e.refreshSummary(!0),n.refresh()):"addNodes"!=a&&"deleteNodes"!=a||e.refreshViewFull(),i.leafIfEmpty&&o.forEach(function(n){(n=e.getParent(n.rowData))&&e.isEmpty(n)&&e.makeLeaf(n)}))}},clearFolderCheckbox:function(e){var n=this,i=n.cbId;e.forEach(function(e){n.isFolder(e)&&delete e[i]})},onClearFilter:function(e,n){return this.clearFolderCheckbox(n.data),n.data=this.groupById(n.data),!1},onCustomFilter:function(e,n){var i=this.that,r=this.groupById(n.data),i=i.iFilterData,o=n.filters,a=[],l=[],s=n.mode;return this.filter(this.getRoots(r),o,i,s,a,l,n.hideRows),n.dataTmp=this.groupById(a),n.dataUF=l,this.clearFolderCheckbox(n.dataTmp),!1},onDataAvailable:function(){this.initData()},refreshSummary:function(e){this.summaryT(),this.that.iRefresh.addRowIndx(),e&&this.showHideRows()},onDataReadyAfter:function(){var e=this.that.options.dataModel,n=this.Model;!this.hasSummary()||n.filterLockSummary&&n.summaryInTitleRow&&e.dataUF.length||this.refreshSummary(),this.showHideRows(),this.isCascade(n)&&this.cascadeInit()},option:function(n,i){var r=this.that,o=this.Model,a=o.dataIndx;e.extend(o,n),n=o.dataIndx,this.setCellRender(),this.init(),!a&&n&&this.initData(),!1!==i&&r.refreshView()},renderCell:function(e,n){return function(i){var r,o,a,l,s=i.rowData,d=e.that,c=n.indent,u=i.column,h=u.renderLabel||n.render,f=n.iconCollapse,p=n.checkbox,g=e.isFolder(s),m=e._iconCls(s,g,n),v=s.pq_level||0,$=v*c,x=["pq-group-title-cell"],c=["text-indent:",g?$:+c+$,"px;"],$=i.formatVal||i.cellData;return h&&null!=(d=d.callFn(h,i))&&("string"!=typeof d?(d.iconCls&&(m=d.iconCls),null!=d.text&&($=d.text),a=d.attr,x.push(d.cls),c.push(d.style)):$=d),i.Export?e.exportCell($,v):(p&&(h=e.renderCB(p,s,n.cbId))&&(l=h[0],h[1]&&x.push(h[1])),g&&(r="<span class='pq-group-icon ui-icon "+(s.pq_close?f[1]:f[0])+"'></span>"),m&&(o="<span class='pq-tree-icon ui-icon "+m+"'></span>"),d=l&&(u.useLabel||n.useLabel),{cls:x.join(" "),attr:a,style:c.join(""),text:[r,o,d?"<label>":"",l,$,d?"</label>":""].join("")})}},refreshViewFull:function(e){var n=this.that.options.dataModel;n.data=this.groupById(n.data),this.buildCache(),e&&this.refreshView()},_iconCls:function(e,n,i){if(i.icons)return n&&(n=i.iconFolder)?e.pq_close?n[1]:n[0]:e.pq_gsummary?void 0:i.iconFile},setCellRender:function(){var e,n=this.that,i=this.Model,r=n.columns;i.summary&&n.iGroup.refreshColumns(),(n=this.di_prev)&&((e=r[n])&&(e._render=null),this.di_prev=null),(n=i.dataIndx)&&((e=r[n])._render=this.renderCell(this,i),this.di_prev=n)},_showHideRows:function(e,n,i){for(var r,o,a,l,s=this.id,d=this.nodeClose,c=n||this.getRoots(),u=this.childstr,h=i||!1,f=c.length,p=0;p<f;p++)(o=c[p]).pq_filter||(o.pq_hidden=h),(l=o[u])&&(d&&null!=(r=d[a=o[s]])&&(delete d[a],o.pq_close=r),a=h||o.pq_close,this._showHideRows(e,l,a))},showHideRows:function(){var e,n,i,r=this.that,o=0,a=r.get_p_data(),l=this.Model.summary;if(this._showHideRows(a),l)for(n=(a=r.pdata).length;o<n;o++)(i=a[o]).pq_gsummary&&(e=this.getParent(i))&&(i.pq_hidden=e.pq_hidden)},toggleNode:function(e,n){this[e.pq_close?"expandNodes":"collapseNodes"]([e],n)}})}(jQuery),function(){function e(e){e=(this.that=e).options,this.options=e,this.selection=[],this.hclass=" pq-state-select "+(e.bootstrap.on?"":"ui-state-highlight")}var n=jQuery.paramquery,i=n.pqGrid.prototype;n.cRows=e,i.SelectRow=function(){return this.iRows},e.prototype={_add:function(e,n){var i=this.that,r=e.rowIndxPage,n=!n,o=e.rowData,r=this.inViewRow(r);return!o.pq_hidden&&r&&(r=i.getRow(e)).length&&(r[n?"addClass":"removeClass"](this.hclass),n||r.removeAttr("tabindex")),o.pq_rowselect=n,e},_data:function(e){var n=this.that,e=(e=e||{}).all,i=n.riOffset,i=e?0:i,r=n.get_p_data();return[r,i,i+(e?r:n.pdata).length]},add:function(e){var n=e.addList=e.rows||[{rowIndx:e.rowIndx}];e.isFirst&&this.setFirst(n[0].rowIndx),this.update(e)},extend:function(e){var n,i,r,o,a,e=e.rowIndx,l=[],s=this.getFirst();if(null!=s&&null!=(a=this.isSelected({rowIndx:s}))){for(o=e<s?(r=s=(n=e,e=s,n),e-1):(r=s+1,e),i=r;i<=o;i++)l.push({rowIndx:i});this.update(a?{addList:l}:{deleteList:l})}},getFirst:function(){return this._firstR},getSelection:function(){for(var e,n=this.that.get_p_data(),i=0,r=n.length,o=[];i<r;i++)(e=n[i])&&e.pq_rowselect&&o.push({rowIndx:i,rowData:e});return o},inViewCol:function(e){var n=this.that,i=n.options,n=n.iRenderB;return e<i.freezeCols||e>=n.initH&&e<=n.finalH},inViewRow:function(e){var n=this.that,i=n.options,n=n.iRenderB;return e<i.freezeRows||e>=n.initV&&e<=n.finalV},isSelected:function(e){return(e=e.rowData||this.that.getRowData(e))?!0===e.pq_rowselect:null},isSelectedAll:function(e){for(var n,e=this._data(e),i=e[0],r=e[1],o=e[2];r<o;r++)if((n=i[r])&&!n.pq_rowselect)return!1;return!0},removeAll:function(e){this.selectAll(e,!0)},remove:function(e){var n=e.deleteList=e.rows||[{rowIndx:e.rowIndx}];e.isFirst&&this.setFirst(n[0].rowIndx),this.update(e)},replace:function(e){e.deleteList=this.getSelection(),this.add(e)},selectAll:function(e,n){for(var i,r=[],o=this.that.riOffset,e=this._data(e),a=e[0],l=e[1],s=e[2];l<s;l++)(i=a[l])&&r.push({rowIndx:l,rowIndxPage:l-o,rowData:i});this.update(n?{deleteList:r}:{addList:r},!0)},setFirst:function(e){this._firstR=e},toRange:function(){for(var e,n,i=[],r=this.that,o=r.get_p_data(),a=0,l=o.length;a<l;a++)o[a].pq_rowselect?null!=e?n=a:e=n=a:null!=e&&(i.push({r1:e,r2:n}),e=n=null);return null!=e&&i.push({r1:e,r2:n}),r.Range(i)},toggle:function(e){this[this.isSelected(e)?"remove":"add"](e)},toggleAll:function(e){this[this.isSelectedAll(e)?"removeAll":"selectAll"](e)},update:function(e,n){function i(e){return n?e:o.normalizeList(e)}var r=this,o=r.that,a={source:e.source},l=i(e.addList||[]),e=i(e.deleteList||[]),l=l.filter(function(e){return!1===r.isSelected(e)}),e=e.filter(r.isSelected.bind(r));(l.length||e.length)&&(a.addList=l,a.deleteList=e,!1!==o._trigger("beforeRowSelect",null,a)&&(a.addList.forEach(function(e){r._add(e)}),a.deleteList.forEach(function(e){r._add(e,!0)}),o._trigger("rowSelect",null,a)))}}}(),function(e){var n=e.paramquery,i=(e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iImport=new i(n)}),n.pqGrid.prototype.importWb=function(e){return this.iImport.importWb(e)},n.cImport=function(e){this.that=e});i.prototype={fillRows:function(e,n,i){for(var r=e.length;r<n;r++)e.push(i?{}:[])},generateCols:function(e,n,i){var r,o,a=[],l=0,s=0,d=pq.excel.colWidth,i=i?i.cells:[],c=[];for(i.forEach(function(e,n){c[n=e.indx||n]=e.value}),(n=n||[]).forEach(function(e,n){a[s=e.indx||n]=e}),e=Math.max(e,n.length,s+1);l<e;l++)r=a[l]||{},o={_title:c[l]||"",title:this._render,width:r.width||d,style:{},halign:"center"},this.copyStyle(r,o,o.style),r.hidden&&(o.hidden=!0),a[l]=o;return a},_render:function(e){return e.column._title||pq.toLetter(e.colIndx)},importS:function(e,i,r,o,a){var l,s,d,c,u,h,f,p,g,m,v,$,x,w,y=e.mergeCells,C=this,_=[],b={},I=C.that,q=0,R=e.rows||[],D=e.frozenRows||0,M=(R.length,0),T=I.colModel,k=0,S=T&&T.length,E=n.cFormulas.shiftRC();for(null!=a&&(k=a+1,f=R[a],R=R.slice(k),D=0<(D-=k)?D:0),M=0,l=R.length;M<l;M++)d=(s=R[M]).indx||M,p=(c={}).pq_cellprop={},g=c.pq_cellstyle={},m=c.pq_cellattr={},v=c.pq_rowstyle={},$=c.pq_rowprop={},C.copyStyle(s,$,v),d!=M&&C.fillRows(_,d,!0),(s.cells||[]).forEach(function(e,n){u=e.indx||n,c[h=o&&S&&T[u]?T[u].dataIndx:u]=e.value,x=p[h]={},w=g[h]={},C.copyStyle(e,x,w),(x=e.comment)&&(m[h]={title:x}),e.format&&C.copyFormat(c,h,e.format),(w=e.formula)&&C.copyFormula(c,h,k?E(w,0,-k):w),q<=u&&(q=u+1)}),0<=s.htFix&&(c.pq_ht=s.htFix,c.pq_htfix=!0),s.hidden&&(c.pq_hidden=!0),_[d]=c;return b.title=e.name,i&&C.fillRows(_,_.length+i,!0),b.dataModel={data:_},q+=r||0,!o&&q&&(b.colModel=C.generateCols(q,e.columns,f)),b.mergeCells=(y||[]).map(function(e){return e=pq.getAddress(e),e.r1-=k,e.r2-=k,e}).filter(function(e){return 0<=e.r1}),b.freezeRows=D,b.freezeCols=e.frozenCols,b.pics=e.pics,b},copyFormula:function(e,n,i){(e.pq_fn=e.pq_fn||{})[n]=i},copyFormat:function(e,n,i){e=(e=e.pq_cellprop)[n]=e[n]||{},i=pq.isDateFormat(i)?pq.excelToJui(i):pq.excelToNum(i),e.format=i},copyStyle:function(e,n,i){var r,o,a;if((r=e.font)&&(i["font-family"]=r),(r=e.fontSize)&&(i["font-size"]=r+"px"),(r=e.color)&&(i.color=r),(r=e.bgColor)&&(i["background-color"]=r),null!=(r=e.bold)&&(i["font-weight"]=r?"bold":"normal"),e.italic&&(i["font-style"]="italic"),e.underline&&(i["text-decoration"]="underline"),e.wrap&&(i["white-space"]="normal"),(r=e.align)&&(n.align=r),(r=e.valign)&&(n.valign=r),r=e.border)for(o in r)a=r[o],i["border-"+o]=a},applyOptions:function(e,n){var i=e.options.dataModel,r=n.dataModel;if(r){for(var o in r)i[o]=r[o];delete n.dataModel}e.option(n)},importWb:function(e){function n(n){return o.importS(n,e.extraRows,e.extraCols,e.keepCM,e.headerRowIndx)}function i(e){o.applyOptions(a,e)}var r=e.workbook,o=(r.activeId,this),a=o.that,l=e.sheet,l=l||0;(r=r.sheets.filter(function(e,n){return l==n||l&&l==e.name})[0])&&i(n(r)),a._trigger("importWb"),a.refreshDataAndView()}}}(jQuery),function(e){var n;pq.excelImport={attr:(n=RegExp('([a-z]+)\\s*=\\s*"([^"]*)"',"gi"),function(e){e=(e=e||"").slice(0,e.indexOf(">"));var i={};return e.replace(n,function(e,n,r){i[n]=r}),i}),getComment:function(n){var i=this,r={},n=i.pxml("xl/worksheets/_rels/sheet"+n+".xml.rels");return n.length&&(n=e(n.find('Relationship[Type*="/comments"]')[0]).attr("Target"))&&(n=n.split("/").pop(),(i.getFileText("xl/"+n).match(/<comment\s+[^>]*>([\s\S]*?)<\/comment>/g)||[]).forEach(function(n){var o=i.attr(n).ref,n=n.match(/<t(\s+[^>]*)?>([\s\S]*?)(?=<\/t>)/g),n=i.match(n[n.length-1],/[^>]*>([\s\S]*)/,1);r[o]=e.trim(n)})),r},getBase64:function(e){return"data:image/png;base64,"+JSZip.base64.encode(e.asBinary())},pxml:function(n){return e(e.parseXML(this.getFileText(n)))},pxmlstr:function(n){return e(e.parseXML(e.trim(n)))},getPic:function(n,i){var r,o=[],a=this.files,n=this.match(n,/<drawing\s+r:id=\"([^\"]*)\"(\s*)\/>/i,1);if(n){var l,s,d,i=this.pxml("xl/worksheets/_rels/sheet"+i+".xml.rels"),i=(i=e(i.find('Relationship[Id="'+n+'"]')[0]).attr("Target")).split("/").pop(),c={},u={},n=this.pxml("xl/drawings/"+i),i=this.pxml("xl/drawings/_rels/"+i+".rels"),h=["col","colOff","row","rowOff"];for(r in i.find("Relationship[Type*='/image']").each(function(n,i){c[(s=e(i)).attr("Id")]=s.attr("Target").match(/media\/(.*)/)[1]}),a)/media\/.*/.test(r)&&(u[l=r.match(/media\/(.*)/)[1]]=this.getBase64(a[r]));n.find("xdr\\:twoCellAnchor,xdr\\:oneCellAnchor").each(function(n,i){var i=e(i),r=i.find("xdr\\:cNvPr"),a=r.attr("descr"),r=r.attr("id"),l=i.find("a\\:blip").attr("r:embed"),l=c[l],s=i.find("xdr\\:from"),f=i.find("xdr\\:to"),i=i.find("xdr\\:ext"),p=f.length,g=[],m=p?[]:null;h.forEach(function(e,n){d=n%2?9500:1,g.push(s.find("xdr\\:"+e).text()/d),p&&m.push(f.find("xdr\\:"+e).text()/d)}),o.push({id:r,name:a,src:u[l],from:g,to:m,cx:p?0:i.attr("cx")/9500,cy:p?0:i.attr("cy")/9500})})}return o},cacheTheme:function(){var n=this.pxmlstr(this.getFileTextFromKey("th")).find("a\\:clrScheme").children(),i=this.themeColor=[];n.each(function(n,r){r=e(r).children().attr("val"),i[n]=r})},cacheStyles:function(){var n,i,r,o=this,a=o.pxmlstr(o.getStyleText()),l=e.extend(!0,{},o.preDefFormats),s=[],d=[""],c=["",""],u=[];a.find("numFmts>numFmt").each(function(n,i){var i=e(i),r=i.attr("formatCode");l[i.attr("numFmtId")]=r}),a.find("fills>fill>patternFill>fgColor[rgb]").each(function(n,i){i=o.getColor(e(i).attr("rgb")),c.push(i)}),a.find("borders>border").each(function(n,i){var i=e(i).children(),r={},a="double";i.each(function(n,i){var l=e(i),s=l.children(),d=s.attr("theme"),d=d?"00"+o.themeColor[d]:0;s.length&&(l=l.attr("style"),r[i.tagName]=(l==a?"3px":"1px")+" "+(l==a?a:"solid")+" "+o.getColor(s.attr("rgb")||d||"00000000"))}),u.push(r)}),a.find("fonts>font").each(function(r,a){var a=e(a),l=+a.find("sz").attr("val"),s=a.find("name").attr("val"),c=a.find("color").attr("rgb"),u={};if(0===r)return n=l,void(i=s.toUpperCase());a.find("b").length&&(u.bold=!0),c&&(u.color=o.getColor(c)),s&&s.toUpperCase()!=i&&(u.font=s),l&&l!=n&&(u.fontSize=l),a.find("u").length&&(u.underline=!0),a.find("i").length&&(u.italic=!0),d.push(u)}),a.find("cellXfs>xf").each(function(n,i){var o,i=e(i),a=+i.attr("numFmtId"),h=+i.attr("fillId"),f=+i.attr("borderId"),p=i.children("alignment"),i=+i.attr("fontId"),g=i?d[i]:{},m={};for(o in p.length&&((i=p.attr("horizontal"))&&(m.align=i),(i=p.attr("vertical"))&&(m.valign=i),"1"==p.attr("wrapText")&&(m.wrap=!0)),a&&(r=l[a],/(?=.*m.*)(?=.*d.*)(?=.*y.*)/i.test(r)&&(r=r.replace(/(\[.*\]|[^mdy\/\-\s])/gi,"")),m.format=r),f&&(m.border=u[f]),h&&c[h]&&(m.bgColor=c[h]),g)m[o]=g[o];s.push(m)}),o.getStyle=function(e){return s[e]}},getMergeCells:function(e){var n=this;return(e.match(/<mergeCell\s+.*?(\/>|<\/mergeCell>)/g)||[]).map(function(e){return n.attr(e).ref})},getFrozen:function(e){var e=this.match(e,/<pane.*?(\/>|<\/pane>)/,0),e=this.attr(e),n=+e.xSplit;return{r:+e.ySplit||0,c:n||0}},getFormula:function(n){var i={},r=e.paramquery.cFormulas.shiftRC();return function(e,o,a){var l;if("<f"===e.substr(0,2))return l=n.match(e,/^<f.*?>(.*?)<\/f>/,1),"shared"==(e=n.attr(e)).t&&(l?i[e.si]={r:o,c:a,f:l}:l=r((e=i[e.si]).f,a-e.c,o-e.r)),l}},getCols:function(e){for(var n=(e.match(/<dimension\s.*?\/>/)||[])[0],n=this.attr(n||"").ref,i=[],r=e.match(/<col\s.*?\/>/g)||[],o=n?pq.getAddress(n).c2+1:r.length,a=pq.excel.colRatio,l=0;l<o;l++)for(var s,d,c=r[l],c=this.attr(c),u=+c.min,h=+c.max,f=+c.hidden,p=+c.width,c=c.style,g=c?this.getStyle(c):{},m=u;m<=h;m++){for(d in s={},f?s.hidden=!0:s.width=+(p*a).toFixed(2),m!==i.length+1&&(s.indx=m-1),g)s[d]=g[d];i.push(s)}return i},getColor:function(e){return"#"+e.slice(2)},getPath:function(e){return this.paths[e]},getPathSheets:function(){return this.pathSheets},getFileTextFromKey:function(e){return this.getFileText(this.getPath(e))},getFileText:function(e){return e&&(e=this.files[e.replace(/^\//,"")])?e.asText().replace(/\<x\:/g,"<").replace(/\<\/x\:/g,"</"):""},getSheetText:function(e){e=e||0;var n=this.pathSheets.filter(function(n,i){return n.name===e||i===e})[0].path;return this.getFileText(n)},getStyleText:function(){return this.getFileTextFromKey("st")},getSI:function(e){var n,i=[],r=pq.unescapeXml,o=+this.attr(this.match(e,/<sst.*?>[\s\S]*?<\/sst>/,0)).uniqueCount;if(e.replace(/<si>([\s\S]*?)<\/si>/g,function(e,o){n=[],o.replace(/<t.*?>([\s\S]*?)<\/t>/g,function(e,i){n.push(i)}),i.push(r(n.join("")))}),o&&o!==i.length)throw"si misatch";return i},getCsv:function(e,n){var i=[],r=Math.random()+"";return e=e.replace("\uFEFF","").replace(/(?:^|[^"]+)"(([^"]|"{2})+)"(?=([^"]+|$))/g,function(e,n){var o=e.indexOf(n);return i.push(n.replace(/""/g,'"')),e.slice(0,o-1)+r+(i.length-1)+r}),n=n||RegExp(-1==e.indexOf("	")?",":"	","g"),{sheets:[{rows:e.split(/\r\n|\r|\n/g).map(function(e){return{cells:e.split(n).map(function(e){var n;return 0==e.indexOf(r)?e=i[n=e.slice(r.length,e.indexOf(r,1))]:'""'===e&&(e=""),{value:e}})}})}]}},getWorkBook:function(e,n,i){var r=this,o={},n=(n?o[n]=!0:"string"==typeof e&&(o.base64=!0),r.files=new JSZip(e,o).files,r.readPaths(),r.cacheTheme(),r.cacheStyles(),this.getPath("ss")),a=[],l=n?this.getSI(this.getFileText(n)):[];return r.getPathSheets().forEach(function(e,n){var o,s;(!i||-1<i.indexOf(n)||-1<i.indexOf(e.name))&&(s=r.getFileText(e.path),o=r.match(s,/<sheetData.*?>([\s\S]*?)<\/sheetData>/,1),s=r.getWorkSheet(s,o,l,e.name,n+1),e.hidden&&(s.hidden=!0),a.push(s))}),delete r.files,{sheets:a,activeId:r.activeId}},getWorkSheet:function(e,n,i,r,o){var a,l,s,d,c,u,h,f,p,g,m,v,$,x,w,y,C=this,_=C.getComment(o),b=[],I=pq.toNumber,q=C.getFormula(C),R=pq.formulas,D=pq.isDateFormat,M=C.getMergeCells(e),T=n.match(/<row[^<]*?\/>|<row.*?<\/row>/g)||[],n=C.getCols(e),k={},S=0,E=T.length;for(n.forEach(function(e,n){k[e.indx||n]=e});S<E;S++){for(a in s={cells:[]},v=T[S],x=(f=C.attr(v)).r,f.customHeight&&(s.htFix=1.5*f.ht),w=(d=f.s)?C.getStyle(d):{})s[a]=w[a];($=x?x-1:S)!==S&&(s.indx=$),f.hidden&&(s.hidden=!0);for(var P,A=0,H=(P=v.match(/(<c[^<]*?\/>|<c.*?<\/c>)/g)||[]).length;A<H;A++){if(h=P[A],c=(p=C.attr(h)).t,h=C.match(h,/<c.*?>(.*?)(<\/c>)?$/,1),l={},"inlineStr"==c?y=(y=h.match(/<t><!\[CDATA\[(.*?)\]\]><\/t>/))?y[1]:(y=h.match(/<t>(.*?)<\/t>/),pq.unescapeXml(y[1])):null!=(y=C.match(h,/<v>(.*?)<\/v>/,1)||void 0)&&(y="s"==c?i[y]:"str"==c?pq.unescapeXml(y):"b"==c?"1"==y:R.VALUE(y)),(c=p.r)?u=I(u=c.replace(/\d+/,"")):(u=A,c=pq.toLetter(u)+($+1)),_[c]&&(l.comment=_[c]),void 0!==y&&(l.value=y),u!==A&&(l.indx=u),(c=q(h,$,u))&&(l.formula=pq.unescapeXml(c)),d=p.s,m=k[u],d=d&&this.getStyle(d)){for(a in d)g=d[a],m&&m[a]==g||s[a]!=g&&(l[a]=g);h=l.format,null!=y&&!c&&h&&D(h)&&(l.value=R.TEXT(y,"m/d/yyyy"))}["bold","underline","italic"].forEach(function(e){null!=d&&null!=d[e]||((m||{})[e]||s[e])&&(l[e]=!1)}),s.cells.push(l)}b.push(s)}return r={rows:b,name:r,pics:C.getPic(e,o)},o=C.getFrozen(e),M.length&&(r.mergeCells=M),n.length&&(r.columns=n),o.r&&(r.frozenRows=o.r),o.c&&(r.frozenCols=o.c),r},Import:function(e,n){function i(i,o){n(r[s?"getCsv":"getWorkBook"](i,s?e.separator:e.type||o,e.sheets))}var r=this,o=e.file,a=e.content,l=e.url,s="csv"==(l||(o||{}).name||"").slice(-3).toLowerCase()||e.csv;l?(l+="?"+Math.random(),window.Uint8Array?pq.xmlhttp(l,s?"text":"arraybuffer",i):JSZipUtils.getBinaryContent(l,function(e,n){i(n,"binary")})):o?pq.fileRead(o,s?"readAsText":"readAsArrayBuffer",i):a&&i(a)},match:function(e,n,i){return(e=e.match(n))?e[i]:""},preDefFormats:{1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",5:"$#,##0_);($#,##0)",6:"$#,##0_);[Red]($#,##0)",7:"$#,##0.00_);($#,##0.00)",8:"$#,##0.00_);[Red]($#,##0.00)",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yyyy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yyyy h:mm",37:"#,##0_);(#,##0)",38:"#,##0_);[Red](#,##0)",39:"#,##0.00_);(#,##0.00)",40:"#,##0.00_);[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mm:ss.0",48:"##0.0E+0",49:"@"},readPaths:function(){var n,i=this.files,r=this.pxmlstr(i["[Content_Types].xml"].asText()),o=this.paths={wb:"sheet.main",ws:"worksheet",st:"styles",ss:"sharedStrings",th:"theme"};for(n in o)o[n]=r.find('[ContentType$="'+o[n]+'+xml"]').attr("PartName");for(n in i)if(/workbook.xml.rels$/.test(n)){o.wbrels=n;break}var a=e(this.getFileTextFromKey("wbrels")),i=e(this.getFileTextFromKey("wb")),l=this.pathSheets=[];this.activeId=+i.find("workbookView").attr("activeTab")||null,i.find("sheet").each(function(n,i){var i=e(i),o=i.attr("r:id"),s=i.attr("name"),d=a.find('[Id="'+o+'"]').attr("Target"),d=r.find('Override[PartName$="'+d+'"]').attr("PartName");l.push({name:s,rId:o,path:d,hidden:"hidden"==i.attr("state")})})}}}(jQuery),function(e){var n=e.paramquery,i=n._pqGrid.prototype,r=(i.exportExcel=function(e){return(e=e||{}).format="xlsx",this.exportData(e)},i.exportCsv=function(e){return(e=e||{}).format="csv",this.exportData(e)},i.exportData=function(e){return new r(this,e).Export(e)},n.cExport=function(e){this.that=e});r.prototype=e.extend({copyStyle:function(e,n,i,r,o){var a,l;function s(e){var i=n[e];if(i&&r[e]!=i)return i}function d(e){var n=i[e];if(n&&o[e]!=n)return n}r=r||{},o=o||{},n&&(n=pq.styleObj(n),(a=s("background-color"))&&(e.bgColor=a),(a=s("font-size"))&&(e.fontSize=parseFloat(a)),(a=s("color"))&&(e.color=a),(a=s("font-family"))&&(e.font=a),(a=s("font-weight"))&&(e.bold="bold"==a),(a=s("white-space"))&&(e.wrap="normal"==a),(a=s("font-style"))&&(e.italic="italic"==a),(a=s("text-decoration"))&&(e.underline="underline"==a),l=s("border"),["left","right","top","bottom"].forEach(function(n){var i;((i=s("border-"+n))||(i=l))&&((e.border=e.border||{})[n]=i)})),i&&((a=d("align"))&&(e.align=a),(a=d("valign"))&&(e.valign=a))},getCsvHeader:function(e,n,i,r){for(var o,a,l=[],s=[],d=0;d<n;d++){for(var c=e[d],u=null,h=0,f=c.length;h<f;h++)(o=i[h]).hidden||!1===o.copy||(o=c[h],0<d&&o==e[d-1][h]||u&&0<h&&o==u?l.push(""):(a=null==(a=this.getTitle(o,h))?"":(a+"").replace(/\"/g,'""'),u=o,l.push('"'+a+'"')));s.push(l.join(r)),l=[]}return s},getCSVContent:function(e,n,i,r,o,a,l,s,d,c,u,h,f){for(var p,g=e.separator||",",m=[],v=f?this.getCsvHeader(r,o,n,g):[],$=0;$<l;$++)if(!(p=a[$]).pq_hidden){for(var x,w,y,C={rowIndx:x=s?$+d:$,rowIndxPage:x-d,rowData:p,Export:!0},_=0;_<i;_++)(y=n[_]).hidden||!1===y.copy||(y=(y=((w=null)==(w=c.ismergedCell(x,_)?c.isRootCell(x,_)?((w=c.getRootCellO(x,_)).Export=!0,this.getRenderVal(w,u,h)[0]):"":(C.colIndx=_,C.column=y,C.dataIndx=y.dataIndx,this.getRenderVal(C,u,h)[0]))?"":w)+"").replace(/\"/g,'""'),m.push('"'+y+'"'));v.push(m.join(g)),m=[]}return"\uFEFF"+v.join("\n")},getExportCM:function(e,n){return 1<n?e:e.filter(function(e){return 0!=e.copy})},Export:function(e){var n=this.that,i={sheets:[]};return!1!==n._trigger("beforeExport",null,e)&&("xlsx"==e.format?(i=this._Export(e),!1===n._trigger("workbookReady",null,{workbook:i})||e.workbook||(e.workbook=i,i=pq.excel.exportWb(e)||this.postRequest(e),n._trigger("exportData",null,e)),i):this._Export(e))},_Export:function(e){var n=this.that,i=n.options,r=i.groupModel,o="remote"==i.pageModel.type,a=n.riOffset,l=n.iRenderB,s=n.iMerge,d=n.headerCells,c=d.length,u=n.colModel,h=u.length,f=this.getExportCM(u,c),p=f.length,g=i.treeModel,r=r.on&&r.dataIndx.length||o||g.dataIndx&&g.summary?n.pdata:i.dataModel.data,g=(r=i.summaryData?r.concat(i.summaryData):r).length,i=e.render,m=!e.noheader,v=e.format;return"xlsx"==v?this.getWorkbook(f,p,d,c,r,g,o,a,s,i,l,m,e.sheetName):(e.data="json"==v?this.getJsonContent(e,r):"csv"==v?this.getCSVContent(e,u,h,d,c,r,g,o,a,s,i,l,m):this.getHtmlContent(e,u,h,d,c,r,g,o,a,s,i,l,m),f=this.postRequest(e),n._trigger("exportData",null,e),f)},getHtmlHeader:function(e,n){for(var i,r,o,a,l=["<thead>"],s=0;s<n;s++){var d=e[s],c=null;l.push("<tr>");for(var u=0,h=d.length;u<h;u++)i=(a=d[u]).colSpan,!a.hidden&&i&&!1!==a.copy&&(r=a.rowSpan,0<s&&a==e[s-1][u]||c&&0<u&&a==c||(o=this.getTitle(a,u),a=(c=a).halign||a.align,l.push("<th colspan=",i," rowspan=",r," ",a=a?"align="+a:"",">",o,"</th>")));l.push("</tr>")}return l.push("</thead>"),l.join("")},getHtmlBody:function(e,n,i,r,o,a,l,s,d){for(var c,u,h,f,p,g,m,v,$,x,w,y=[],C=0;C<r;C++)if(!(m=i[C]).pq_hidden){for(g={rowIndx:v=o?C+a:C,rowIndxPage:v-a,rowData:m,Export:!0},y.push("<tr>"),c=0;c<n;c++)if(!(u=e[c]).hidden&&!1!==u.copy){if(w=null,x="",l.ismergedCell(v,c)){if(!(h=l.isRootCell(v,c)))continue;(w=l.getRootCellO(v,c)).Export=!0,$=(f=this.getRenderVal(w,s,d))[0],p=f[1],x="rowspan="+h.rowspan+" colspan="+h.colspan+" "}else g.colIndx=c,g.column=u,g.dataIndx=u.dataIndx,$=(f=this.getRenderVal(g,s,d))[0],p=f[1];x+=(w=u.align)?"align="+w:"",$=pq.newLine($=null==$?"":$),y.push("<td ",x,p?' style="'+p+'"':"",">",$,"</td>")}y.push("</tr>")}return y.join("")},getHtmlContent:function(e,n,i,r,o,a,l,s,d,c,u,h,f){var p=this.that,g=p.options.rtl,m=e.cssRules||"",p=p.element.find(".pq-grid-table"),v=p.css("font-family"),p=p.css("font-size"),$=[];return $.push("<!DOCTYPE html><html><head>",'<meta charset="utf-8" />',"<title>",e.title||"ParamQuery Pro","</title>","</head><body ",g?'dir="rtl"':""," >","<style>","table{empty-cells:show;font-family:"+v+";font-size:"+p+";border-collapse:collapse;}","td,th{padding: 5px;border:1px solid #ccc;}",m,"</style>","<table>"),$.push(f?this.getHtmlHeader(r,o,n):""),$.push(this.getHtmlBody(n,i,a,l,s,d,c,u,h)),$.push("</table></body></html>"),$.join("")},getJsonContent:function(e,n){return e.nostringify?n:JSON.stringify(n,e.nopqdata?function(e,n){if(0!==(e+"").indexOf("pq_"))return n}:null,e.nopretty?null:2)},getXlsMergeCells:function(e,n,i,r){e=e.concat(i.getMergeCells(n,this.curPage,r));for(var o=[],a=pq.toLetter,l=e.length,s=0;s<l;s++){var d=a((d=e[s]).c1)+(d.r1+1)+":"+a(d.c2)+(d.r2+1);o.push(d)}return o},getXlsCols:function(e,n){for(var i,r,o,a=[],l=0,s=pq.excel.colWidth;l<n;l++)o=+((r=e[l])._width||s).toFixed(2),this.copyStyle(i={},r.style,r),o!==s&&(i.width=o),r.hidden&&(i.hidden=!0),pq.isEmpty(i)||(a.length!==l&&(i.indx=l),a.push(i));return a},getXlsHeader:function(e,n,i){for(var r=[],o=0;o<n;o++){for(var a=e[o],l=[],s=0,d=a.length;s<d;s++){var c,u,h,f=a[s];!1!==f.copy&&(c=f.o_colspan,u=f.rowSpan,h=this.getTitle(f,s),0<o&&f==e[o-1][s]||0<s&&f==e[o][s-1]?h="":(1<c||1<u)&&i.push({r1:o,c1:s,r2:o+u-1,c2:s+c-1}),l.push({value:h,bgColor:"#eeeeee"}))}r.push({cells:l})}return r},getXlsBody:function(i,r,o,a,l,s,d,c,u,h,f){for(var p,g,m,v,$,x,w,y,C,_,b,I,q,R,D,M,T,k,S,E,P,A,H,F,O=this.that,V=O.options,L=[],N=n.cFormulas.shiftRC(O),B=0;B<a;B++){for(T=(C=o[B]).pq_cellattr,E=C.pq_cellprop||{},R=C.pq_rowprop||{},A=C.pq_cellstyle||{},y=[],v={rowIndx:_=l?B+s:B,rowIndxPage:_-s,rowData:C,Export:!0},p=0;p<r;p++)I=(F=i[p]).style,H=A[b=(q=F).dataIndx],P=E[b]||{},g=k=C[b],m=O.getFormula(C,b),M=!1,(M=!(!d.ismergedCell(_,p)||d.isRootCell(_,p,"o"))||M)||m||(v.colIndx=p,v.column=F,v.dataIndx=b,g=(M=this.getRenderVal(v,c,u))[0],$=M[1],w=M[2],x=M[3]),M={},"string"==typeof(F=V.format.call(O,C,F,P,R))&&(F=pq.isDateFormat(F)?(g!==k&&e.datepicker.formatDate(F,new Date(k))===g&&(g=k),pq.juiToExcel(F)):(g!==k&&pq.formatNumber(k,F)===g&&(g=k),pq.numToExcel(F)),M.format=F),void 0!==g&&(M.value=g),T&&(k=T[b])&&((S=k.title)&&(M.comment=S),(S=k.style)&&this.copyStyle(M,S)),this.copyStyle(M,H,P,I,q),this.copyStyle(M,$,w,I,q),x&&(M.comment=x),m&&(h&&(m=N(m,0,h)),M.formula=m),pq.isEmpty(M)||(M.dataIndx=b,y.length!==p&&(M.indx=p),y.push(M));D={},y.length&&(D.cells=y),C.pq_hidden&&(D.hidden=!0),C.pq_htfix&&(D.htFix=C.pq_ht),this.copyStyle(D,C.pq_rowstyle,R),f&&(S=(f.call(O,v)||{}).style)&&this.copyStyle(D,S),pq.isEmpty(D)||(L.length!==B&&(D.indx=B),L.push(D))}return L},getWorkbook:function(e,n,i,r,o,a,l,s,d,c,u,h,f){var p=this.getXlsCols(e,n),g=[],m=this.that,v=m.options,$=v.freezeCols,x=h?r:0,w=x+(v.freezeRows||0),i=h?this.getXlsHeader(i,r,g):[],g=this.getXlsMergeCells(g,h?r:0,d,a),h=this.getXlsBody(e,n,o,a,l,s,d,c,u,x,v.rowInit),r={columns:p,rows:i.concat(h)};return v.rtl&&(r.rtl=!0),g.length&&(r.mergeCells=g),(e=i.length)&&(r.headerRows=e),w&&(r.frozenRows=w),$&&(r.frozenCols=$),(f=f||v.title)&&(r.name=f),r.pics=m.iPic.pics,{sheets:[r]}},postRequest:function(n){var i,r,o=n.format,a=n.url,l=n.filename||"pqGrid";return n.zip&&"xlsx"!=o?((r=new JSZip).file(l+"."+n.format,n.data),r=r.generate({type:"base64",compression:"DEFLATE"}),i=!0,o="zip"):(i=!!n.decodeBase,r=n.data),a&&e.ajax({url:a,type:"POST",cache:!1,data:{pq_ext:o,pq_data:r,pq_decode:i,pq_filename:l},success:function(n){a=a+(0<a.indexOf("?")?"&":"?")+"pq_filename="+n,e(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+a+'"></iframe>')}}),r}},pq.mixin.render)}(jQuery),function(e){var n,i=pq.excel={_tmpl:{rels:'<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships"><Relationship Id="rId1" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument" Target="xl/workbook.xml"/></Relationships>'},eachRow:function(e,n){for(var i=e.rows,r=0,o=i.length;r<o;r++)n(i[r],r)},exportWb:function(e){var n=e.workbook,i=e.replace,r=this,o=r._tmpl,a=n.sheets,l=a.length,s=[],d=[],c=new JSZip,u={},h=c.folder("xl");return c.file("_rels/.rels",o.rels),c.file("xl/_rels/workbook.xml.rels",r.getWBookRels(l)),a.forEach(function(e,n){var o,a=r.getCols(e.columns),l=e.pics||[],c=l.length,n=n+1,f=r.getFrozen(e.frozenRows,e.frozenCols,e.rtl),p=r.getBody(e.rows||[],e.columns||[]),e=r.getMergeCells(e.mergeCells);i&&(p=p.replace.apply(p,i)),o=r.comments,o=!pq.isEmpty(o),h.file("worksheets/sheet"+n+".xml",r.getSheet(f,a,p,e,o,c,n)),o&&(s.push(n),h.file("comments"+n+".xml",r.getComment()),h.file("drawings/vmlDrawing"+n+".vml",r.getVml())),c&&(r.addPics(h,l,n),l.forEach(function(e){u[e.name.split(["."])[1]]=1}),d.push(n)),(o||c)&&h.file("worksheets/_rels/sheet"+n+".xml.rels",r.getSheetRel(n,o,c))}),c.file("[Content_Types].xml",r.getContentTypes(l,s,d,u)),h.file("workbook.xml",r.getWBook(a,n.activeId)),h.file("styles.xml",r.getStyle()),e.url?(e.data=c.generate({type:"base64",compression:"DEFLATE"}),e.decodeBase=!0,pq.postRequest(e)):c.generate({type:e.type||"blob",compression:"DEFLATE"})},addPics:function(e,n,i){var r,o,a,l,s;n.length&&(r=['<xdr:wsDr xmlns:xdr="http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing" xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns:c="http://schemas.openxmlformats.org/drawingml/2006/chart" xmlns:cx="http://schemas.microsoft.com/office/drawing/2014/chartex" xmlns:cx1="http://schemas.microsoft.com/office/drawing/2015/9/8/chartex" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:dgm="http://schemas.openxmlformats.org/drawingml/2006/diagram" xmlns:x3Unk="http://schemas.microsoft.com/office/drawing/2010/slicer" xmlns:sle15="http://schemas.microsoft.com/office/drawing/2012/slicer">'],o=['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'],a=1,l=parseInt,s=function(e){return["<xdr:col>",e[0],"</xdr:col><xdr:colOff>",l(9500*e[1]),"</xdr:colOff><xdr:row>",e[2],"</xdr:row><xdr:rowOff>",l(9500*e[3]),"</xdr:rowOff>"].join("")},n.forEach(function(n,i){var d=n.from,c=n.name,u="rId"+a++,h=n.to,f=h&&!!h.length,p=f?"two":"one",g=l(9500*n.cx),m=l(9500*n.cy);r.push("<xdr:",p,"CellAnchor>","<xdr:from>",s(d),"</xdr:from>",f?"<xdr:to>"+s(h)+"</xdr:to>":'<xdr:ext cx="'+g+'" cy="'+m+'"/>','<xdr:pic><xdr:nvPicPr><xdr:cNvPr id="',n.id,'" name="Picture ',i+1,'" descr="',c,'"/>','<xdr:cNvPicPr preferRelativeResize="0"/></xdr:nvPicPr>','<xdr:blipFill><a:blip cstate="print" r:embed="',u,'"/><a:stretch><a:fillRect/></a:stretch></xdr:blipFill>','<xdr:spPr><a:prstGeom prst="rect"><a:avLst/></a:prstGeom><a:noFill/></xdr:spPr>','</xdr:pic><xdr:clientData fLocksWithSheet="0"/></xdr:',p,"CellAnchor>"),o.push('<Relationship Id="',u,'" Target="../media/',c,'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/image" />'),e.file("media/"+c,n.src.split(",")[1],{base64:!0})}),r.push("</xdr:wsDr>"),o.push("</Relationships>"),e.file("drawings/drawing"+i+".xml",r.join("")),e.file("drawings/_rels/drawing"+i+".xml.rels",o.join("")))},eachCell:function(e,n,i){e.forEach(function(e,r){var o,a;if(o=e.cells){r=e.indx||r;for(var l=0,s=o.length;l<s;l++)n(a=o[l],a.indx||l,r,i)}else(o=e.rows)&&this.eachCell(o,n,r)},this)},findIndex:function(e,n){return e[n=e.findIndex(n)].indx||n},getArray:function(e){var n=[],i=this;return this.eachRow(e,function(e){var r=[];e.cells.forEach(function(e){r.push(i.getCell(e))}),n.push(r)}),n},getBody:function(n,i){var r,o,a,l,s,d,c,u,h,f,p,g,m,v,$,x,w,y,C,_={},b=pq.formulas,I=[],q=this.comments={},R=n.length;for((i||[]).forEach(function(e,n){_[e.indx||n]=e}),o=0;o<R;o++){for($=(g=(v=n[o]).cells||[]).length,x=v.hidden?'hidden="1" ':"",w=v.htFix?'customHeight="1" ht="'+v.htFix/1.5+'" ':"",d='r="'+(l=(v.indx||o)+1)+'"',u=this.getStyleIndx(v),I.push("<row "+x+w+d+(u=u?' s="'+u+'" customFormat="1"':"")+">"),a=0;a<$;a++)m=(p=g[a]).value,s=p.indx||a,u=c="",y=_[s]||{},d=s===a?"":'r="'+pq.toLetter(s)+l+'"',y=e.extend({},y,v,p),r="@"!=(C=p.format),f=(f=p.formula)?"<f>"+pq.escapeXml(f)+"</f>":"",null==m?h="<v></v>":r&&"boolean"==typeof m?(h="<v>"+(m?"1":"0")+"</v>",c='t="b"'):h=r&&m==+m&&(m+"").length==(+m+"").length?"<v>"+m+"</v>":r&&C&&b.isDate(m)?"<v>"+b.VALUE(m)+"</v>":(c='t="inlineStr"',"<is><t>"+pq.escapeXml(m)+"</t></is>"),u=(u=this.getStyleIndx(y))?'s="'+u+'"':"",(r=p.comment)&&(q[pq.toLetter(s)+l]=r),I.push("<c "+c+" "+d+" "+u+">"+f+h+"</c>");I.push("</row>")}return I.join("")},getCell:function(e){var n=e.format,e=e.value;return n?pq.formulas.TEXT(e,n):e},getCSV:function(e){var n=[],i=this;return this.eachRow(e,function(e){var r=[];e.cells.forEach(function(e){r.push(i.getCell(e))}),n.push(r.join(","))}),n.join("\r\n")},getColor:(n={},function(e){var i,o,a=n[e];if(a||(/^#[0-9,a,b,c,d,e,f]{6}$/i.test(e)?o=e.replace("#",""):(i=e.match(/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/i))&&(o=r((+i[1]).toString(16))+r((+i[2]).toString(16))+r((+i[3]).toString(16))),o&&6===o.length&&(a=n[e]="ff"+o)),a)return a;throw"invalid color: "+e}),_getCol:function(e,n,i,r,o,a){a=a?' style="'+a+'"':"",r&&!o||(o=' customWidth="1" width="'+(o=+((o=o||this.colWidth)/this.colRatio).toFixed(2))+'"'),e.push('<col min="',n,'" max="',i,'" hidden="',r,'"',o,a,"/>")},getCols:function(e){if(!e||!e.length)return"";var n,i,r,o,a,l,s=[],d=0,c=0,u=0,h=e.length;for(s.push("<cols>");u<h;u++){var f=e[u],p=f.hidden?1:0,g=f.width,m=this.getStyleIndx(f),d=(f.indx||d)+1;r===g&&o===p&&m==a&&d==c+1?i=d:(l&&(this._getCol(s,n,i,o,r,a),n=null),i=d,null==n&&(n=d)),r=g,o=p,a=m,c=d,l=!0}return this._getCol(s,n,i,o,r,a),s.push("</cols>"),s.join("")},getComment:function(){var e,n=[],i=this.comments;for(e in i)n.push('<comment authorId="0" ref="',e,'"><text><t xml:space="preserve">',i[e].replace(/</g,"&lt;").replace(/>/g,"&gt;"),"</t></text></comment>");return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<comments xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships" xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',"<authors><author></author></authors>","<commentList>",n.join(""),"</commentList></comments>"].join("")},getContentTypes:function(e,n,i,r){for(var o,a=[],l=1,s=[],d=[];l<=e;l++)a.push('<Override PartName="/xl/worksheets/sheet'+l+'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"/>');for(o in n.forEach(function(e){s.push('<Override PartName="/xl/comments',e,'.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml" />')}),r)d.push('<Default Extension="'+o+'" ContentType="image/'+o+'" />');return i.forEach(function(e){d.push('<Override PartName="/xl/drawings/drawing',e,'.xml" ContentType="application/vnd.openxmlformats-officedocument.drawing+xml"/>')}),['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<Types xmlns="http://schemas.openxmlformats.org/package/2006/content-types">','<Override PartName="/xl/styles.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"/>','<Default Extension="rels" ContentType="application/vnd.openxmlformats-package.relationships+xml"/>','<Default Extension="xml" ContentType="application/xml" />','<Override PartName="/xl/workbook.xml" ContentType="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"/>',a.join(""),'<Default Extension="vml" ContentType="application/vnd.openxmlformats-officedocument.vmlDrawing" />',s.join(""),d.join(""),"</Types>"].join("")},getFillIndx:function(e){var n=this.fills=this.fills||{length:2};return this.getIndx(n,e)},getBorderIndx:function(e){var n=this.borders=this.borders||{length:1};return this.getIndx(n,JSON.stringify(e))},getFontIndx:function(e,n,i,r,o,a){var l=this.fonts=this.fonts||{length:1};return this.getIndx(l,(e||"")+"_"+(n||"")+"_"+(i||"")+"_"+(r||"")+"_"+(o||"")+"_"+(a||""))},getFormatIndx:function(e){var n=this.formats=this.formats||{length:164};return this.numFmtIds[e]||this.getIndx(n,e)},getFrozen:function(e,n,i){return["<sheetViews><sheetView ",i?'rightToLeft="1"':"",' workbookViewId="0">','<pane xSplit="',n=n||0,'" ySplit="',e=e||0,'" topLeftCell="',pq.toLetter(n)+(e+1),'" activePane="bottomLeft" state="frozen"/>',"</sheetView></sheetViews>"].join("")},getIndx:function(e,n){var i=e[n];return null==i&&(i=e[n]=e.length,e.length++),i},getItem:function(e,n){var i,r,o=e[n],a=0,l=0,s=o?o.indx:-1;if(null==s||n==s)return o;if(0<=(i=-1==s?e.length-1:n))for(;;){if(20<++l)throw"not found";if((s=(o=e[r=Math.floor((i+a)/2)]).indx)==n)return o;if(n<s?i=r:a=r==a?r+1:r,a==i&&r==a)break}},getMergeCells:function(e){var n=[],i=0,r=(e=e||[]).length;for(n.push('<mergeCells count="'+r+'">');i<r;i++)n.push('<mergeCell ref="',e[i],'"/>');return n.push("</mergeCells>"),r?n.join(""):""},getSheetRel:function(e,n,i){var r=['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">'];return n&&r.push('<Relationship Id="com'+e+'" Target="../comments'+e+'.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments" />','<Relationship Id="vml'+e+'" Target="../drawings/vmlDrawing'+e+'.vml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing" />'),i&&r.push('<Relationship Id="rId'+e+'" Target="../drawings/drawing'+e+'.xml" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing"/>'),r.push("</Relationships>"),r.join("")},getSheet:function(e,n,i,r,o,a,l){return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><worksheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">',e,n,"<sheetData>",i,"</sheetData>",r,a?'<drawing r:id="rId'+l+'" />':"",o?'<legacyDrawing r:id="vml'+l+'" />':"","</worksheet>"].join("")},getStyleIndx:function(e){var n=e.format,i=e.bgColor,r=e.color,o=e.font,a=e.fontSize,l=e.align,s=e.valign,d=e.wrap,c=e.bold,u=e.italic,h=e.underline,e=e.border;if(n||i||r||o||a||l||s||d||c||u||h||e)return n=n?this.getFormatIndx(n):"",i=i?this.getFillIndx(i):"",e=e?this.getBorderIndx(e):"",n=n+"_"+i+"_"+(r||o||a||c||u||h?this.getFontIndx(r,o,a,c,u,h):"")+"_"+(l||"")+"_"+(s||"")+"_"+(d||"")+"_"+e,i=this.styles=this.styles||{length:1},this.getIndx(i,n)},getStyle:function(){var e,n,i,r,o,a,l,s,d,c,u,h,f,p,g,m=this,v=m.formats,$=m.fills,x=m.fonts,w=m.borders,y=["left","right","top","bottom"],C=m.styles,_=[],b=[],I=[],q=[],R=['<xf numFmtId="0" applyNumberFormat="1"/>'];if(v){for(g in delete v.length,v)_.push('<numFmt numFmtId="'+v[g]+'" formatCode="'+g+'"/>');delete m.formats}if($){for(g in delete $.length,$)b.push('<fill><patternFill patternType="solid"><fgColor rgb="'+this.getColor(g)+'"/></patternFill></fill>');delete m.fills}if(x){for(g in delete x.length,x)e="<color "+((l=g.split("_"))[0]?'rgb="'+this.getColor(l[0])+'"':'theme="1"')+" />",i='<name val="'+(l[1]||"Calibri")+'"/>',n='<sz val="'+(l[2]||11)+'"/>',r=l[3]?"<b/>":"",o=l[4]?"<i/>":"",a=l[5]?"<u/>":"",I.push("<font>",r,o,a,n,e,i,'<family val="2"/></font>');delete m.fonts}if(w){for(g in delete w.length,w){var D=JSON.parse(g);q.push("<border>"),y.forEach(function(e){D[e]&&(l=D[e].split(" "),q.push("<"+e+' style="'+("1px"==l[0]?"thin":"double")+'"><color rgb="'+m.getColor(l[2])+'"/></'+e+">"))}),q.push("</border>")}delete m.borders}if(C){for(g in delete C.length,C)s=(l=g.split("_"))[0],d=l[1],c=l[2],u=l[3],h=l[4],f=l[5],p=l[6],h=h?' vertical="'+h+'" ':"",f=f?' wrapText="1" ':"",R.push("<xf "+(s?' applyNumberFormat="1" numFmtId="'+s+'"':"")+(d?' applyFill="1" fillId="'+d+'" ':"")+(c?' applyFont="1" fontId="'+c+'" ':"")+(p?' applyBorder="1" borderId="'+p+'"':"")+((u=u?' horizontal="'+u+'" ':"")||h||f?' applyAlignment="1"><alignment '+u+h+f+"/></xf>":"/>"));delete this.styles}return _=_.join("\n"),R=R.join("\n"),b=b.join("\n"),['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<styleSheet xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main">',"<numFmts>",_,"</numFmts>","<fonts>",'<font><sz val="11"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font>',I=I.join(""),"</fonts>",'<fills><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill>',b,"</fills>","<borders><border><left/><right/><top/><bottom/><diagonal/></border>",q=q.join("\n"),"</borders>",'<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/>',"</cellStyleXfs>","<cellXfs>",R,"</cellXfs>",'<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>','<dxfs count="0"/><tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleLight16"/>',"</styleSheet>"].join("")},getVml:function(){var e,n=[];for(e in this.comments){var i=e.match(/([A-Z]+)(\d+)/),r=pq.toNumber(i[1]),i=i[2]-1;n.push('<v:shape id="1" type="#0" style="position:absolute;margin-left:259.25pt;margin-top:1.5pt;width:108pt;height:59.25pt;z-index:1;visibility:hidden" fillcolor="#ffffe1" o:insetmode="auto"><v:fill color2="#ffffe1"/><v:shadow on="t" color="black" obscured="t"/><v:path o:connecttype="none"/><v:textbox style="mso-direction-alt:auto"><div style="text-align:right"></div></v:textbox><x:ClientData ObjectType="Note"><x:MoveWithCells/><x:SizeWithCells/><x:Anchor>1, 15, 0, 2, 3, 31, 4, 1</x:Anchor><x:AutoFill>False</x:AutoFill>',"<x:Row>",i,"</x:Row>","<x:Column>",r,"</x:Column></x:ClientData></v:shape>")}return['<xml xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"><o:shapelayout v:ext="edit"><o:idmap v:ext="edit" data="1"/></o:shapelayout>','<v:shapetype id="0" coordsize="21600,21600" o:spt="202" path="m,l,21600r21600,l21600,xe"><v:stroke joinstyle="miter"/><v:path gradientshapeok="t" o:connecttype="rect"/></v:shapetype>',n.join(""),"</xml>"].join("")},getWBook:function(e,n){return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?><workbook xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:r="http://schemas.openxmlformats.org/officeDocument/2006/relationships">',"<bookViews><workbookView "+(0<=n?"activeTab='"+n+"'":"")+" /></bookViews><sheets>",e.map(function(e,n){n++;var i=e.name;return["<sheet ",e.hidden?'state="hidden"':"",' name="',i?pq.escapeXml(i):"sheet"+n,'" sheetId="',n,'" r:id="rId',n,'"/>'].join("")}).join(""),"</sheets></workbook>"].join("")},getWBookRels:function(e){for(var n=[],i=1;i<=e;i++)n.push('<Relationship Id="rId'+i+'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet" Target="worksheets/sheet'+i+'.xml"/>');return['<?xml version="1.0" encoding="UTF-8" standalone="yes"?>','<Relationships xmlns="http://schemas.openxmlformats.org/package/2006/relationships">',n.join(""),'<Relationship Id="rId',i,'" Type="http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles" Target="styles.xml"/>',"</Relationships>"].join("")},importXl:function(){var e=pq.excelImport;return e.Import.apply(e,arguments)},SpreadSheet:function(e){var n,r=i.SpreadSheet;if(this instanceof r==0)return new r(e);for(n in e)this[n]=e[n]}};function r(e){return 1===e.length?"0"+e:e}i.colRatio=8,i.colWidth=8.43*i.colRatio,i.numFmtIds=function(){var e,n=pq.excelImport.preDefFormats,i={};for(e in n)i[n[e]]=e;return i}(),pq.postRequest=function(n){var i,r,o=n.format,a=n.url,l=n.filename||"pqGrid";return n.zip&&"xlsx"!=o?((r=new JSZip).file(l+"."+n.format,n.data),r=r.generate({type:"base64",compression:"DEFLATE"}),i=!0,o="zip"):(i=!!n.decodeBase,r=n.data),a&&e.ajax({url:a,type:"POST",cache:!1,data:{pq_ext:o,pq_data:r,pq_decode:i,pq_filename:l},success:function(n){a=a+(0<a.indexOf("?")?"&":"?")+"pq_filename="+n,e(document.body).append("<iframe height='0' width='0' frameborder='0' src=\""+a+'"></iframe>')}}),r},i.SpreadSheet.prototype={getCell:function(e,n){var r=this.rows||[],r=i.getItem(r,e)||{cells:[]};return i.getItem(r.cells,n)}}}(jQuery),function(e){var n=e.paramquery,i=(n.pqGrid.defaults.formulasModel={on:!0},n.pqGrid.prototype.getFormula=function(e,n){return(e=this.iFormulas.getFnW(e,n))?e.fn:void 0},e(document).on("pqGrid:bootup",function(e,n){var r,n=n.instance;n.options.formulasModel.on&&(r=n.iFormulas=new i(n)),n.Formulas=function(){return r}}),n.cFormulas=function(e){var n=this;n.that=e,n.fn={},n.tabNames={},e.on("dataReadyDone",n.onDataReadyDone.bind(n)).on("colMove colAdd colRemove",n.onColumnOrder.bind(n)).on("beforeValidateDone",n.onBeforeValidateDone.bind(n)).on("autofillSeries",n.onAutofill.bind(n)).on("editorBegin",n.onEditorBegin.bind(n)).on("editorEnd",n.onEditorEnd.bind(n)).on("editorKeyUp editorClick",n.onEditorKeyUp.bind(n)).on(!0,"change",n.onChange.bind(n)).on("tabChange",n.onTabChange.bind(n)).on("tabRename",n.onTabRename.bind(n))});e.extend(i,{deString:function(e,n,i){var r=[];return e=n(e=e.replace(/(?:^|[^"]+)"(([^"]|"{2})+)"(?=([^"]+|$))/g,function(e,n){var i=e.indexOf('"'+n+'"');return r.push(n),e.slice(0,i)+"#"+(r.length-1)+"#"})),r.forEach(function(n,r){i&&(n=n.replace(/""/g,'\\"')),e=e.replace("#"+r+"#",'"'+n+'"')}),e},reSheet:"(?:(?:(?:'(?:[^\\*\\?:\\[\\]\\+']|'')+')|(?:[^\\*\\?:\\[\\]\\(\\)\\+\\-',!]+))!)?",selectExp:function(e,n){var i,r=e.slice(0,n).replace(/"[^"]*"/g,"");if(!/"[^"]+$/.test(r)&&(e=e.slice(n),(n=r.match(/.*?([a-z0-9:$]+)$/i))&&(i=""===e?[]:e.match(/^([a-z0-9:$]+)?.*/i))))return(n[1]+(null==i[1]?"":i[1])).replace(/\$/g,"").toUpperCase()},shiftRC:function(e){var n=i,r=e?e.get_p_data().length-1:0,o=e?e.colModel.length-1:0;return function(e,i,a){return i&&(e=n.shiftC(e,i,o)),e=a?n.shiftR(e,a,r):e}},getTab:function(e){return e="'"==(e=e.slice(0,e.length-1).replace(/''/g,"'"))[0]?e.slice(1,e.length-1):e},shiftR:function(e,n,r,o){function a(e){return o[i.getTab(e)].pdata.length-1}var l=i.reSheetC,s=RegExp(l+"(\\$?)([A-Z]+)(\\$?)([\\d]+(?!!))","g"),d=RegExp(l+"(\\$?)([0-9]+):(\\$?)([0-9]+)","g");return i.deString(e,function(e){return e.replace(s,function(e,i,o,l,s,d){return s?e:(s=+d+n-1,r=i?a(i):r,(i||"")+o+l+((s=s<0?0:r&&r<s?r:s)+1))}).replace(d,function(e,i,o,l,s,d){var c;return r=i?a(i):r,(i||"")+o+(l=o?l:(c=(c=+l+n-1)<0?0:r&&r<c?r:c)+1)+":"+s+(d=s?d:(c=(c=+d+n-1)<0?0:r&&r<c?r:c)+1)})})},shiftC:function(e,n,r,o){function a(e){return o[i.getTab(e)].colModel.length-1}var l=i.reSheetC,s=RegExp(l+"(\\$?)([A-Z]+)(\\$?)([\\d]+)","g"),d=RegExp(l+"(\\$?)([A-Z]+):(\\$?)([A-Z]+)","g");return i.deString(e,function(e){return(e=e.replace(s,function(e,i,o,l,s,d){return o?e:(o=pq.toNumber(l)+n,r=i?a(i):r,o=o<0?0:r&&r<o?r:o,(i||"")+pq.toLetter(o)+s+d)})).replace(d,function(e,i,o,l,s,d){var c;return r=i?a(i):r,o||(c=(c=pq.toNumber(l)+n)<0?0:r&&r<c?r:c,l=pq.toLetter(c)),s||(c=(c=pq.toNumber(d)+n)<0?0:r&&r<c?r:c,d=pq.toLetter(c)),(i||"")+o+l+":"+s+d})})}}),i.reSheetC=i.reSheet.replace("?:",""),i.prototype={addRowIndx:function(e){e.forEach(function(e){var n,i,r=e.newRow,o=r.pq_fn;if(o)for(i in o)(n=o[i]).ri=n.riO=r.pq_ri})},cell:function(e){var e=this.toCell(e),n=e.r,e=e.c;return this.valueArr(n,e)[0]},check:function(e){return i.deString(e,function(e){return(e=e.replace(/[^']+(\s+)(?![^']+')/g,function(e){return e.replace(/\s/g,"")})).toUpperCase().replace(/([A-Z]+)([0-9]+)\:([A-Z]+)([0-9]+)/g,function(e,n,i,r,o){var a,l;return n=pq.toNumber(n),(r=pq.toNumber(r))<n&&(n=(a=r,r=n,a)),+o<+i&&(i=(l=o,o=i,l)),pq.toLetter(n)+i+":"+pq.toLetter(r)+o})})},computeAll:function(){var e,n=this,i=n.that;if(n.initObj(),n.eachFormula(function(n){n.clean=0,e=!0}),e)return n.eachFormula(function(e,r,o,a,l){r[o]=n.execIfDirty(e),l&&i.isValid({rowIndx:a,rowData:r,dataIndx:o,allowInvalid:!0})}),!0},eachFormula:function(e){function n(e){for(var n,i,r=(e=e||[]).length;r--;)(n=e[r])&&(i=n.pq_fn)&&o(n,r,i)}var i=!0,r=this.that,o=function(n,r,o){var a,l;for(a in o)"string"!=typeof(l=o[a])&&e(l,n,a,r,i)};n(r.get_p_data()),i=!1,n(r.options.summaryData)},execIfDirty:function(e,n){if(e.clean){if(.5==e.clean)return n}else e.clean=.5,e.val=this.exec(e.fn,e.ri,e.ci),e.clean=1;return e.val},replace:function(e,n,i){var r=n.lastIndexOf("!"),o=e===n,a=this.obj;return 0<r||(a[n]=a[n]||this[i](n)),"range"==i?"this['"+n+"']":(r=e.charAt(0),(o||"$"==r?"":r)+"this['"+n+"']")},exec:function(e,n,r){var o=this,a=o.obj,l=i.reSheet,e=i.deString(e,function(e){var n="(?:\\(|\\,|^|\\+)(("+l+"\\$?[A-Z]+\\$?[0-9]+\\+?){2,})(?:\\)|\\,|$|\\+)";return e=(e=(e=(e=(e=e.replace(RegExp(n,"g"),function(e,n){var i="SUM("+n.split("+").join(",")+")",r=e[0],e=e[e.length-1];return(r=r==n[0]?"":r)+i+(e=e==n[n.length-1]?"":e)})).replace(/\^/g,"**")).replace(RegExp("("+l+"\\$?([A-Z]+)?\\$?([0-9]+)?\\:\\$?([A-Z]+)?\\$?([0-9]+)?)","g"),function(e,n){return o.replace(e,n,"range")})).replace(RegExp("(?:[^:A-Z']|^)("+l+"\\$?[A-Z]+\\$?[0-9]+)(?![:\\d]+)","g"),function(e,n){return o.replace(e,n,"cell")})).replace(/{/g,"[").replace(/}/g,"]").replace(/(?:[^><])(=+)/g,function(e,n){return e+(1===n.length?"==":"")}).replace(/<>/g,"!==").replace(/&/g,"+")},!0);a.getRange=function(){return{r1:n,c1:r}};try{var s=Function("with(this){return "+e+"}").call(a);"function"==typeof s?s="#NAME?":"string"==typeof s&&i.deString(s,function(e){0<=e.indexOf("function")&&(s="#NAME?")}),s!=s&&(s=null)}catch(d){s="string"==typeof d?d:d.message}return s},initObj:function(){this.obj=e.extend({iFormula:this},pq.formulas)},onAutofill:function(e,n){var r=n.sel,o=this.that,a=r.r,r=r.c,l=n.x,a=o.getRowData({rowIndx:a}),s=o.colModel,d=s.length-1,c=o.get_p_data().length-1,u=this.tabNames,o=s[r].dataIndx,h=this.getFnW(a,o);h&&(n.series=function(e){return"="+(l?i.shiftC(h.fn,e-1,d,u):i.shiftR(h.fn,e-1,c,u))})},onBeforeValidateDone:function(e,n){function i(e){e.forEach(function(e){var i,a,l,s=e.newRow,d=e.rowData;for(i in s)"string"==typeof(l=s[i])&&"="===l[0]?(n.allowInvalid=!0,l=r.check(l),(a=d?r.getFnW(d,i):null)?l!==a.fn&&(e.oldRow[i]="="+a.fn,r.save(d,i,l,e.rowIndx,o[i])):r.save(d||s,i,l,e.rowIndx,o[i])):d&&(a=r.remove(d,i))&&(e.oldRow[i]="="+a.fn)})}var r=this,o=this.that.colIndxs;i(n.addList),i(n.updateList)},onTabChange:function(e,n){!this.tabNames[n.tab.name.toUpperCase()]||n.addList.length||n.deleteList.length||(this.computeAll(),this.that.refresh())},onTabRename:function(e,n){function i(e){return e=e.replace(/'/g,"''"),(e=/[\s~!@#'\.,$%^&(\)<>]+/.test(e)?"'"+e+"'":e)+"!"}var r=this.tabNames,o=n.oldVal.toUpperCase(),a=n.tab.name.toUpperCase();r[o]&&(delete r[o],r[a]=1,a=i(a),o=i(o),this.eachFormula(function(e){e.fn=e.fn.split(o).join(a)}))},onChange:function(e,n){this.addRowIndx(n.addList),n.addList.length||n.deleteList.length||this.computeAll()},onColumnOrder:function(){var e,n,r=this.that,o=i.shiftRC(r),a=r.colIndxs;this.eachFormula(function(i,r,l){e=a[l],i.ci!=e&&(n=e-i.ciO,i.ci=e,i.fn=o(i.fnOrig,n,i.ri-i.riO))}),null!=e&&this.computeAll()},onEditorBegin:function(e,n){var i=this.getFnW(n.rowData,n.dataIndx);i&&n.$editor.val("="+i.fn)},onEditorEnd:function(){pq.intel.hide()},onEditorKeyUp:function(e,n){var n=n.$editor,i=n.val(),r=pq.intel,o=window.getSelection().getRangeAt(0).startOffset;i&&0===i.indexOf("=")&&(r.popup(i,o,n),this.select(i,o))},onDataReadyDone:function(){function e(e){for(var n,i,r=(e=e||[]).length;r--;)(n=e[r])&&(i=n.pq_fn)&&s(n,r,i)}var n,r=this,o=r.that,a=i.shiftRC(o),l=o.colIndxs,s=function(e,i,o){var s,d,c;for(d in o)s=o[d],n=!0,"string"==typeof s?r.save(e,d,r.check(s),i,l[d]):s.ri!=i&&(c=i-s.riO,s.ri=i,s.fn=a(s.fnOrig,s.ci-s.ciO,c))};e(o.get_p_data()),e(o.options.summaryData),r.initObj(),n&&r.computeAll()},getFnW:function(e,n){if(e=e.pq_fn)return e[n]},remove:function(e,n){var i,r=e.pq_fn;if(r&&(i=r[n]))return delete r[n],pq.isEmpty(r)&&delete e.pq_fn,i},range:function(e){var e=e.split(":"),n=this.that,i=this.toCell(e[0]),r=i.r,i=i.c,e=this.toCell(e[1]),o=e.r,e=e.c;return this.valueArr(null==r?0:r,null==i?0:i,null==o?n.get_p_data().length-1:o,null==e?n.colModel.length-1:e)},save:function(e,n,i,r,o){return i={clean:0,fn:i=i.replace(/^=/,""),fnOrig:i,riO:r,ciO:o,ri:r,ci:o},(e.pq_fn=e.pq_fn||{})[n]=i},selectRange:function(e,n){var r,o,e=i.selectExp(e,n);if(e)return/^([a-z0-9]+):([a-z0-9]+)$/i.test(e)?(n=e.split(":"),r=this.toCell(n[0]),n=this.toCell(n[1]),o={r1:r.r,c1:r.c,r2:n.r,c2:n.c}):/^[a-z]+[0-9]+$/i.test(e)&&(o={r1:(r=this.toCell(e)).r,c1:r.c}),o},select:function(e,n){e=this.selectRange(e,n),n=this.that,e?n.Range(e).select():n.Selection().removeAll()},toCell:function(e){return{c:(e=e.match(/\$?([A-Z]+)?\$?(\d+)?/))[1]?pq.toNumber(e[1]):null,r:e[2]?e[2]-1:null}},valueArr:function(e,n,i,r){var o,a,l,s,d,c,u=this.that,h=u.colModel,f=h.length,p=[],g=[],m=[],v=u.get_p_data(),u=v.length;for(r=null==r?n:r,n=n<0?0:n,i=u<=(i=null==i?e:i)?u-1:i,r=f<=r?f-1:r,o=e=e<0?0:e;o<=i;o++){for(l=v[o],a=n;a<=r;a++)s=h[a].dataIndx,(d=this.getFnW(l,s))?c=this.execIfDirty(d,l[s]):null==(c=l[s])&&(c=""),p.push(c),m.push(c);g.push(m),m=[]}return p.get2Arr=function(){return g},p.getRange=function(){return{r1:e,c1:n,r2:i,c2:r}},p}}}(jQuery),function(e){pq.intel={removeFn:function(e){return e.length===(e=e.replace(/[a-z]*\([^()]*\)/gi,"")).length?e:this.removeFn(e)},removeStrings:function(e){return(e=e.replace(/"[^"]*"/g,"")).replace(/"[^"]*$/,"")},getMatch:function(e,n){var i,r=pq.formulas,o=[];for(i in e=e.toUpperCase(),r)if(n){if(i===e)return[i]}else 0===i.indexOf(e)&&o.push(i);return o},intel:function(e){var n,i;return e=this.removeStrings(e),(e=(e=this.removeFn(e)).match(/^=(.*[,+\-&*\s(><=])?([a-z]+)((\()[^)]*)?$/i))&&(n=e[2],e[4]&&(i=!0)),[n,i]},movepos:function(e){var n;return(n=e.match(/([^a-z].*)/i))?e.indexOf(n[1])+1:e.length},intel3:function(e,n){return n<e.length&&/=(.*[,+\-&*\s(><=])?[a-z]+$/i.test(e.slice(0,n))&&(n+=this.movepos(e.slice(n))),e=e.substr(0,n),this.intel(e)},item:function(e){var n=this.that.options.strFormulas;return"<div>"+((n=n?n[e]:null)?n[0]:e)+"</div>"+(n?"<div style='font-size:0.9em;color:#888;margin-bottom:5px;'>"+n[1]+"</div>":"")},popup:function(n,i,r){var o=r.closest(".pq-grid"),a=e(".pq-intel"),l=o,n=this.intel3(n,i);this.that=o.pqGrid("instance"),a.remove(),(i=n[0])&&(o=this.getMatch(i,n[1]).map(this.item,this).join(""))&&e("<div class='pq-intel' style='width:350px;max-height:300px;overflow:auto;background:#fff;border:1px solid gray;box-shadow: 4px 4px 2px #aaaaaa;padding:5px;'></div>").appendTo(l).html(o).position({my:"center top",at:"center bottom",collision:"flipfit",of:r,within:l})},hide:function(){e(".pq-intel").remove()}}}(jQuery),function($){var f=pq.formulas={evalify:function(e,n){var i,r,n=n.match(/([><=]{1,2})?(.*)/),o=n[1]||"=",a=n[2],l=this;return/(\*|\?)/.test(a)?i=a.replace(/\*/g,".*").replace(/\?/g,"\\S").replace(/\(/g,"\\(").replace(/\)/g,"\\)"):(o="="===o?"==":"<>"===o?"!=":o,r=this.ISNUMBER(a)),e.map(function(e){return e=i?("<>"===o?"!":"")+"/^"+i+'$/i.test("'+(e=null==e?"":e)+'")':r?l.ISNUMBER(e)?e+o+a:"false":'"'+((e=null==e?"":e)+"").toUpperCase()+'"'+o+'"'+(a+"").toUpperCase()+'"'})},get2Arr:function(e){return e.get2Arr?e.get2Arr():e},ISNUMBER:function(e){return parseFloat(e)==e},_reduce:function(e,n){var i=[],r=n.map(function(){return[]});return e.forEach(function(e,o){null!=e&&(isNaN(e=+e)||(i.push(e),r.forEach(function(e,i){e.push(n[i][o])})))}),[i,r]},reduce:function(e){var n=(e=this.toArray(e)).shift(),i=e.filter(function(e,n){return n%2==0}),r=this._reduce(n,i),n=r[0],i=r[1];return[n].concat(e.map(function(n,r){return r%2==0?i[r/2]:e[r]}))},strDate1:"(\\d{1,2})/(\\d{1,2})/(\\d{2,4})",strDate2:"(\\d{4})-(\\d{1,2})-(\\d{1,2})",strDate3:"(\\d{1,2})-(\\d{1,2})-(\\d{4})",strTime:"(\\d{1,2})(:(\\d{1,2}))?(:(\\d{1,2}))?(\\s(AM|PM))?",isDate:function(e){return this.reDate.test(e)&&Date.parse(e)||e&&e.constructor==Date},toArray:function(e){for(var n=[],i=0,r=e.length;i<r;i++)n.push(e[i]);return n},valueToDate:function(e){var n=new Date(Date.UTC(1900,0,1));return n.setUTCDate(n.getUTCDate()+e-2),n},varToDate:function(e){var n,i,r,o,a;if(this.ISNUMBER(e))n=this.valueToDate(e);else if(e.getTime)n=e;else if("string"==typeof e){if((i=(e=$.trim(e)).match(this.reDateTime))?i[12]?(a=+i[13],o=+i[15],r=+i[14]):(r=+i[2],o=+i[3],a=+i[4]):(i=e.match(this.reDate2))?(a=+i[1],o=+i[3],r=+i[2]):(i=e.match(this.reDate1))?(r=+i[1],o=+i[2],a=+i[3]):(i=e.match(this.reDate3))&&(o=+i[1],r=+i[2],a=+i[3]),!i)return e;e=Date.UTC(a,r-1,o),n=new Date(e)}return n},_IFS:function(arg,fn){for(var len=arg.length,i=0,arr=[],a=0;i<len;i+=2)arr.push(this.evalify(arg[i],arg[i+1]));for(var j,condsIndx=arr[0].length,lenArr=len/2;condsIndx--;){for(j=0;j<lenArr&&eval(arr[j][condsIndx]);j++);a+=j===lenArr?fn(condsIndx):0}return a},ABS:function(e){return Math.abs(e.map?e[0]:e)},ACOS:function(e){return Math.acos(e)},ADDRESS:function(e,n,i){return(2==i||4==i?"":"$")+pq.toLetter(n-1)+(3==i||4==i?"":"$")+e},AND:function(){var arr=this.toArray(arguments);return eval(arr.join(" && "))},ASIN:function(e){return Math.asin(e)},ATAN:function(e){return Math.atan(e)},_AVERAGE:function(e){var n=0,i=0;if(e.forEach(function(e){parseFloat(e)==e&&(i+=+e,n++)}),n)return i/n;throw"#DIV/0!"},AVERAGE:function(){return this._AVERAGE(pq.flatten(arguments))},AVERAGEIF:function(e,n,i){return this.AVERAGEIFS(i||e,e,n)},AVERAGEIFS:function(){var e=this.reduce(arguments),n=0,i=e.shift(),e=this._IFS(e,function(e){return n++,i[e]});if(n)return e/n;throw"#DIV/0!"},TRUE:!0,FALSE:!1,CEILING:function(e){return Math.ceil(e)},CHAR:function(e){return String.fromCharCode(e)},CHOOSE:function(){var e=pq.flatten(arguments),n=e[0];if(0<n&&n<e.length)return e[n];throw"#VALUE!"},CODE:function(e){return(e+"").charCodeAt(0)},COLUMN:function(e){return(e||this).getRange().c1+1},COLUMNS:function(e){return(e=e.getRange()).c2-e.c1+1},CONCATENATE:function(){var e=pq.flatten(arguments),n="";return e.forEach(function(e){n+=e}),n},COS:function(e){return Math.cos(e)},_COUNT:function(e){var e=pq.flatten(e),n=this,i=0,r=0,o=0;return e.forEach(function(e){null==e||""===e?i++:(r++,n.ISNUMBER(e)&&o++)}),[i,r,o]},COUNT:function(){return this._COUNT(arguments)[2]},COUNTA:function(){return this._COUNT(arguments)[1]},COUNTBLANK:function(){return this._COUNT(arguments)[0]},COUNTIF:function(e,n){return this.COUNTIFS(e,n)},COUNTIFS:function(){return this._IFS(arguments,function(){return 1})},DATE:function(e,n,i){if(e<0||9999<e)throw"#NUM!";return e<=1899&&(e+=1900),this.VALUE(new Date(Date.UTC(e,n-1,i)))},DATEVALUE:function(e){return this.DATEDIF("1/1/1900",e,"D")+2},DATEDIF:function(e,n,i){var r,n=this.varToDate(n),e=this.varToDate(e),o=(n.getTime()-e.getTime())/864e5;if("Y"===i)return parseInt(o/365);if("M"===i)return r=n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear()),e.getUTCDate()>n.getUTCDate()&&r--,r;if("D"===i)return o;throw"unit N/A"},DAY:function(e){return this.varToDate(e).getUTCDate()},DAYS:function(e,n){return this.DATEDIF(n,e,"D")},DEGREES:function(e){return 180/Math.PI*e},EOMONTH:function(e,n){return n=n||0,(e=this.varToDate(e)).setUTCMonth(e.getUTCMonth()+n+1),e.setUTCDate(0),this.VALUE(e)},EXP:function(e){return Math.exp(e)},FIND:function(e,n,i){return n.indexOf(e,i?i-1:0)+1},FLOOR:function(e,n){return e*n<0?"#NUM!":parseInt(e/n)*n},HLOOKUP:function(e,n,i,r){return null==r&&(r=!0),n=this.get2Arr(n),e=this.MATCH(e,n[0],r?1:0),this.INDEX(n,i,e)},HOUR:function(e){return Date.parse(e)?new Date(e).getHours():24*e},IF:function(e,n,i){return e?n:i},INDEX:function(e,n,i){return n=n||1,i=i||1,"function"==typeof(e=this.get2Arr(e))[0].push?e[n-1][i-1]:e[1<n?n-1:i-1]},INDIRECT:function(e){return this.iFormula[0<e.indexOf(":")?"range":"cell"](e)},ISBLANK:function(e){return""===e},LARGE:function(e,n){return e.sort(),e[e.length-(n||1)]},LEFT:function(e,n){return e.substr(0,n||1)},LEN:function(e){return 1<(e=(e.map?e:[e]).map(function(e){return e.length})).length?e:e[0]},LOOKUP:function(e,n,i){return i=i||n,e=this.MATCH(e,n,1),this.INDEX(i,1,e)},LOWER:function(e){return(e+"").toLocaleLowerCase()},_MAXMIN:function(e,n){var i,r=this;return e.forEach(function(e){null!=e&&(e=r.VALUE(e),r.ISNUMBER(e)&&(i*n<e*n||null==i)&&(i=e))}),null!=i?i:0},MATCH:function(val,arr,type){var _isNumber,indx,_val,ISNUMBER=this.ISNUMBER(val),i=0,len=arr.length;if(null==type&&(type=1),val=ISNUMBER?val:val.toUpperCase(),0===type){for(arr=this.evalify(arr,val+""),i=0;i<len;i++)if(eval(_val=arr[i])){indx=i+1;break}}else{for(i=0;i<len;i++)if(_val=arr[i],_isNumber=this.ISNUMBER(_val),val==(_val=arr[i]=_isNumber?_val:_val?_val.toUpperCase():"")){indx=i+1;break}if(!indx){for(i=0;i<len;i++)if(_val=arr[i],_isNumber=this.ISNUMBER(_val),type*(_val<val?-1:1)==1&&ISNUMBER==_isNumber){indx=i;break}indx=null==indx?i:indx}}if(indx)return indx;throw"#N/A"},MAX:function(){var e=pq.flatten(arguments);return this._MAXMIN(e,1)},MEDIAN:function(){var e=pq.flatten(arguments).filter(function(e){return+e==e}).sort(function(e,n){return n-e}),n=e.length,i=n/2;return i===parseInt(i)?(e[i-1]+e[i])/2:e[(n-1)/2]},MID:function(e,n,i){if(n<1||i<0)throw"#VALUE!";return e.substr(n-1,i)},MIN:function(){var e=pq.flatten(arguments);return this._MAXMIN(e,-1)},MODE:function(){var e,n,i=pq.flatten(arguments),r={},o=0;if(i.forEach(function(i){o<(e=r[i]=r[i]?r[i]+1:1)&&(o=e,n=i)}),o<2)throw"#N/A";return n},MONTH:function(e){return this.varToDate(e).getUTCMonth()+1},OR:function(){var arr=this.toArray(arguments);return eval(arr.join(" || "))},PI:function(){return Math.PI},POWER:function(e,n){return Math.pow(e,n)},PRODUCT:function(){var e=pq.flatten(arguments),n=1;return e.forEach(function(e){n*=e}),n},PROPER:function(e){return e=e.replace(/(\S+)/g,function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})},RADIANS:function(e){return Math.PI/180*e},RAND:function(){return Math.random()},RANK:function(e,n,i){for(var r=JSON.stringify(n.getRange())+"_range",o=0,a=(n=this[r]||(this[r]=n).sort(function(e,n){return e-n})).length;o<a;o++)if(e===n[o])return i?o+1:a-o},RATE:function(){},REPLACE:function(e,n,i,r){return(e+="").substr(0,n-1)+r+e.substr(n+i-1)},REPT:function(e,n){for(var i="";n--;)i+=e;return i},RIGHT:function(e,n){return e.substr(-1*(n=n||1),n)},_ROUND:function(e,n,i){var n=Math.pow(10,n),e=e*n,r=parseInt(e);return i(r,e-r)/n},ROUND:function(e,n){return this._ROUND(e,n,function(e,n){var i=Math.abs(n);return e+(.5<=i?i/n:0)})},ROUNDDOWN:function(e,n){return this._ROUND(e,n,function(e){return e})},ROUNDUP:function(e,n){return this._ROUND(e,n,function(e,n){return e+(n?Math.abs(n)/n:0)})},ROW:function(e){return(e||this).getRange().r1+1},ROWS:function(e){return(e=e.getRange()).r2-e.r1+1},SEARCH:function(e,n,i){return e=e.toUpperCase(),(n=n.toUpperCase()).indexOf(e,i?i-1:0)+1},SIN:function(e){return Math.sin(e)},SMALL:function(e,n){return e.sort(),e[(n||1)-1]},SQRT:function(e){return Math.sqrt(e)},_STDEV:function(e){var n=(e=pq.flatten(e)).length,i=this._AVERAGE(e),r=0;return e.forEach(function(e){r+=(e-i)*(e-i)}),[r,n]},STDEV:function(){var e=this._STDEV(arguments);if(1===e[1])throw"#DIV/0!";return Math.sqrt(e[0]/(e[1]-1))},STDEVP:function(){var e=this._STDEV(arguments);return Math.sqrt(e[0]/e[1])},SUBSTITUTE:function(e,n,i,r){var o=0;return e.replace(RegExp(n,"g"),function(){return o++,r&&o!==r?n:i})},SUM:function(){var e=pq.flatten(arguments),n=0,i=this;return e.forEach(function(e){e=i.VALUE(e),i.ISNUMBER(e)&&(n+=parseFloat(e))}),n},SUMIF:function(e,n,i){return this.SUMIFS(i||e,e,n)},SUMIFS:function(){var e=this.reduce(arguments),n=e.shift();return this._IFS(e,function(e){return n[e]})},SUMPRODUCT:function(){var e=(e=this.toArray(arguments))[0].map(function(n,i){var r=1;return e.forEach(function(e){r*=parseFloat(e=e[i])==e?e:0}),r});return pq.aggregate.sum(e)},TAN:function(e){return Math.tan(e)},TEXT:function(e,n){var i;return this.ISNUMBER(e)&&0<=n.indexOf("#")?pq.formatNumber(e,n):(i=this.varToDate(e))&&i.constructor==Date?$.datepicker.formatDate(pq.excelToJui(n),i):e},TIME:function(e,n,i){return(e+n/60+i/3600)/24},TIMEVALUE:function(e){var n,i,r,o,e=e.match(this.reTime);if(e&&null!=e[1]&&(null!=e[3]||null!=e[7])&&(n=+e[1],o=+(e[3]||0),i=+(e[5]||0),r=(e[7]||"").toUpperCase(),o=n+o/60+i/3600),0<=o&&(r&&o<13||!r&&o<24))return"PM"==r&&n<12?o+=12:"AM"==r&&12==n&&(o-=12),o/24;throw"#VALUE!"},TODAY:function(){var e=new Date;return this.VALUE(new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())))},TRIM:function(e){return e.replace(/^\s+|\s+$/gm,"")},TRUNC:function(e,n){return~~(e*(n=Math.pow(10,n||0)))/n},UPPER:function(e){return(e+"").toLocaleUpperCase()},VALUE:function(e){var n,i,r;return e?parseFloat(e)==e?parseFloat(e):this.isDate(e)?this.DATEVALUE(e):(n=e.match(this.reDateTime))?(i=n[1]||n[12],r=e.substr(i.length+1),this.DATEVALUE(i)+this.TIMEVALUE(r)):(n=e.match(this.reTime))?this.TIMEVALUE(e):e.replace(/[^0-9\-.]/g,"").replace(/(\.[1-9]*)0+$/,"$1").replace(/\.$/,""):0},VAR:function(){var e=this._STDEV(arguments);return e[0]/(e[1]-1)},VARP:function(){var e=this._STDEV(arguments);return e[0]/e[1]},VLOOKUP:function(e,n,i,r){null==r&&(r=!0);var o=(n=this.get2Arr(n)).map(function(e){return e[0]}),e=this.MATCH(e,o,r?1:0);return this.INDEX(n,e,i)},YEAR:function(e){return this.varToDate(e).getUTCFullYear()}};f.reDate1=RegExp("^"+f.strDate1+"$"),f.reDate2=RegExp("^"+f.strDate2+"$"),f.reDate3=RegExp("^"+f.strDate3+"$"),f.reDate=RegExp("^"+f.strDate1+"$|^"+f.strDate2+"$|^"+f.strDate3+"$"),f.reTime=RegExp("^"+f.strTime+"$","i"),f.reDateTime=RegExp("^("+f.strDate1+")\\s"+f.strTime+"$|^("+f.strDate2+")\\s"+f.strTime+"$|^("+f.strDate3+")\\s"+f.strTime+"$")}(jQuery),function(e){pq.Select=function(n,i){if(this instanceof pq.Select==0)return new pq.Select(n,i);var r=i.closest(".pq-grid"),o=e("<div/>").appendTo(r);pq.grid(o,e.extend({width:i[0].offsetWidth,scrollModel:{autoFit:!0},height:"flex",autoRow:!1,numberCell:{show:!1},hoverMode:"row",fillHandle:"",stripeRows:!1,showTop:!1,showHeader:!1},n)),pq.makePopup(o[0],i[0]),o.position({my:"left top",at:"left bottom",of:i,collision:"flipfit",within:r})}}(jQuery),function(e){function n(e){this.options=e.options}n.prototype={empty:function(){for(var e in this)0==e.indexOf("_")&&delete this[e];delete this.options.dataModel.dataPrimary},getCM:function(){return this._cm},setCM:function(e){this._cm=e},getCols:function(){return this._columns},setCols:function(e){this._columns=e},getDMData:function(){return this.options.dataModel.dataPrimary},setDMData:function(e){this.options.dataModel.dataPrimary=e},getOCM:function(){return this._ocm},setOCM:function(e){this._ocm=e}},e(document).on("pqGrid:bootup",function(e,i){var i=i.instance,r=i.Group();r.primary=new n(i),i.on("beforeFilterDone",r.onBeforeFilterDone.bind(r)).one("CMInit",r.oneCMInit.bind(r))});var i,r={},o={clearPivot:function(e){if(this.isPivot()){var n=this.that,i=n.options.dataModel,r=this.primary,o=r.getOCM(),r=r.getDMData();if(o&&n.refreshCM(o),e){if(!r)throw"!primary.getDMData";i.data=r}else r&&(i.data=r);return this.primary.empty(),this.setPivot(!1),!0}},getColsPrimary:function(){return this.primary.getCols()||this.that.columns},getCMPrimary:function(){return this.primary.getCM()||this.that.colModel},getOCMPrimary:function(){return this.primary.getOCM()||this.that.options.colModel},getSumCols:function(){var e=")"+(this.that.options.rtl?"&lrm;":"");return(r.getSumCols.call(this)||[]).map(function(n){return[n.dataIndx,n.dataType,n.summary,n.summary.type+"("+n.title+e,n.width,n.format,n.showifOpen]})},getVal:function(){return this._pivot?function(e,n){return e[n]}:r.getVal.apply(this,arguments)},groupData:function(){var e,n,i,o,a,l,s=this.that,d=s.options.groupModel,c=d.dataIndx,u=d.groupCols,h=this.primary,f=u.length;(h=h.getDMData())&&h[0]!=s.pdata[0]||(d.pivot&&(e=c.slice(),d.dataIndx=c=c.concat(u),n=d.titleInFirstCol,i=d.titleIndx,o=d.merge,d.titleInFirstCol=!1,d.titleIndx=null,d.merge=!1),r.groupData.call(this),d.pivot&&(s.pdata=s.pdata.reduce(function(e,n){return n.pq_gtitle&&e.push(n),e},[]),i?(d.titleInFirstCol=n,d.titleIndx=i):1<e.length&&(d.merge=o),this.pivotData(c,e),d.dataIndx=e.slice(0,e.length-1),d.summaryInTitleRow="all",f?(a=i,l=e[e.length-1],r.groupData.call(this,!0),i&&a!=l&&s.pdata.forEach(function(e){e.pq_gtitle||(e[a]=e[l])})):i&&s.pdata.forEach(function(e){e[i]=e[[c[e.pq_level]]]}),d.dataIndx=e,this.setPivot(!0)),s._trigger("groupData"))},isPivot:function(){return this._pivot},getSorter:function(e){return e.pivotSortFn||("number"==pq.getDataType(e)?function(e,n){return+e.sortby>+n.sortby?1:-1}:function(e,n){return e.sortby>n.sortby?1:-1})},nestedCM:function(n,i){var r=this,o=i.groupCols,a=i.pivotColsTotal,l="hideifOpen"!=a&&null,s=[],d=[],c=r.that.columns,c=o.map(function(e){return e=c[e],s.push(r.getSorter(e)),d.push(pq.getDataType(e)),e});return function i(r,o,u){o=o||0,u=u||[];var h,f,p,g,m,v,$,x,w=0,y=[];if(e.isEmptyObject(r))for(;w<n.length;w++)h=n[w],(f=u.slice()).push(h[0]),p={dataIndx:f.join("_"),dataType:h[1],summary:h[2],title:h[3],width:h[4],format:h[5],showifOpen:h[6]},y.push(p);else{for(m in h=c[o],g=d[o],r)$="aggr"===m,(f=u.slice()).push(m),v=i(r[m],o+1,f),$?(x=v).forEach(function(e){e.showifOpen=l,e.type="aggr"}):(p={showifOpen:!0,sortby:m,title:pq.format(h,m,g),colModel:v},1<v.length&&!v.find(function(e){return!e.type}).dataIndx&&(p.collapsible={on:!0,last:null}),y.push(p));y.sort(s[o]),x&&y["before"==a?"unshift":"push"].apply(y,x)}return y}},onBeforeFilterDone:function(e,n){if(this.isPivot()){for(var i=n.rules,r=this.primary.getCols(),o=0;o<i.length;o++)if(!r[i[o].dataIndx])return!1;this.clearPivot(!0),n.header=!0}},oneCMInit:function(){this.updateAgg(this.that.options.groupModel.agg)},option:function(e,n,i,o){this.isPivot()&&this.clearPivot(),r.option.call(this,e,n,i,o)},pivotData:function(n,i){var r=this.that,o=this.getSumCols(),a=this.getSumDIs(),l=r.options,s=l.groupModel,d=this.primary,c=r.pdata,u=r.columns,h=s.titleIndx,f=h?[u[h]].concat(i.reduce(function(n,i){return i!=h&&n.push(e.extend({hidden:!0},u[i])),n},[])):i.map(function(e){return u[e]}),c=this.transformData(c,a,n,i),a=this.nestedCM(o,s)(c),n={};n.CM=f=f.concat(a),r._trigger("pivotCM",null,n),d.setOCM(l.colModel),d.setCM(r.colModel),d.setCols(r.columns),r.refreshCM(n.CM,{pivot:!0})},setPivot:function(e){this._pivot=e},transformData:function(e,n,i,r){var o,a,l,s,d=this,c=[],u=this.that,h=this.primary,f={},p=[],g=u.options,m=g.dataModel,g=g.groupModel,v=g.pivotColsTotal,$=r.length,x={},w=i.length;return $==w?(e.forEach(function(e){e.pq_level==$-1&&(delete e.children,delete e.pq_gtitle)}),d.updateItems(e),c=e):e.forEach(function(e){var u,h,g=e.pq_level,m=g-$,y=x,C=i[g],_=e[C];if(0<=m)for(p[m]=_,u=0;u<1+m;u++)y=y[h=p[u]]=y[h]||{};g===w-1?n.forEach(function(n){(s=p.slice()).push(n),l[s.join("_")]=e[n]}):((!l||g<a&&g<$)&&(l={pq_gid:d.idCount++},o=!0),g<$&&(f[C]=l[C]=_),v&&g<=w-2&&$-1<=g&&n.forEach(function(n){(s=p.slice(0,1+m)).push("aggr"),s.push(n),l[s.join("_")]=e[n]})),a=g,o&&(c.push(l),r.forEach(function(e){void 0===l[e]&&(l[e]=f[e])}),o=!1)}),h.setDMData(m.data),m.data=u.pdata=c,v&&this.addAggrInCM(x,g.pivotTotalForSingle),x},addAggrInCM:function(e,n){var i,r=0;for(i in e)r++,this.addAggrInCM(e[i],n);(n?0:1)<r&&(e.aggr={})},updateAgg:function(e,n){var i,r=this.that.columns;if(n)for(i in n)r[i].summary=null;if(e)for(i in e)r[i].summary={type:e[i]}}},a=e.paramquery.cGroup.prototype;for(i in o)r[i]=a[i],a[i]=o[i]}(jQuery),function(e){var n,i=e.paramquery;i.pqGrid.defaults.toolPanel={},i.pqGrid.prototype.ToolPanel=function(){return this.iToolPanel},e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iToolPanel=new i.cToolPanel(n)}),i.cToolPanel=function(e){this.that=e,this.panes=[],this.clsSort="pq-sortable",e.one("render",this.init.bind(this))},i.cToolPanel.prototype={getArray:function(e){return e.find(".pq-pivot-col").get().map(function(e){return e.dataset.di})},getInit:function(){return this._inited},getObj:function(e){var n={};return e.find(".pq-pivot-col").each(function(e,i){n[i.dataset.di]=i.getAttribute("type")||"sum"}),n},getSortCancel:function(){return this._sortCancel},_hide:function(e){this.$ele[e?"hide":"show"](),this.init(),this.that.refresh({soft:!0})},hide:function(){this._hide(!0)},init:function(){var e,n,i,r,o,a,l,s,d,c=this,u=c.$ele=c.that.$toolPanel;c.isVisible()&&!c.getInit()&&(i=(n=(e=c.that).options).toolPanel,r=n.groupModel.pivot,o=" pq-pivot-label pq-bg-3 ",a=" pq-pivot-pane pq-border-1 ",l=c.isHideColPane(),s=i.hidePivotChkBox,d=c.clsSort,u.html(["<div class='pq-pivot-cols-all",a,"'>","<div class='",d,"' style='",s?"padding-top:0;":"","'></div>",s?"":["<div class='",o,"'>","<label><input type='checkbox' class='pq-pivot-checkbox' ",r?"checked":"","/>",n.strTP_pivot,"</label>","</div>"].join(""),"</div>","<div class='pq-pivot-rows",a,"' style='display:",i.hideRowPane?"none":"",";'>","<div deny='denyGroup' class='",d,"'></div>","<div class='",o,"'><span class='pq-icon'></span>",n.strTP_rowPane,"</div>","</div>","<div class='pq-pivot-cols",a,"' style='display:",l?"none":"",";'>","<div deny='denyPivot' class='",d,"'></div>","<div class='",o,"'><span class='pq-icon'></span>",n.strTP_colPane,"</div>","</div>","<div class='pq-pivot-vals",a,"' style='display:",i.hideAggPane?"none":"",";'>","<div deny='denyAgg' class='",d,"'></div>","<div class='",o,"'><span class='pq-icon'></span>",n.strTP_aggPane,"</div>","</div>"].join("")),c.$pivotChk=u.find(".pq-pivot-checkbox").on("click",c.onPivotChange(c,e)),c.$colsAll=u.find(".pq-pivot-cols-all>."+d),c.$colsPane=u.find(".pq-pivot-cols"),c.$cols=u.find(".pq-pivot-cols>."+d),c.$rows=u.find(".pq-pivot-rows>."+d),c.$aggs=u.find(".pq-pivot-vals>."+d).on("click contextmenu",c.onClick.bind(c)),e.on("refreshFull",c.setHt.bind(c)).on("groupOption",c.onGroupOption.bind(c)),setTimeout(function(){e.element&&(e.on("CMInit",c.onCMInit.bind(c)),c.render())}),c.setInit())},isHideColPane:function(){var e=this.that.options;return e.toolPanel.hideColPane||!e.groupModel.pivot},isDeny:function(e,n,i){return n=n.attr("deny"),this.that.iGroup.getColsPrimary()[i[0].dataset.di][n]},isVisible:function(){return this.$ele.is(":visible")},onCMInit:function(e,n){n.pivot||n.flex||n.group||this.that.Group().isPivot()||this.refresh()},onClick:function(n){var i,r=e(n.target),o=this,n=o.that;if(r.hasClass("pq-pivot-col"))return i=r[0].dataset.di,i=n.iGroup.getColsPrimary()[i],n={dataModel:{data:n.iGroup.getAggOptions(i.dataType).sort().map(function(e){return[e]})},cellClick:function(e,n){var n=n.rowData[0],i=this;r.attr("type",n),setTimeout(function(){i.destroy(),o.refreshGrid(),o.refresh()})}},pq.Select(n,r),!1},onGroupOption:function(e,n){var i;"tp"!=n.source&&(n=n.oldGM,(i=this.that.options.groupModel).groupCols==n.groupCols&&i.agg==n.agg&&i.dataIndx==n.dataIndx&&i.pivot==n.pivot||this.refresh())},onPivotChange:function(e,n){return function(){var i={pivot:!!this.checked};n.Group().option(i,null,"tp"),e.showHideColPane()}},ph:function(e){return"<span style='color:#999;margin:1px;display:inline-block;'>"+e+"</span>"},refreshGrid:function(){var e=this,n=e.that,i=e.getArray(e.$cols),r=e.getObj(e.$aggs),o=e.getArray(e.$rows);n.Group().option({groupCols:i,dataIndx:o,agg:r},null,"tp"),setTimeout(function(){e.refresh()})},onReceive:function(e,n){if(this.getSortCancel())return this.setSortCancel(!1);this.refreshGrid()},onOver:function(n){return function(i,r){var o=e(this),a=r.item,l=a.parent(),s="removeClass",l=l[0]!=o[0]&&n.isDeny(l,o,a);r.helper.find(".ui-icon")[l?"addClass":s]("ui-icon-closethick")[l?s:"addClass"]("ui-icon-check")}},onStop:function(n){return function(i,r){var o=e(this),r=r.item,a=r.parent();o[0]!=a[0]&&n.isDeny(o,a,r)&&(o.sortable("cancel"),n.setSortCancel(!0))}},onTimer:function(e,i){clearTimeout(n);var r=this;n=setTimeout(function(){r.onReceive(e,i)})},refresh:function(){this.that.element.is(":visible")?(this.setHtml(),e(this.panes).sortable("refresh")):this.pendingRefresh=!0},render:function(){var n=this,i="."+n.clsSort,r=n.that;r.element&&(n.panes=[n.$colsAll,n.$cols,n.$rows,n.$aggs],n.setHtml(),e(n.panes).sortable({appendTo:n.$ele,connectWith:i,containment:n.$ele,cursor:"move",items:"> .pq-pivot-col:not('.pq-deny-drag')",helper:function(e,n){return n.clone(!0).css({opacity:"0.8"}).prepend("<span class='ui-icon-check ui-icon'></span>")},receive:n.onTimer.bind(n),stop:n.onStop(n),over:n.onOver(n),update:n.onTimer.bind(n),tolerance:"pointer"}),r._trigger("tpRender"))},setHtml:function(){var e,n,i=this,r=i.that,o=[],a=[],l=[],s=[],d=i.template,c=i.templateVals,u={},h=r.options,r=r.iGroup,f=r.getColsPrimary(),p=r.getCMPrimary(),r=h.groupModel,g=r.dataIndx,m=r.groupCols,v=0,$=p.length,x=i.$pivotChk[0];for(g.concat(m).forEach(function(e){u[e]=1}),x&&(x.checked=r.pivot),i.showHideColPane();v<$;v++)n=(e=p[v]).dataIndx,e.tpHide||u[n]||(e.summary&&e.summary.type?s.push(c(n,e)):o.push(d(n,e)));g.forEach(function(e){l.push(d(e,f[e]))}),m.forEach(function(e){a.push(d(e,f[e]))}),i.$colsAll.html(o.join("")),i.$rows.html(l.join("")||i.ph(h.strTP_rowPH)),i.$cols.html(a.join("")||i.ph(h.strTP_colPH)),i.$aggs.html(s.join("")||i.ph(h.strTP_aggPH))},setAttrPanes:function(){this.$ele.attr("panes",this.panes.filter(function(e){return e.is(":visible")}).length)},setHt:function(){this.$ele.height(this.$ele.parent()[0].offsetHeight),this.pendingRefresh&&(this.pendingRefresh=!1,this.refresh())},setSortCancel:function(e){this._sortCancel=e},setInit:function(){this._inited=!0},show:function(){this._hide(!1)},showHideColPane:function(){this.$colsPane.css("display",this.isHideColPane()?"none":""),this.setAttrPanes()},template:function(e,n){return["<div data-di='",e,"' class='pq-pivot-col pq-border-2 ",n.tpCls||"","'>",n.title,"</div>"].join("")},templateVals:function(e,n){var i=n.summary.type;return["<div data-di='",e,"' type='",i,"' class='pq-pivot-col pq-border-2 ",n.tpCls||"","'>",i,"(",n.title,")</div>"].join("")},toggle:function(){this._hide(this.isVisible())}}}(jQuery),function(e){function n(e){this.that=e,this.rtl=e.options.rtl,e.on("headerCellClick",this.onHeadCellClick.bind(this)).on("destroy",this.onDestroy.bind(this))}e.paramquery,e(document).on("pqGrid:bootup",function(e,i){var r=i.instance;r.iHeaderMenu=new n(r),r.HeaderMenu=function(){return r.iHeaderMenu}}),n.prototype={close:function(){this.$popup.remove(),this.$popup=null},popup:function(){return this.$popup},openFilterTab:function(){var e=this.$popup.find("a[href='tabs-filter']").closest("li").index();return this.$tabs.tabs("option","active",e),this.filterMenu},FilterMenu:function(){return this.filterMenu},getCM:function(){var e=this.that.options.strSelectAll||"Select All",n=this.nested;return[{editor:!1,dataIndx:"title",title:e,useLabel:!0,filter:{crules:[{condition:"contain"}]},type:n?null:"checkbox",cbId:n?null:"visible"},{hidden:!0,dataIndx:"visible",dataType:"bool",editable:function(e){return!e.rowData.pq_disable},cb:n?null:{header:!0}}]},getData:function(){var e=1,n=this,i=n.that,r=i.iRenderHead;return i.Columns().reduce(function(i){var o=this.getColIndx({column:i}),a=!i.hidden,l=i.childCount;if(!i.menuInHide&&!i.collapsible)return l&&(n.nested=!0),{visible:l?void 0:a,title:l?i.title:r.getTitle(i,o)||i.dataIndx,column:i,id:e++,pq_disable:i.menuInDisable,pq_close:i.menuInClose,colModel:l?i.colModel:void 0}})},getGridObj:function(){var n=this.that;return e.extend({dataModel:{data:this.getData()},rtl:n.options.rtl,colModel:this.getCM(),check:this.onChange.bind(this),treeExpand:this.onTreeExpand.bind(this),treeModel:this.nested?{dataIndx:"title",childstr:"colModel",checkbox:!0,checkboxHead:!0,cbId:"visible",cascade:!0,useLabel:!0}:void 0},n.options.menuUI.gridOptions)},onChange:function(e,n){var i,r;n.init||(i=[],r=[],(n.getCascadeList?n.getCascadeList():n.rows).forEach(function(e){var e=e.rowData,n=e.visible,e=e.column,o=e.dataIndx,e=e.colModel;e&&e.length||(n?i:r).push(o)}),this.that.Columns().hide({diShow:i,diHide:r}))},onDestroy:function(){var e=this.$popup;e&&e.remove(),delete this.$popup},onHeadCellClick:function(n,i){var r=e(n.originalEvent.target);return r.hasClass("pq-filter-icon")?this.onFilterClick(n,i,r):r.hasClass("pq-menu-icon")?this.onMenuClick(n,i,r):null==this.that.getColModel().find(function(e){return!e.hidden})?this.onMenuClick(n,i):void 0},getMenuHtml:function(e){var n={hideCols:"visible",filter:"filter"},i=e.map(function(e){return['<li><a href="#tabs-',e,'"><span class="pq-tab-',n[e],'-icon">&nbsp;</span></a></li>'].join("")}).join(""),e=e.map(function(e){return'<div id="tabs-'+e+'"></div>'}).join("");return["<div class='pq-head-menu pq-theme' dir='",this.rtl?"rtl":"ltr","'>","<div class='pq-tabs' style='border-width:0;'>","<ul>",i,"</ul>",e,"</div>","</div>"].join("")},getMenuH:function(n,i){return e.extend({},n.menuUI,i.menuUI)},open:function(n,i,r){var o,a,l=this,s=l.that,s=(i=i||s.getCellHeader({dataIndx:n}),n=null!=n?(o=s.columns[n],(l.menuH=l.getMenuH(s.options,o)).tabs):["hideCols"],l.$popup=e(l.getMenuHtml(n)).appendTo(s.$header)),d=l.$tabs=s.find(".pq-tabs");return -1<n.indexOf("hideCols")&&(a=l.$grid=e("<div/>").appendTo(s.find("#tabs-hideCols")),l.grid=pq.grid(a,l.getGridObj())),-1<n.indexOf("filter")&&l.appendFilter(s.find("#tabs-filter"),o),pq.makePopup(l.$popup[0]),d.tabs({active:localStorage["pq-menu-tab"]||1,activate:function(n,i){localStorage["pq-menu-tab"]=e(this).tabs("option","active"),e(i.newPanel).find(".pq-grid").pqGrid("refresh")}}),s.resizable({handles:"e,w",maxWidth:600,minWidth:220}),s.position({my:"left top",at:"left bottom",of:r||i}),this},onMenuClick:function(e,n,i){return this.open(n.dataIndx,e,i),!1},onTreeExpand:function(e,n){n.nodes.forEach(function(e){e.column.menuInClose=n.close})},appendFilter:function(n,i,r){var o=this,a=o.that,n=e("<div class='pq-filter-menu pq-theme'/>").appendTo(n),l=o.$popup||n,s=o.filterMenu=new pq.cFilterMenu,r={filterRow:r,grid:a,column:i,$popup:l,menuH:this.menuH||this.getMenuH(a.options,i)};return s.init(r),a=s.getHtml(),n.html(a),s.ready(n.children().get()),s.addEvents(),l.on("remove",function(){o.$popup=o.filterMenu=null}),n},onFilterClick:function(e,n,i){return n=this.$popup=this.appendFilter(this.that.$header,n.column,!0),pq.makePopup(n[0]),n.position({my:"left top",at:"left bottom",of:i}),!1}}}(jQuery),function(e){var n=pq.cFilterMenu=function(){};(n.select=function(e,n){this.that=e,this.di1="selected",this.grid=null,this.column=n}).prototype={change:function(e){this.onChange(e).call(this.grid)},create:function(n,i,r){function o(e){var n=i[e];n&&n.call(a,l),a._trigger(e,null,l)}var a=this.that,r=this.getGridObj(i,r),l=e.extend({obj:r,column:this.column},i);return o("selectGridObj"),r.rtl=a.options.rtl,l.grid=this.grid=pq.grid(n,r),o("selectGridCreated"),this.grid},getCM:function(n,i,r,o,a,l){var s=n.dataIndx,l=e.extend({filter:{crules:[{condition:"contain"}]},align:"left",format:l.format||n.format,deFormat:n.deFormat,title:n.pq_title||n.title,dataType:n.dataType,dataIndx:s,editor:!1,useLabel:!0,renderLabel:this.getRenderLbl(o,s,this.that.options.strBlanks)},r?{}:{type:"checkbox",cbId:i});return r?[l,{dataIndx:i,dataType:"bool",hidden:!0},{dataIndx:r,hidden:!0}]:[l,{dataIndx:i,dataType:"bool",hidden:!0,cb:{header:!a,maxCheck:a}}]},getData:function(n,i){var r=this.column,o=this.that,a={},l=this.di1,s=r.dataIndx,d=n.maxCheck,i=pq.filter.getVal(i)[0],r=pq.filter.getOptions(r,n,o,!0);return e.isArray(i)?d&&(i=i.slice(0,d)):i=1==d?[i]:[],i.forEach(function(e){a[e]=!0}),i.length?r.forEach(function(e){e[l]=a[e[s]]}):r.forEach(function(e){e[l]=!d}),r},getGridObj:function(n,i){var r=this.column,o=this.that.options,a=r.filter,l="gridOptions",s=n.groupIndx,d=n.maxCheck,c=this.di1,a=this.getData(n,a),u=a&&a.length&&null!=a[0].pq_label?"pq_label":n.labelIndx;return this.filterUI=n,e.extend({colModel:this.getCM(r,c,s,u,d,n),check:this.onChange(!i),filterModel:"bool"===r.dataType?{}:void 0,groupModel:s?{on:!0,dataIndx:s?[s]:[],titleInFirstCol:!0,fixCols:!1,indent:18,checkbox:!0,select:!1,checkboxHead:!d,cascade:!d,maxCheck:d,cbId:c}:{},dataModel:{data:a}},o.menuUI[l],o.filterModel[l],n[l])},getRenderLbl:function(e,n,i){return e===n&&(e=void 0),function(r){var r=r.rowData,o=r[e];return o||""!==r[n]?o:i}},onChange:function(e){var n=this,i=n.filterUI,r=(i.maxCheck,i.condition);return function(){var i,o,a,l,s;e&&(i=!1,o=n.column.dataIndx,a=n.di1,l=n.that,s=this.getData().filter(function(e){return(e=e[a])||(i=!0),e}).map(function(e){return e[o]}),i?l.filter({oper:"add",rule:{dataIndx:o,condition:r,value:s}}):l.filter({rule:{dataIndx:o,condition:r,value:[]}}),n.refreshRowFilter())}},refreshRowFilter:function(){this.that.iRenderHead.postRenderCell(this.column)}},n.prototype={addEvents:function(){var e=this;e.$sel0.on("change",e.onSel1Change.bind(e)),e.$sel1.on("change",e.onSel2Change.bind(e)),e.$filter_mode.on("change",e.onModeChange.bind(e)),e.$clear.button().on("click",e.clear.bind(e)),e.$ok.button().on("click",e.ok.bind(e))},addEventsInput:function(){this.$inp&&(this.$inp.filter("[type='checkbox']").off("click").on("click",this.onInput.bind(this)),this.$inp.filter("[type='text']").off("keyup").on("keyup",this.onInput.bind(this)))},clear:function(){var e=this.that,n=this.column,i=this.cond0,r=this.getType(i),n=n.dataIndx;e.filter({rule:{dataIndx:n,condition:r?i:void 0},oper:"remove"}),this.refreshRowFilter(),this.ready()},close:function(){this.$popup.remove()},filterByCond:function(e){var n,i,r,o,a,l,s,d=this,c=d.that,u=d.column.dataIndx,h=d.cond0,f=""===h,p=d.cond1,g=d.filterRow;d.showHide(h,p),g||(n=d.getModeVal(),i=d.getType(h),r=(o=d.getVal(0))[0],o=o[1],a=(l=d.getVal(1))[0],l=l[1],s=d.$gridR),"select"==i?(e&&c.filter({oper:"add",rule:{dataIndx:u,condition:h,value:[]}}),g||d.iRange.create(s,d.filterUI[0],d.btnOk)):e&&c.filter({oper:f?"remove":"add",rule:{dataIndx:u,mode:n,crules:[{condition:h,value:r,value2:o},{condition:p,value:a,value2:l}]}})},getBtnOk:function(){return this.$ok},getInp:function(e){return this["$inp"+e]},getSel:function(e){return this["$sel"+e]},getBtnClear:function(){return this.$clear},getHtmlInput:function(e){var n=this.column.dataIndx,e=this.filterUI[e<2?0:1];return"<input type='"+("checkbox"==e.type?"checkbox":"text")+"' "+["name='",n,"' class='",e.cls||"","' style='width:100%;",e.style||"","display:none;' ",e.attr||""].join("")+" />"},getHtml:function(){function e(e,i){return["<div style='margin:0 auto 4px;'>",n.getHtmlInput(e),"</div>","<div style='margin:0 auto 4px;'>",n.getHtmlInput(i),"</div>"].join("")}var n=this,i=n.column.filter,r=n.menuH,o=i.crules||[],i=o[0]||i,o=o[1]||{},a=n.that.options,i=n.cond0=i.condition,o=n.cond1=o.condition,l=n.filterRow,s=(n.readFilterUI(),pq.filter.getConditionsCol(this.column,n.filterUI[0]));return["<div style='padding:4px;'>","<div style='margin:0 auto 4px;'>",a.strCondition," <select>",this.getOptionStr(s,i),"</select></div>",l?"":["<div>",e(0,1),"<div data-rel='grid' style='display:none;'></div>",r.singleFilter?"":["<div class='filter_mode_div' style='text-align:center;display:none;margin:4px 0 4px;'>","<label><input type='radio' name='pq_filter_mode' value='AND'/>AND</label>&nbsp;","<label><input type='radio' name='pq_filter_mode' value='OR'/>OR</label>","</div>","<div style='margin:0 auto 4px;'><select>",this.getOptionStr(s,o,!0),"</select></div>",e(2,3)].join(""),"</div>"].join(""),"<div style='margin:4px 0 0;'>",r.buttons.map(function(e){return"<button data-rel='"+e+"' type='button' style='width:calc(50% - 4px);margin:2px;' >"+(a["str"+pq.cap1(e)]||e)+"</button>"}).join(""),"</div>","</div>"].join("")},getMode:function(e){var n=this.$filter_mode;return 0<=e?n[e]:n},getModeVal:function(){return this.$filter_mode.filter(":checked").val()},getOptionStr:function(e,n,i){var e=[""].concat(e),r=this,o=r.that.options.strConditions||{};return(e=i?e.filter(function(e){return"select"!=r.getType(e)}):e).map(function(e){return'<option value="'+e+'" '+(n==e?"selected":"")+">"+(o[e]||e)+"</option>"}).join("")},getType:function(e){return pq.filter.getType(e,this.column)},getVal:function(e){var n,i,r=this.column,o=this["cond"+e],a=this["$inp"+(e?"2":"0")],l=a[0],e=this["$inp"+(e?"3":"1")];return a.is("[type='checkbox']")?(i=l.indeterminate,i=!!l.checked||!!i&&null):(a.is(":visible")&&(i=pq.deFormat(r,a.val(),o)),e.is(":visible")&&(n=pq.deFormat(r,e.val(),o))),[i,n]},init:function(e){var n=this.column=e.column;n.filter=n.filter||{},this.that=e.grid,this.menuH=e.menuH,this.$popup=e.$popup,this.filterRow=e.filterRow},initControls:function(){var n=this.filterUI[0],i=this.that,r={column:this.column,headMenu:!0};r.$editor=e([this.$inp0[0],this.$inp1[0]]),r.condition=this.cond0,r.type=n.type,(r.filterUI=n).init.find(function(e){return e.call(i,r)}),n=this.filterUI[1],r.$editor=e([this.$inp2[0],this.$inp3[0]]),r.condition=this.cond1,r.type=n.type,(r.filterUI=n).init.find(function(e){return e.call(i,r)})},isInputHidden:function(e){if("select"==e||!e)return!0},ok:function(){var e=this.cond0;"select"!=this.getType(e)||this.filterRow?e&&this.filterByCond(!0):this.iRange.change(!0),this.close(),this.refreshRowFilter()},onModeChange:function(){this.filterByCond(!this.btnOk)},onInput:function(n){var n=e(n.target),i=!this.btnOk;n.is(":checkbox")&&n.pqval({incr:!0}),this.filterByCond(i),i&&this.refreshRowFilter()},onSel1Change:function(){var e=!this.btnOk;this.cond0=this.getSel(0).val(),this.readFilterUI(),this.filterRow||(this.$inp0.replaceWith(this.getHtmlInput(0)),this.$inp1.replaceWith(this.getHtmlInput(1)),this.refreshInputVarsAndEvents(),this.initControls()),this.filterByCond(e),this.refreshRowFilter()},onSel2Change:function(){this.cond1=this.getSel(1).val(),this.readFilterUI(),this.$inp2.replaceWith(this.getHtmlInput(2)),this.$inp3.replaceWith(this.getHtmlInput(3)),this.refreshInputVarsAndEvents(),this.initControls(),this.filterByCond(!this.btnOk)},ready:function(n){this.node=n=n||this.node;var i,n=e(n),r=this,o=r.that,a=r.column,l=a.filter,s=l.crules||[],d=s[0]||l,s=s[1]||{},c=r.cond0=d.condition,u=r.cond1=s.condition,h=r.readFilterUI();r.iRange=new pq.cFilterMenu.select(o,a),o=r.getType(c),a=r.getType(u),i=r.$select=n.find("select"),r.$sel0=e(i[0]).val(c),r.$sel1=e(i[1]).val(u),r.$filter_mode=n.find('[name="pq_filter_mode"]'),r.$clear=n.find("[data-rel='clear']"),r.$ok=n.find("[data-rel='ok']"),r.btnOk=r.$ok.length,r.filterRow||(r.refreshInputVarsAndEvents(),r.$gridR=n.find("[data-rel='grid']"),r.$filter_mode.filter("[value="+l.mode+"]").attr("checked","checked"),r.$filter_mode_div=n.find(".filter_mode_div"),r.showHide(c,u),"select"==o?r.iRange.create(r.$gridR,h[0],r.btnOk):r.readyInput(0,o,d),r.readyInput(1,a,s),r.initControls())},readyInput:function(e,n,i){var r=this.column,o=this["cond"+e],a=this["$inp"+(e?"2":"0")],e=this["$inp"+(e?"3":"1")];a.is(":checkbox")&&a.pqval({val:i.value}),a.val(pq.formatEx(r,i.value,o)),"textbox2"==n&&e.val(pq.formatEx(r,i.value2,o))},readFilterUI:function(){var e=this.filterUI=[],n=this.that,i={column:this.column,condition:this.cond0,indx:0,headMenu:!0};return e[0]=pq.filter.getFilterUI(i,n),i.condition=this.cond1,e[i.indx=1]=pq.filter.getFilterUI(i,n),e},refreshInputVarsAndEvents:function(){var n=this.column,n=this.$inp=e(this.node).find("input[name='"+n.dataIndx+"']:not(.pq-search-txt)"),i=n[0],r=n[1],o=n[2],n=n[3];this.$inp0=e(i),this.$inp1=e(r),this.$inp2=e(o),this.$inp3=e(n),this.addEventsInput()},refreshRowFilter:function(){this.that.refreshHeaderFilter({dataIndx:this.column.dataIndx})},SelectGrid:function(){return this.$gridR.pqGrid("instance")},showHide:function(e,n){var i,r,o,a,l;this.filterRow||(r=(i=this).$filter_mode_div,o=i.$sel1,a=i.getType(e),l=i.$inp,"select"===a?(i.$gridR.show(),i.$gridR.hasClass("pq-grid")&&i.$gridR.pqGrid("destroy"),l.hide(),r.hide(),o.hide()):(i.$gridR.hide(),e?(i.$inp0[i.isInputHidden(a)?"hide":"show"](),i.$inp1["textbox2"===a?"show":"hide"](),r.show(),o.show(),n?(e=i.getType(n),i.$inp2[i.isInputHidden(e)?"hide":"show"](),i.$inp3["textbox2"===e?"show":"hide"]()):(i.$inp2.hide(),i.$inp3.hide())):(l.hide(),r.hide(),o.hide())))},updateConditions:function(){var e=this.column.filter;e.crules=e.crules||[{}],e.crules[0].condition=this.cond0,this.cond1&&(e.crules[1]=e.crules[1]||{},e.crules[1].condition=this.cond1)}}}(jQuery),function(e){var n=e.paramquery;e(document).on("pqGrid:bootup",function(e,i){new n.cEditor(i.instance)}),n.cEditor=function(e){var n=this,i=n.setDims.bind(n);(n.that=e).on("editorBeginDone",function(r,o){o.$td.addClass("pq-edited"),n.ui=o,n.setStyle(o),n.setDims();var a=(o.column.editor||e.options.editor||{}).init;a&&e.callFn(a,o),"grid"!=o.editor.appendTo&&e.on("assignTblDims scroll",i)}).on("editorEnd",function(r,o){o.$td.removeClass("pq-edited"),e.off("assignTblDims scroll",i),delete n.ui})},n.cEditor.prototype={setStyle:function(e){var n=e.$td,i=n.children("div"),r=n.css("background-color"),r={fontSize:n.css("font-size"),fontFamily:n.css("font-family"),backgroundColor:r,color:n.css("color")};r.padding=parseInt(i.css("padding-top"))+0+"px "+(parseInt(i.css("padding-right"))+0)+"px",e.$editor.css(r)},setDims:function(){var n,i,r,o,a=this.ui,l=this.that,s=a.rowIndxPage,d=a.colIndx,c=a.$td,u=c[0],h=l.iRenderB,f=(h.htContTop,h.wdContLeft),p=h.$cright[0],g=h.getCellCont(s,d)[0],m=h.getCellRegion(s,d),v=0,m=("right"==m&&(v=f),"tr"==m&&(v=f),a.$editor),f="textarea"==m[0].type,$="true"==m[0].contentEditable,x=m.closest(".pq-editor-outer"),w=(h.getCellCoords(s,d),l.options),y=w.rtl,C=y?"right":"left",c=c.offset(),_=u.offsetWidth,u=u.offsetHeight,b=c.left,c=c.top,I=b+_,q=a.column,w=e.extend({},w.editModel,q.editModel),q=x.parent(),R=q.offset(),D=R.left,R=R.top,q=q[0],M=q.offsetWidth,M=v<(M=y?D+M-I:b-D)?M:v,I=_-2,b=u-2,D={minWidth:I};q==l.element[0]?(n={top:i=c-R})[C]=M:(_=(v=h.getCellCoords(s,d))[0],i=v[1]+1-g.scrollTop,M=_+1-(y?-1:1)*g.scrollLeft,r=p.clientHeight-i,o=p.clientWidth-M,D.maxHeight=r,D.maxWidth=o,(n={top:i})[C]=M),x.css(n),I=o<I?o:I,D.minHeight=b=r<b?r:b,D.width=I,f&&(m.attr("rows")&&(D.maxHeight=D.minHeight=void 0),m.attr("columns")&&(D.maxWidth=D.minWidth=D.width=void 0)),m.css(e.extend(D,pq.styleObj(a.editor.style))),$&&m.pqContent(w.saveKey!=e.ui.keyCode.ENTER)}}}(jQuery),function(e){var n=e.paramquery,i=pq.grid,r=n.cProxy=function(e){(this.that=e).options.reactive&&this.init()};e(document).on("pqGrid:bootup",function(e,n){(n=n.instance).iProxy=new r(n)}),pq.isEqual=function(e,n){if(pq.isObject(e)){for(var i in e)if(!pq.isEqual(e[i],n[i]))return!1;return!0}return e===n},pq.grid=function(e,n){var r=i.apply(pq,arguments),o=r.iProxy,a=r.options;return a.reactive&&(r.on("filter",function(){n.dataModel&&(n.dataModel.data=a.dataModel.data),o.prxData()}),o.prxObj(n,o.onOption,!0)),r},r.prototype={init:function(){var e=this.that;this.prxData(),this.prxCM(),e.on("refresh",this.clear.bind(this)).on("dataReady",this.clearV.bind(this)).on("dataAvailable",this.clearDV.bind(this))},onOption:function(e,n){var i,r=this.that,o={},a=r.options;if(o[e]=n,r.element&&!pq.isEqual(o,a)){if(this.refresh(),pq.isObject(a[e])){if("groupModel"==e)r.Group().option(n,!1),this.refreshView();else if("treeModel"==e)r.Tree().option(n);else if("sortModel"==e)r.sort(n);else for(i in"dataModel"==e?(n.data&&this.prxData(n.data),this.refreshDataView()):"pageModel"==e&&(n.rPP||null!=n.type)&&this.refreshDataView(),n)r.option(e+"."+i,n[i])}else"colModel"==e?this.prxCM(n):"mergeCells"==e&&this.refreshView(),r.option(e,n)}},onCMChange:function(){var e=this,n=e.that;clearTimeout(e.CMtimer),e.CMtimer=setTimeout(function(){n.refreshCM(),e.refresh()}),n.one("CMInit",function(){clearTimeout(e.CMtimer)})},prxCM:function(e){var n=this,i=n.that,e=e||i.options.colModel;e&&(n.prxArray(e,n.onCMChange.bind(n)),e.forEach(function(e){e.colModel&&n.prxCM(e.colModel)}))},prxData:function(e){var n=this,i=n.that,e=e||i.options.dataModel.data;e&&n.prxArray(e,function(){clearTimeout(n.datatimer),n.datatimer=setTimeout(function(){n.refreshView()}),i.one("dataReady",function(){clearTimeout(n.datatimer)})})},prxArray:function(e,n){var i=this,r=Array.prototype;"pop push reverse shift sort splice unshift".split(" ").forEach(function(o){e[o]=function(){var a=arguments,l="splice"==o,s=Object.getPrototypeOf(e)[o].apply(this,a);return("push"==o||l||"unshift"==o)&&i.prxArrayObjs(l?r.slice.call(a,2):a),n.call(i),s}}),i.prxArrayObjs(e)},prxArrayObjs:function(e){for(var n=0,i=e.length;n<i;n++)this.prxObj(e[n])},prxObj:function(e,n,i,r){if(pq.isObject(e)&&"tabModel"!=r){var o,a,l="pq_proxy";for(a in e[l]||Object.defineProperty(e,l,{value:{},enumerable:!1}),(o=e[l]).__self=this,e)"pq_"!=a.substr(0,3)&&(i&&!r&&pq.isObject(e[a])&&this.prxObj(e[a],n,i,a),o.hasOwnProperty(a)||(Object.defineProperty(o,a,Object.getOwnPropertyDescriptor(e,a)),this.defineProp(e,o,a,n,i,r)))}},defineProp:function(e,n,i,r,o,a){Object.defineProperty(e,i,{get:function(){return n[i]},set:function(e){var l,s=n.__self;o&&!a&&pq.isObject(e)&&s.prxObj(e,r,o,i),n[i]=e,r?(l=e,a&&((l={})[i]=e),r.call(s,a||i,l)):s.refresh()},enumerable:!0})},clear:function(){clearTimeout(this.timer)},clearV:function(){this.clear(),clearTimeout(this.timerV)},clearDV:function(){this.clearV(),clearTimeout(this.timerDV)},X:function(e,n){var i=this;i[n]=setTimeout(function(){i.that.element&&i.that[e]()})},refresh:function(){this.clear(),this.X("refresh","timer")},refreshView:function(){this.clearV(),this.X("refreshView","timerV")},refreshDataView:function(){this.clearDV(),this.X("refreshDataAndView","timerDV")}}}(jQuery),function(e){e.widget("pq.drag",e.ui.mouse,{_create:function(){this._mouseInit()},_mouseCapture:function(e){return this._trigger("capture",e),!0},_mouseStart:function(e){return this._trigger("start",e),!0},_mouseDrag:function(e){this._trigger("drag",e)},_mouseStop:function(e){this._trigger("stop",e)}})}(jQuery),function(e){e(document).on("pqGrid:bootup",function(e,i){var r=i.instance;r.iPic=new n(r),r.Pic=function(){return r.iPic}});var n=e.paramquery.cPic=function(e){var n=this,i=e.options,r=n.rtl=i.rtl;n.id=0,n.left=r?"right":"left",n.pics=[],(n.that=e).on("dataAvailable",function(r,o){"filter"!=o.source&&(n.reset(),e.one("refresh",function(){n.addPics(i.pics)}))}).on("assignTblDims",n.refresh.bind(n))};n.prototype={addPics:function(e){var n=this;(e||[]).forEach(function(e){n.add(e.name,e.src,e.from,e.to,e.cx,e.cy,!0)})},create:function(n,i,r,o,a,l,s,d,c){var u=this,h=new Image,o={position:"absolute",top:o,zIndex:5},f=e(h);h.src=i,o[u.left]=r,n.append(h),(i=f.attr({draggable:!1,"pic-id":c,tabindex:1}).css({height:l,width:a,cursor:"move"}).on("focus",function(){e(d).css({outline:"2px dotted #999"})}).on("keydown",function(n){n.keyCode==e.ui.keyCode.DELETE&&u.remove(u.getId(this))}).on("blur",function(){e(d).css({outline:""})}).resizable({resize:u.onResize(u,d,s)}).parent(".ui-wrapper").css(o)).find(".ui-resizable-se").removeClass("ui-icon"),r=u.drag(i,d,s),f.drag({distance:3,capture:function(){f.focus()},start:r.start,drag:r.drag,stop:r.stop}),d.push(i[0])},drag:function(n,i,r){function o(e){return parseInt(n.css(e))}var a,l=this,s=l.that,d=s.iRenderB,c=r.cx,u=r.cy,h=d.leftArr,f=d.topArr,p=h[h.length-1],g=f[f.length-1],m=d.numColWd;return{start:function(e){a={pageX:e.pageX,pageY:e.pageY,scrollX:s.scrollX(),scrollY:s.scrollY()}},drag:function(n){var r=s.scrollX(),d=s.scrollY(),h=(n.pageX+r-a.pageX-a.scrollX)*(l.rtl?-1:1),f=n.pageY+d-a.pageY-a.scrollY,v=o(l.left),$=o("top"),x={};a.pageX=n.pageX,a.scrollX=r,a.pageY=n.pageY,a.scrollY=d,v+h-m<0?h=m-v:p+m<v+h+c&&(h=p+m-v-c),$+f<0?f=0-$:g<$+h+u&&(f=g-$-u),x.top=$+f,x[l.left]=v+h,e(i).css(x)},stop:function(){var e=o(l.left)-m,n=o("top"),i=l.findIndx(h,e),a=l.findIndx(f,n);r.from=[i,e-h[i],a,n-f[a]]}}},onResize:function(n,i,r){return function(n,o){var a=o.size.height,o=o.size.width,l={height:a,width:o};e(i).css(l),e(i).find("img").css(l),delete r.to,r.cx=o,r.cy=a}},getPos:function(e){var n=this.that.iRenderB,i=+e[2],r=+e[0],n=n.getCellXY(i,r);return[n[0]+e[1],n[1]+e[3]]},name:function(e){return e.replace(/[^0-9,a-z,A-Z,_\.]/g,"_")},refresh:function(){var e=this,n=e.that.widget();e.pics.forEach(function(i){var r=i.from,i=i.id,r=e.getPos(r),o=r[0],r={top:r[1]},i=n.find("[pic-id="+i+"]").parent();r[e.left]=o,i.css(r)})},add:function(e,n,i,r,o,a,l){var s,d,c,u,h,f,p,g,m,v,$,x=this;if(n)return"data:"!=n.substr(0,5)?(e=e||n.split("/").pop(),pq.urlToBase(n,function(n){x.add(e,n,i,r,o,a,l)})):(d=(s=x.that).iRenderB,c=(h=x.getPos(i))[0],u=h[1],g=[],m=x.id++,$=function(o,a){(p={name:e,src:n,get from(){var h=this._from;return[s.getColIndx({column:h[0]}),h[1],h[2].pq_ri,h[3]]},set from(t){this._from=[s.colModel[t[0]],t[1],s.getRowData({rowIndx:t[2]}),t[3]]},cx:o,cy:a,id:m}).from=i,["$cright","$cleft","$clt","$ctr"].forEach(function(e){x.create(d[e],n,c,u,o,a,p,g,m)}),x.pics.push(p),l||s.iHistory.push({callback:function(l){l?m=x.add(e,n,i,r,o,a,!0):x.remove(m,!0)}}),s._trigger("picAdd")},r&&r.length?(h=r[0],f=r[2],$((h=(f=d.getCellXY(f,h))[0]+r[1])-c,(f=f[1]+r[3])-u)):a?$(o,a):((v=new Image).onload=function(){$(v.width,v.height)},v.src=n)),m},findIndx:function(e,n){return e.findIndex(function(e){return n<e})-1},getId:function(n){return e(n).attr("pic-id")},remove:function(e,n){var i,r=this,o=r.that,a=r.pics.findIndex(function(n){return n.id==e});o.widget().find("[pic-id="+e+"]").remove(),i=r.pics.splice(a,1)[0],n||o.iHistory.push({callback:function(n){n?r.remove(e,!0):e=r.add(i.name,i.src,i.from,i.to,i.cx,i.cy,!0)}})},reset:function(){this.that.widget().find("[pic-id]").remove(),this.pics.length=0,this.id=0}}}(jQuery),function(e){var n,i,r,o,a=e.fn.val;function l(){return window.getSelection()}function s(){return document.createRange()}function d(e){function n(){var e=document.createElement("br");r.insertNode(e),r.setStartAfter(e)}var i=e.childNodes,r=l().getRangeAt(0),o=r.startContainer,a=r.startOffset;i.length&&(o!=e||3!=i[a-1].nodeType)&&(3!=o.nodeType||o.textContent.length!=a||null!=o.nextSibling)||n(),n()}function c(e){var n=l().getRangeAt(0),i=s();return n.startContainer==e?[n.startOffset,e]:(i.selectNodeContents(e),i.setEnd(n.startContainer,n.startOffset),[i.toString().length])}function u(){n[++o]={indx:c(i),dom:i.cloneNode(!0)}}function h(){(function i(r,a){var l,s;if(n[o])return r=e(r.childNodes).toArray(),l=e(n[o].dom.childNodes).toArray(),s=!1,r.length!=l.length||(r.forEach(function(e,n){s||(n=l[n],e.nodeName!=n.nodeName||3==e.nodeType&&e.nodeValue.split(/\s/).length!=n.nodeValue.split(/\s/).length?s=!0:e.childNodes&&e.childNodes.length&&(s=i(e,n)))}),s)})(i)?u():(n[o].dom=i.cloneNode(!0),n[o].indx=c(i))}e.fn.val=function(n){var i,o,d,c=this[0];return c&&"true"==c.contentEditable?arguments.length?void(null!=n&&(c.innerHTML=(n+"").replace(/\n/g,"<br>"),i=c,o=l(),d=s(),i.lastChild&&(o.removeAllRanges(),d.setStartAfter(i.lastChild),o.addRange(d)))):(i=c.innerHTML,"html"==r?i:(i=i.replace(/<br>/g,"\n"),e("<p>").html(i).text())):a.apply(this,arguments)},e.fn.pqContent=function(a){var c=i=this[0],f="pq-content";this.hasClass(f)||(r=this.attr("dataType"),n=[],o=-1,this.addClass(f).attr("spellcheck",!1).on("keydown",function(f){var p,g,m,v;if(n.length||u(),13!=f.keyCode||r&&0!=r.indexOf("string")&&"html"!=r?f.ctrlKey&&(90==f.keyCode?(0<o&&(o--,p=1),m=1):89==f.keyCode&&(o<n.length-1&&(o++,p=1),m=1),p&&(v=(g=n[o]).dom.childNodes,i.innerHTML="",e(v).toArray().forEach(function(e){i.appendChild(e.cloneNode(!0))}),function n(i,r,o){if(o!=i)return e(i.childNodes).toArray().forEach(function(e){var i,o,a;0<=r&&("#TEXT"==e.nodeName.toUpperCase()?(i=e.textContent).length>=r?(o=s(),a=l(),o.setStart(e,r),o.collapse(!0),a.removeAllRanges(),a.addRange(o),r=-1):r-=i.length:r=n(e,r))}),r;var o=s(),a=l();o.setStart(i,r),o.collapse(!0),a.removeAllRanges(),a.addRange(o)}(c,g.indx[0],g.indx[1]))):((f.altKey||a)&&d(c),m=!0),p||h(),m)return!1}))}}(jQuery),function(e){e(document).on("pqGrid:bootup",function(e,i){var r=i.instance;r.iRowResize=new n(r),r.RowResize=function(){return r.iRowResize}});var n=e.paramquery.cRowResize=function(e){this.that=e,this.ht=8,e.options.rowResize&&e.on(!0,"cellMouseDown",this.onCellDown.bind(this)).on("cellMouseEnter",this.onCellEnter.bind(this))};n.prototype={onCellDown:function(n,i){if(-1==i.colIndx){var r=n.pageY,o=n.currentTarget,a=e(o);if(r>=a.offset().top+o.offsetHeight-this.ht)return this.createDrag(a,i),(r=e.Event("mousedown",n)).type="mousedown",a.trigger(r),!1;a.draggable("instance")&&a.draggable("destroy")}},onCellEnter:function(n,i){-1==i.colIndx&&(i="pq-row-resize",n=e(n.currentTarget),this.drag||n.find("."+i).length||n.append("<div class='"+i+"' style='position:absolute;height:"+(this.ht-1)+"px;bottom:0;left:0;width:100%;cursor:row-resize;'></div>"))},createDrag:function(n,i){var r,o=this,a=o.that,l=i.rowData,s=i.rowIndxPage,d=a.iRenderB,c=a.$cont,u="width:100%;background-color:#000;height:1px;";n.hasClass("ui-draggable")||n.on("dblclick",function(){delete l.pq_htfix,d.autoHeight({})}).draggable({axis:"y",cursor:"row-resize",cursorAt:{top:-2},start:function(n){o.drag=!0,r=n.pageY,o.$top=e("<div style='"+u+"position:absolute;top:"+(d.getTop(s)-d.scrollY())+"px;'></div>").appendTo(c)},helper:function(){return e("<div style='"+u+"'></div>").appendTo(c)},stop:function(e){o.drag=!1;var e=e.pageY-r,n=d.rowhtArr;o.$top.remove(),l.pq_ht=Math.max(n[s]+e,10),l.pq_htfix=!0,a.refresh()}})}}}(jQuery),function(e){var n=pq.cVirtual=function(){this.diffH=0,this.diffV=0};n.setSBDim=function(){var n=e("<div style='max-width:100px;height:100px;position:fixed;left:0;top:0;overflow:auto;visibility:hidden;'><div style='width:200px;height:100px;'></div></div>").appendTo(document.body),i=n[0];this.SBDIM=i.offsetHeight-i.clientHeight,n.remove()},n.prototype={assignTblDims:function(e){var n=this,i=n.isBody(),r=n.getTopSafe(this[e?"cols":"rows"],e,!0),o=n.maxHt,o=(o<r?(n[e?"ratioH":"ratioV"]=r/o,n[e?"virtualWd":"virtualHt"]=r,r=o):(r=r||(n.isHead()?0:1),n[e?"ratioH":"ratioV"]=1),n.$tbl_right[0]),a=n[e?"$tbl_tr":"$tbl_left"],a=a.length?a[0]:{style:{}},l=e?"width":"height";o.style[l]=r+"px",a.style[l]=r+"px",o=i?"Tbl":n.isHead()?"TblHead":"TblSum",!i&&e&&n.$spacer.css(n.rtl,r),n.dims[e?"wd"+o:"ht"+o]=r,i&&n.triggerTblDims(100)},calInitFinal:function(e,n,i){var r,o,a,l=this[i?"cols":"rows"],s=this[i?"freezeCols":"freezeRows"],d=this[i?"leftArr":"topArr"],c=this.getTopSafe(s,i);if(0==this.that.options[i?"virtualX":"virtualY"])return[s,l-1];if(s==l)return[0,s-1];if(i&&(c-=this.numColWd),e+=c,n+=c,s<l&&d[s]<e){for(var u,h=30,f=l;h--;)if(d[u=Math.floor((s+f)/2)]>=e)f=u;else{if(s==u){a=!0;break}s=u}if(!a)throw"ri not found"}for(;s<=l;s++)if(d[s]>e){r=s&&s-1;break}for(;s<=l;s++)if(d[s]>n){o=s-1;break}return null==r&&null==o&&l&&e>d[l-1]?[null,null]:[r=null==r?0:r,o=null==o?l-1:o]},calInitFinalSuper:function(){var e=this.dims||{},n=this.calcTopBottom(),i=n[0],r=n[1],n=n[2],o=this.calcTopBottom(!0),a=o[0],l=o[1],s=this.calInitFinal(i,r),d=s[0],s=s[1],c=this.calInitFinal(a,l,!0),u=c[0],c=c[1];return this.isBody()&&(e.bottom=r,e.top=i,e.left=a,e.right=l),[d,u,s,c,n||o[2]]},calcTopBottom:function(i){var r,o,a,l,s,d=this,c=d.isBody(),u=d.dims,h=d.virtualWin,f=d.$cright,p=f[0],f=i?(g=pq.scrollLeft(p),a=d.sleft,l=u.wdCont,s=d.wdContLeft,d.ratioH):(h&&(v=e(window).scrollTop()-f.offset().top),g=h?d._calcTop(p,v):p.scrollTop,a=d.stop,l=d.htCont,s=d.htContTop,d.ratioV),g=g<0?0:g;if(1==f)return o=g+l-s,[g,o=0<=(o=i||!h?o:d._calcBot(g,o,v))?o:0];var m,p=d[i?"virtualWd":"virtualHt"],h=i?u.wdContClient:u.htContClient,u=i?"diffH":"diffV",v=d[u];if(n.maxHt<=g+h?r=(o=p-s+(l-h))-l+s:o=(r=0==g?0:g*(p=null==a||Math.abs(g-a)>l?f:1)+(1==p&&v?v:0))+l-s,(h=r-g)!=v&&(m=!0,d[u]=h,c&&d.triggerTblDims(3e3)),!(0<=(d[i?"sleft":"stop"]=g)))throw"stop NaN";if(0<=o&&0<=r)return[r,o,m];throw"top bottom NaN"},_calcTop:function(e,n){return e.scrollTop+(0<n?n:0)},_calcBot:function(n,i,r){return(n=n+e(window).height()+(r<0?r:0))<i?n:i},getHtDetail:function(e,n){return(e=e.pq_detail)&&e.show?e.height||n:0},getTop:function(e,n){var i=this.topArr[e],n=n?0:this.diffV;if(0<=(i=n&&(i-=e>this.freezeRows?n:0)<0?0:i))return i;throw i},getTopSafe:function(e,n,i){var r=n?this.cols:this.rows;return this[n?"getLeft":"getTop"](r<e?r:e,i)},getLeft:function(e,n){var i=this.numColWd,r=this.leftArr,o=r.length-1,o=o<e?o:e,e=-1==o?0:r[o]+i,r=n?0:this.diffH;if(0<=(e=r&&(e-=o>this.freezeCols?r:0)<0?0:e))return e;throw e},getHeightR:function(e,n){var i=this.topArr,n=i[e+(n=n||1)]-i[e];if(0<=n)return n;throw n},getHeightCell:function(e,n){n=n||1;var i=this.topArr,r=this.rowHtDetail,r=r?this.getHtDetail(this.data[e+n-1],r):0,n=i[e+n]-i[e]-r;if(0<=n)return n;throw n},getHeightCellM:function(e,n){return this.getTopSafe(e+n)-this.getTop(e)},getHeightCellDirty:function(e,n){return this.setTopArr(e,null,e+n),this.getHeightCellM(e,n)},getWidthCell:function(e){if(-1==e)return this.numColWd;if(0<=(e=this.colwdArr[e]))return e;throw e},getWidthCellM:function(e,n){return this.getTopSafe(e+n,!0)-this.getLeft(e)},initRowHtArr:function(){var e,n=this.rowHt,i=this.data,r=i.length,o=this.rowHtDetail,a=this.rowhtArr=[],l=(this.topArr=[],0);if(o)for(;l<r;l++)e=i[l],a[l]=e.pq_hidden?0:e.pq_ht||n+this.getHtDetail(e,o);else for(;l<r;l++)e=i[l],a[l]=e.pq_hidden?0:e.pq_ht||n},initRowHtArrDetailSuper:function(e){var n,i=this.rowhtArr,r=this.data;e.forEach(function(e){i[n=e[0]]=r[n].pq_ht=i[n]+e[1]}),this.setTopArr(),this.assignTblDims()},initRowHtArrSuper:function(){this.initRowHtArr(),this.setTopArr(),this.assignTblDims()},refreshRowHtArr:function(e,n){var i=this.data[e],r=this.rowHtDetail,o=this.rowHt;this.rowhtArr[e]=i.pq_hidden?0:o+this.getHtDetail(i,r),n&&(this.setTopArr(e),this.assignTblDims())},setTopArr:function(e,n,i){for(var r,o,a=e||0,l=n?(r=this.cols,o=this.colwdArr,this.leftArr):(r=this.rows,o=this.rowhtArr,this.topArr),s=i&&i<r?i:r-1,d=a?l[a]:0;a<=s;a++)l[a]=d,d+=o[a];l[a]=d,l.length=r+1},triggerTblDims:function(e){var n=this;n.setTimer(function(){n.that._trigger("assignTblDims")},"assignTblDims",e)}}}(jQuery),function(e){var n=1533910;e(document).one("pq:ready",function(){var i=e("<div style='position:relative;'></div>").appendTo(document.body),r=e("<div style='position:absolute;left:0;'></div>").appendTo(i)[0],o=pq.cVirtual,r=(r.style.top="1000000000px",r.offsetTop-50);16554378<(n=r<=1e4?n:r)&&(n=16554378),o.maxHt=n,i.remove(),o.setSBDim(),e(window).on("resize",o.setSBDim.bind(o))})}(jQuery),function(e){pq.cRender=function(){this.data=[]},pq.cRender.prototype=e.extend({},{_m:function(){},autoHeight:function(e){var n=this,i=n.that,r=n.isBody(),o=e.hChanged,a=n.freezeRows,l=!1,s=n.initV,d=n.finalV;n.rows&&(r&&i._trigger("beforeAutoRowHeight"),l=n.setRowHtArr(s,d,o),(l=n.setRowHtArr(0,a-1,o)||l)?(n.setTopArr(a?0:s),n.assignTblDims(),n.setPanes(),n.setCellDims(!0),r&&(e.source="autoRow",n.refresh(e),i._trigger("autoRowHeight"))):n.setCellDims(!0))},autoWidth:function(e){function n(e){0<=o.indexOf(e)&&i.setColWdArr(e,e)}var i=this,r=i.freezeCols,o=(e=e||{}).colIndx,a=i.initH,e=i.finalH,l=e;if(o){for(;a<=l;l--)n(l);for(l=r-1;0<=l;l--)n(l)}else i.setColWdArr(a,e),i.setColWdArr(0,r-1)},_each:function(e,n,i,r,o,a){for(var l,s=this.jump,d=0;d<=i;d++)(l=r[d=s(n,a,d)])[o]||e.call(this,l,d)},eachV:function(e){this._each(e,this.initV,this.finalV,this.data,"pq_hidden",this.freezeRows)},eachH:function(e){this._each(e,this.initH,this.finalH,this.colModel,"hidden",this.freezeCols)},saveValues:function(e){var n,i,r=[],o=this,a="value"==e;return o.eachV(function(e,l){r[l]=[],n=o.getHeightCell(l),o.eachH(function(s,d){i=a?e[s.dataIndx]:o.generateCell(l,d,e,s,o.getCellRegion(l,d),n,!0),r[l][d]=i})}),r},dirtyCells:function(e,n){var i,r,o=[],a=this,l="value"==n;return a.eachV(function(n,s){i=a.getHeightCell(s),a.eachH(function(d,c){r=l?n[d.dataIndx]:a.generateCell(s,c,n,d,a.getCellRegion(s,c),i,!0),e[s]&&e[s][c]!==r&&o.push([s,c,n,d])})}),o},generateCell:function(e,n,i,r,o,a,l){var s,d,c,u,h=this,f=h.iMerge,p=h.isHead(),g=[],m=h.riOffset,v=e+m,$=[h.cellCls];if(h._m()&&(u=f.ismergedCell(v,n))){if(!u.o_rc)return(e==h._initV||n==h._initH)&&(w=h.getCellRegion(e,n),s=(d=f.getRootCell(v,n)).v_ri-m,c=d.v_ci,s<0||(x=h.getCellRegion(s,c),h.mcLaid[s+","+c+(x==w?"":","+w)]=!0)),"";(d=f.getClsStyle(v,n)).style&&g.push(d.style),d.cls&&$.push(d.cls),v=u.o_ri,i=h.data[e=v-m],n=u.o_ci,r=h.colModel[n],a=h.getHeightCellM(e,u.o_rc),s=h.getWidthCellM(n,u.o_cc),$.push("pq-merge-cell")}else if(i.pq_hidden||r.hidden)return"";if(c=h.getCellId(e,n,o),!l&&h.getById(c))return"";var x=a||h.getHeightCell(e),w=s||h.colwdArr[n],f=h.getLeft(n);return g.push(h.rtl+":"+f+"px;width:"+w+"px;height:"+x+"px;"),h.renderCell({style:g,cls:$,attr:["role="+(p?"columnheader":"gridcell")+" id='"+c+"'"],rowData:i,rowIndxPage:e,rowIndx:v,colIndx:n,dataIndx:r.dataIndx,column:r})},generateRow:function(e,n){var i="pq-grid-row",r="top:"+this.getTop(e)+"px;height:"+this.getHeightR(e)+"px;width:100%;",n="role=row id="+this.getRowId(e,n)+" aria-rowindex="+(e+1),e=this.getRowClsStyleAttr(e);return i+=" "+e[0],r+=e[1],"<div class='"+i+"' "+(n+=" "+e[2])+" style='"+r+"'>"},getById:function(e){return document.getElementById(e)},getCell:function(e,n,i){var r,o=this.riOffset,a=e+o;return i||(r=this.iMerge).ismergedCell(a,n)&&(r=r.getRootCell(a,n),this.isHead()&&(e=r.o_ri,n=r.o_ci),i=this.getCellRegion(r.v_ri-o,r.v_ci)),this.getById(this.getCellId(e,n,i))},getCellIndx:function(e){if((e=e.id.split("-"))[3]=="u"+this.uuid)return""==e[5]?[+e[4],-1,e[7]]:[+e[4],+e[5],e[6]]},getCellId:function(e,n,i){return e>=this.data.length?"":(i=i||this.getCellRegion(e,n),this.cellPrefix+e+"-"+n+"-"+i)},getCellCont:function(e,n){return this["$c"+this.getCellRegion(e,n)]},getCellCoords:function(e,n){var i=this.maxHt,r=this.riOffset,o=e+r,a=e,l=n,r=(this.isBody()&&(a=(o=this.that.iMerge.inflateRange(o,n,o,n))[2]-r,l=o[3]),this.getTop(e)),o=this.getTop(a)+this.getHeightCell(a),e=this.getLeft(n),a=this.getLeft(l+1);return i<o&&(r-=o-i,o=i),i<a&&(e-=a-i,a=i),[e,r,a,o]},getCellRegion:function(e,n){var i=this.freezeCols;return e<this.freezeRows?n<i?"lt":"tr":n<i?"left":"right"},getCellXY:function(e,n){var i=this.maxHt;return[Math.min(this.getLeft(n),i),Math.min(this.getTop(e),i)]},getContRight:function(){return this.$cright},getMergeCells:function(){return this._m()?this.$tbl.children().children(".pq-merge-cell"):e()},getRow:function(e,n){return this.getById(this.getRowId(e,n))},getAllCells:function(){return this.$ele.children().children().children().children().children(this.isHead()?".pq-grid-col":".pq-grid-cell")},get$Col:function(e,n){var i=["right","left","lt","rt"].map(function(n){return"[id$=-"+e+"-"+n+"]"}).join(",");return(n||this.getAllCells()).filter(i)},get$Row:function(e){return this.$ele.find("[id^="+this.getRowId(e,"")+"]")},getRowClsStyleAttr:function(e){var n=this.that,i=[],r=n.options,o=r.rowInit,a=this.data[e],l=a.pq_rowcls,s=a.pq_rowattr,d=a.pq_rowstyle,c=pq.styleStr,u="",h=[],f=e+this.riOffset;return r.stripeRows&&this.stripeArr[e]&&i.push("pq-striped"),a.pq_rowselect&&i.push(n.iRows.hclass),l&&i.push(l),s&&(u+=n.processAttr(s,h)),d&&h.push(c(d)),o&&(r=o.call(n,{rowData:a,rowIndxPage:e,rowIndx:f}))&&((l=r.cls)&&i.push(l),(l=r.attr)&&(u+=" "+l),(l=r.style)&&h.push(c(l))),[i.join(" "),h.join(""),u]},getRowId:function(e,n){if(null==n)throw"getRowId region.";return this.rowPrefix+e+"-"+n},getRowIndx:function(e){return[+(e=e.id.split("-"))[4],e[5]]},getTable:function(e,n){return this["$tbl_"+this.getCellRegion(e,n)]},getTblCls:function(e){var n=this.isBody()?[]:["pq-grid-summary-table"];return e.rowBorders&&n.push("pq-td-border-top"),e.columnBorders&&n.push("pq-td-border-right"),e.wrap||n.push("pq-no-wrap"),n.join(" ")},getFlexWidth:function(){return this._flexWidth},preInit:function(n){var i=this,r=i.isBody(),o=i.that,a=o.options,o=o.eventNamespace,l="pq-table "+i.getTblCls(a),s=["pq-cont-inner ","pq-cont-right","pq-cont-left","pq-cont-lt","pq-cont-tr"];n.empty(),n[0].innerHTML=['<div class="pq-grid-cont">',r?'<div class="pq-grid-norows">'+a.strNoRows+"</div>":"",'<div class="',s[0]+s[1],'"><div class="pq-table-right '+l+'"></div>',r?"":'<div class="pq-r-spacer" style="position:absolute;top:0;height:10px;"></div>',"</div>",'<div class="'+s[0]+s[2]+'"><div class="pq-table-left '+l+'"></div></div>','<div class="'+s[0]+s[4]+'"><div class="pq-table-tr '+l+'"></div></div>','<div class="'+s[0]+s[3]+'"><div class="pq-table-lt '+l+'"></div></div>',"</div>"].join(""),i.$cright=n.find("."+s[1]).on("scroll",i.onNativeScroll.bind(i)),i.virtualWin&&e(window).on("scroll"+o+" resize"+o,i.onNativeScroll.bind(i)),r||(i.$spacer=n.find(".pq-r-spacer")),i.$cleft=n.find("."+s[2]).on("scroll",i.onScrollL.bind(i)),i.$clt=n.find("."+s[3]).on("scroll",i.onScrollLT),i.$ctr=n.find("."+s[4]).on("scroll",i.onScrollT),i.$tbl=n.find(".pq-table").on("scroll",i.onScrollLT),i.$tbl_right=n.find(".pq-table-right"),i.$tbl_left=n.find(".pq-table-left"),i.$tbl_lt=n.find(".pq-table-lt"),i.$tbl_tr=n.find(".pq-table-tr"),r&&(i.$cleft.add(i.$ctr).add(i.$cright.find(".pq-table")).on("mousewheel DOMMouseScroll",i.onMouseWheel(i)),i.$norows=n.find(".pq-grid-norows"))},isBody:function(){},isHead:function(){},isSum:function(){},jump:function(e,n,i){return i=i<e&&n<=i?e:i},hasMergeCls:function(e){return e&&0<=e.className.indexOf("pq-merge-cell")},initRefreshTimer:function(e){e=this.onRefreshTimer(this,e),this.setTimer(e,"refresh")},initStripeArr:function(){for(var e,n=this.rows,i=0,r=this.stripeArr=[],o=this.data;i<n;i++)o[i].pq_hidden||(e=r[i]=!e)},isRenderedRow:function(e){return!!this.getRow(e)},onScrollLT:function(){this.scrollTop=this.scrollLeft=0},onScrollT:function(){this.scrollTop=0},onScrollL:function(e){var n=e.target,i=this;pq.scrollLeft(n,0),i.setTimer(function(){i.$cright[0].scrollTop=n.scrollTop},"scrollL",50)},refresh:function(e){e=e||{};var n,i=this,r=i.that,o=i.isBody(),a=i.isHead(),l=(null!=e.timer&&e.timer,i.mcLaid={}),s=i.freezeCols,d=i.numColWd,c=!(!s&&!d),u=i.freezeRows,h=(y=i.calInitFinalSuper())[0],f=y[1],p=y[2],g=y[3],m=e.fullRefresh||y[4],v=i.initV,$=i.finalV,x=i.initH,w=i.finalH;for(n in m&&o&&r.blurEditor({force:!0}),i._initV=h,i._finalV=p,i._initH=f,i._finalH=g,o&&r._trigger("beforeTableView",null,{initV:h,finalV:p,pageData:i.data}),m||(null!=$&&v<=p&&h<=$&&(v<h?(i.removeView(v,h-1,x,w),c&&i.removeView(v,h-1,d?-1:0,s-1)):h<v&&(i.renderView(h,v-1,f,g),c&&i.renderView(h,v-1,0,s-1)),p<$?(i.removeView(p+1,$,x,w),c&&i.removeView(p+1,$,d?-1:0,s-1)):$<p&&(i.renderView($+1,p,f,g),c&&i.renderView($+1,p,0,s-1)),v=h,$=p),null!=w&&x<g&&f<w&&(x<f?(i.removeView(v,$,x,f-1),u&&i.removeView(0,u-1,x,f-1)):f<x&&(i.renderView(v,$,f,x-1),u&&i.renderView(0,u-1,f,x-1)),g<w?(i.removeView(v,$,g+1,w),u&&i.removeView(0,u-1,g+1,w)):w<g&&(i.renderView(v,$,w+1,g),u&&i.renderView(0,u-1,w+1,g)),x=f,w=g)),m||p!==$||h!==v||f!==x||g!==w?(o&&r._trigger("beforeViewEmpty",null,{region:"right"}),i.$tbl_right.empty(),i.renderView(h,p,f,g),c&&(p!==$||h!==v)&&(i.$tbl_left.empty(),i.renderView(h,p,0,s-1)),u&&(f===x&&g===w||(r._trigger("beforeViewEmpty",null,{region:"tr"}),i.$tbl_tr.empty(),i.renderView(0,u-1,f,g)),c&&null==$&&(i.$tbl_lt.empty(),i.renderView(0,u-1,0,s-1)))):i.removeMergeCells(),l){var y,C=+(y=n.split(","))[0],_=+y[1],b=y[2];i.renderView(C,C,_,_,b)}v=(d=f!=i.initH||g!=i.finalH)&&null!=i.initH,(m||p!=i.finalV||h!=i.initV||d)&&(i.initV=h,i.finalV=p,i.initH=f,i.finalH=g,o?r._trigger("refresh",null,{source:e.source,hChanged:v}):r._trigger(a?"refreshHeader":"refreshSum",null,{hChanged:v}))},refreshAllCells:function(e){this.initH=this.initV=this.finalH=this.finalV=null,(e=e||{}).fullRefresh=!0,this.refresh(e)},refreshCell:function(n,i,r,o){function a(a,d){a&&(l=!0,a.id="",e(a).replaceWith(s.generateCell(n,i,r,o,d)))}var l,s=this,d=s.isBody()&&s._m()?s.iMerge.getRootCellV(n+s.riOffset,i):0,c=n,u=i;return d?(n=d.rowIndxPage,i=d.colIndx,r=d.rowData,o=d.column,["lt","tr","left","right"].forEach(function(e){a(s.getCell(c,u,e),e)})):a(s.getCell(n,i)),l},removeMergeCells:function(){for(var n,i,r,o,a,l,s,d=this,c=d.iMerge,u=d.riOffset,h=(d.freezeCols,d.freezeRows,d.getMergeCells()),f=d._initH,p=d._finalH,g=d._initV,m=d._finalV,v=0,$=h.length;v<$;v++)a=h[v],(l=d.getCellIndx(a))&&(s=l[0],n=l[1],l=l[2],i=s+(r=c.getRootCell(s+u,n)).o_rc-1,r=n+r.o_cc-1,o=!1,m<s||p<n?o=!0:"right"==l?(i<g||r<f)&&(o=!0):"left"==l?i<g&&(o=!0):"tr"==l&&r<f&&(o=!0),s=a.parentNode,o&&e(a).remove(),s.children.length||s.parentNode.removeChild(s))},removeView:function(n,i,r,o){for(var a,l,s,d=this.getCellRegion(n,r),c=n;c<=i;c++)if(a=this.getRow(c,d)){for(l=r;l<=o;l++)!(s=this.getCell(c,l,d))||this.hasMergeCls(s)||e(s).remove();a.children.length||a.parentNode.removeChild(a)}},renderNumCell:function(e,n,i){var r=this.getHeightR(e),o=this.isHead();return"<div id='"+this.getCellId(e,-1,i)+"' style='"+("width:"+n+"px;height:")+r+"px;' role='gridcell' class='pq-grid-number-cell '>"+(this.isBody()?e+1+this.riOffset:o&&e==this.data.length-1&&this.numberCell.title||"")+"</div>"},renderRow:function(n,i,r,o,a,l){var s,d,c,u=this.getRow(r,l),h=this.numColWd,f=[],p=this.getHeightCell(r),g=this.colModel;for(u||n.push(this.generateRow(r,l)),0==o&&h&&("left"==l||"lt"==l)&&f.push(c=this.renderNumCell(r,h,l)),d=o;d<=a;d++)(s=g[d])&&!s.hidden&&f.push(c=this.generateCell(r,d,i,s,l,p));h=f.join(""),u?e(u).append(h):n.push(h,"</div>")},renderView:function(e,n,i,r,o){if(null!=i&&null!=r){o=o||this.getCellRegion(e,Math.min(i,r));for(var a,l=[],s=this.data,d=this["$tbl_"+o],c=e;c<=n;c++)(a=s[c])&&!a.pq_hidden&&this.renderRow(l,a,c,i,r,o);d.append(l.join(""))}},scrollX:function(e,n){var i=this.$cright[0];if(!(0<=e))return pq.scrollLeft(i);this.scrollXY(e,i.scrollTop,n)},setCellDims:function(e){for(var n,i=this,r=i.rtl,o=i.iMerge,a=i._m(),l=i.colModel,s=i.numColWd,d=i.jump,c=i.setRowDims(),u=i.riOffset,h=i.initH,f=i.finalH,p=i.freezeCols,g=(i.eachV(function(g,m){var v,x=i.get$Row(m),w=i.getHeightR(m),y=i.getTop(m),C=i.getHeightCell(m);c(x,w,y);for(var _=s?-1:0;_<=f;_++)!((_=d(h,p,_))<0)&&l[_].hidden||a&&($=o.ismergedCell(m+u,_))||(v=i.getCell(m,_))&&((n=v.style).height=(-1==_?w:C)+"px",e||(n.width=i.getWidthCell(_)+"px",n[r]=i.getLeft(_)+"px"))}),i.getMergeCells()),m=0,v=g.length;m<v;m++){var $,x,w,y,C,_=g[m],b=i.getCellIndx(_);b&&(y=b[0],b=b[1],C=($=o.getRootCell(y+u,b)).v_ri-u,x=i.get$Row(C),w=i.getHeightR(C),y=i.getHeightCellM(y,$.o_rc),c(x,w,C=i.getTop(C)),(n=_.style).height=y+"px",e||(n.width=i.getWidthCellM(b,$.o_cc)+"px",n[r]=i.getLeft(b)+"px"))}},setRowDims:function(){return function(e,n,i){(n={height:n,width:"100%"}).top=i,e.css(n)}},setColWdArr:function(n,i){var r,o,a,l,s,d,c,u,h=i,f=this,p=f.riOffset,g=f.jump,m=f.colModel,v=f.data,$=f.freezeRows,x=f.maxHt+"px",w=f.iMerge,y=f.initV,i=f.isBody(),C=f.isSum(),_=i||C,b=f.isHead()?f.that.headerCells.length-1:f.finalV;if(0<=b){for(;n<=h;h--)if(!(o=m[h]).hidden&&-1==(o.width+"").indexOf("%")&&(l=_?o.width:o._minWidth)){for(r=0;r<=b;r++)if((s=v[r=g(y,$,r)])&&!s.pq_hidden){if(s=!0,d=w.ismergedCell(r+p,h)){if(1==d)continue;if(1<(d=w.getRootCell(r+p,h)).v_rc||1<d.v_cc){if(1<d.v_cc)continue;s=!1}a=f.getCell(d.o_ri-p,d.o_ci)}else a=f.getCell(r,h);a&&(a.parentNode.style.width=x,s&&(a.style.width="auto",(c=e(a).find(".pq-menu-icon,.pq-menu-filter-icon")).length&&(c.css({position:"static",float:"left",width:20}),(u=e(a).find(".pq-td-div")).css("width","auto"))),d=a.offsetWidth+1,s&&c.length&&(c.css({position:"",float:"",width:""}),u.css("width","")),l=Math.max(d,l))}if(!(0<l))throw"wd NaN";o.width=f.colwdArr[h]=l,o._resized=!0}}},setRowHtArr:function(e,n,i){for(var r,o,a,l,s,d,c,u,h,f=n,p=this,g=p.jump,m=p.riOffset,v=p.rowhtArr,$=p.data,x=p.colModel,w=p._m(),y=p.diffV,C=p.freezeCols,_=p.rowHt,b=p.iMerge,I=p.rowHtDetail,q=p.initH,R=p.finalH;e<=f;f--)if((a=$[f])&&!a.pq_hidden&&!a.pq_htfix){for(h=I?p.getHtDetail(a,I):0,d=i?v[f]-h:_,r=0;r<=R;r++)if(!x[r=g(q,C,r)].hidden){if(c=w&&b.ismergedCell(f+m,r)){if(1==c||y)continue;c=b.getRootCell(f+m,r),l=p.getCell(c.o_ri-m,c.o_ci)}else l=p.getCell(f,r);l&&(l.style.height="auto",s=l.offsetHeight,c&&(u=c.o_rc-(c.v_ri-c.o_ri)-1,s-=1<c.v_rc?p.getHeightCellDirty(c.v_ri-m+1,u):0),d=Math.max(s,d))}v[f]!=(h=d+h)&&(v[f]=a.pq_ht=h,o=!0)}return o},setTimer:function(e){var n={};return!0===e?function(e){e()}:function(e,i,r){clearTimeout(n[i]);var o=this;n[i]=setTimeout(function(){o.that.element&&e.call(o)},r||300)}}},new pq.cVirtual)}(jQuery),function(e){pq.cRenderBody=function(e,n){var i=this,r=i.uuid=e.uuid,o=e.options,a=i.$ele=n.$b,l=i.$sum=n.$sum,n=i.$h=n.$h,s=o.postRenderInterval;i.that=e,i.rtl=o.rtl?"right":"left",i.virtualWin=o.virtualWin,i.setTimer=i.setTimer(r),i.cellPrefix="pq-body-cell-u"+r+"-",i.rowPrefix="pq-body-row-u"+r+"-",i.cellCls="pq-grid-cell",i.iMerge=e.iMerge,i.rowHt=o.rowHt||27,i.rowHtDetail="auto"==(r=o.detailModel.height)?1:r,i.iRenderHead=e.iRenderHead=new pq.cRenderHead(e,n),i.iRenderSum=e.iRenderSum=new pq.cRenderSum(e,l),e.on("headHtChanged",i.onHeadHtChanged(i)),null!=s&&e.on("refresh refreshRow refreshCell refreshColumn",function(){s<0?i.postRenderAll():i.setTimer(i.postRenderAll,"postRender",s)}),i.preInit(a),e.on("refresh softRefresh",i.onRefresh.bind(i))},pq.cRenderBody.prototype=e.extend({},new e.paramquery.cGenerateView,new pq.cRender,{setHtCont:function(e){this.dims.htCont=e,this.$ele.css("height",e)},flex:function(e){var n=this.that;!1!==n._trigger("beforeFlex",null,e)&&(this.iRenderHead.autoWidth(e),this.iRenderSum.autoWidth(e),this.autoWidth(e),n.refreshCM(null,{flex:!0}),n.refresh({source:"flex",soft:!0}))},init:function(e){var n,i=this,r=i.that,o=(e=e||{}).soft,a=!o,l=e.source,s=i.iRenderHead,d=i.iRenderSum,c=r.options,u=c.scrollModel,h=(i.freezeCols=c.freezeCols||0,i.freezeRows=c.freezeRows,i.numberCell=c.numberCell),f=i.colModel=r.colModel;i.width=c.width,i.height=c.height,a&&(i.dims=r.dims,i.autoFit=u.autoFit,i.pauseTO=u.timeout,n=(u=r.pdata||[]).findIndex(function(e){return!e.pq_hidden}),i.$norows.css("display",0<=n?"none":""),i.data=u,i.maxHt=pq.cVirtual.maxHt,i.riOffset=r.riOffset,i.cols=f.length,i.rows=u.length,r._mergeCells&&(i._m=function(){return!0}),i.autoRow=c.autoRow,i.initRowHtArrSuper(),c.stripeRows&&i.initStripeArr()),i.refreshColumnWidths(),i.numColWd=s.numColWd=d.numColWd=h.show?h.width:0,i.initColWdArrSuper(),d.init(e),e.header?s.init(e):(i.setPanes(),s.setCellDims(),s.assignTblDims(!0)),d.initPost(e),e.header&&s.initPost(e),i.$cright[0].scrollTop>i.getTop(i.rows)||(a?i.refreshAllCells({source:l}):o&&(i.setCellDims(),i.refresh({source:l}),r._trigger("softRefresh")))},initColWdArr:function(){for(var e,n=this.colModel,i=n.length,r=(this.leftArr=this.iRenderHead.leftArr=this.iRenderSum.leftArr=[],0),o=this.colwdArr=this.iRenderHead.colwdArr=this.iRenderSum.colwdArr=[];r<i;r++)e=n[r],o[r]=e.hidden?0:e._width},initColWdArrSuper:function(){this.initColWdArr(),this.setTopArr(0,!0),this.assignTblDims(!0)},inViewport:function(e,n,i){i=i||this.getCell(e,n);var r=this.dims,o=r.left-2,a=r.right-(r.wdCont-r.wdContClient)+2,l=r.top-2,s=r.bottom-(r.htCont-r.htContClient)+2,e=this.getCellRegion(e,n),n=i.parentNode,d=i.offsetLeft-r.wdContLeft,n=n.offsetTop-r.htContTop,r=d+i.offsetWidth,i=n+i.offsetHeight;return"right"==e?o<d&&r<a&&l<n&&i<s:"tr"==e?o<d&&r<a:"left"!=e||l<n&&i<s},isBody:function(){return!0},onHeadHtChanged:function(e){return function(n,i){e.setPanes()}},onMouseWheel:function(e){var n;return function(e){var i=this;i.style["pointer-events"]="none",clearTimeout(n),n=setTimeout(function(){i.style["pointer-events"]=""},300)}},onNativeScroll:function(){var e=this.$cright[0],n=this.that,i=e.scrollLeft,e=e.scrollTop;this.iRenderSum.setScrollLeft(i),this.iRenderHead.setScrollLeft(i),this.$cleft[0].scrollTop=e,this.$ctr[0].scrollLeft=i,this.refresh(),n._trigger("scroll"),this.setTimer(function(){n._trigger("scrollStop")},"scrollStop",this.pauseTO)},onRefresh:function(e,n){"autoRow"!=n.source&&this.initRefreshTimer(n.hChanged)},onRefreshTimer:function(e,n){return function(){var i=e.$cright[0];e.autoRow&&e.autoHeight({hChanged:n}),i.scrollTop=i.scrollTop,i.scrollLeft=i.scrollLeft}},pageDown:function(n,i){var r,o=this,a=o.topArr,l=a[n],s=n,d=o.dims,c=this.$cright[0].scrollTop,d=95*Math.min(d.htContClient-d.htContTop,e(window).height())/100,u=l+d,h=n,f=a.length-1;o.scrollY(c+d,function(){for(h=n<o.initV?o.initV:n;h<=f;h++)if(l<(r=a[h])&&(l=r,s=h-1),u<r){s=h-1;break}i(s)})},pageUp:function(n,i){for(var r,o=this.topArr,a=o[n],l=this.$cright[0].scrollTop,s=this.dims,s=9*Math.min(e(window).height(),s.htContClient-s.htContTop)/10,d=a-s,c=n,u=n;0<=u;u--)if((r=o[u])<a&&(a=r,c=u),r<d){c=u;break}this.scrollY(l-s,function(){i(c)})},postRenderAll:function(){var e,n,i,r=this,o=r.that,a=r.riOffset,l=r.iMerge,s=r.data;r.colModel,r.eachH(function(s,d){(i=s.postRender)&&r.eachV(function(s,c){n=l.getRootCellO(c+a,d,!0),(e=r.getCell(n.rowIndxPage,n.colIndx))&&!e._postRender&&(n.cell=e,o.callFn(i,n),e._postRender=!0)})}),(i=r.numberCell.postRender)&&r.eachV(function(e,n){var l=r.getCell(n,-1),d=n+a,n={rowIndxPage:n,colIndx:-1,rowIndx:d,rowData:s[d]};l&&!l._postRender&&(n.cell=l,o.callFn(i,n),l._postRender=!0)})},refreshRow:function(e){var n,i,r=this,o=r.initH,a=r.finalH,l=r.freezeCols,s=r.get$Row(e),d=[];s.each(function(e,n){n=r.getRowIndx(n),d.push(n[1])}),r.that._trigger("beforeViewEmpty",null,{rowIndxPage:e}),s.remove(),d.forEach(function(s){i="left"==s||"lt"==s?(n=0,l-1):(n=o,a),r.renderView(e,e,n,i,s)})},newScrollPos:function(n,i){var r,o,a=this.dims,l=a[i?"wdContClient":"htContClient"],s=this.$cright[0],d=this[i?"colModel":"data"].length,c=this[i?"freezeCols":"freezeRows"],u=pq[i?"scrollLeft":"scrollTop"](s),a=a[i?"wdContLeft":"htContTop"];return n<c||d-1<n?u:(c=this.getTopSafe(n,i),d=this[i?"getWidthCell":"getHeightR"](n),null!=c?(!i&&this.virtualWin&&(i=(n=e(window)).scrollTop(),0<=(o=(s=c-u+e(s).offset().top-i)-n.height())?n.scrollTop(i+o+d):s<0&&n.scrollTop(i+s)),u+l<c+d+1?c<(r=c+d+1-l)+a&&(r=c-a):c<u+a&&(r=c-a),0<=(r=r<0?0:r)?r:u):void 0)},scrollColumn:function(e,n){e=this.newScrollPos(e,!0),this.scrollX(e,n)},scrollRow:function(e,n){e=this.newScrollPos(e),this.scrollY(e,n)},scrollCell:function(e,n,i){e=this.newScrollPos(e),n=this.newScrollPos(n,!0),this.scrollXY(n,e,i)},scrollY:function(e,n){var i=this.$cright[0];if(null==e)return i.scrollTop;e=0<=e?e:0,this.scrollXY(pq.scrollLeft(i),e,n)},scrollXY:function(e,n,i){var r,o=this.$cright[0],a=this.that,l=o.scrollLeft,s=o.scrollTop;if(!(0<=e))return[l,s];pq.scrollLeft(o,e),o.scrollTop=n,r=o.scrollLeft,e=o.scrollTop,i&&(r==l&&e==s?i():a.one("scroll",function(){r==l?i():a.one("scrollHead",i)}))},getSBHt:function(e){var n=this.dims,i=this.that.options,r=pq.cVirtual.SBDIM;return!this.autoFit&&("flex"!=this.width||i.maxWidth)&&e>n.wdCenter+r?r:0},getSBWd:function(){var e=this.dims,n=this.that.options.hideVScroll;return!e.htCenter||n&&e.htCenter>(e.htTblHead||0)+e.htTbl+e.htTblSum?0:pq.cVirtual.SBDIM},setPanes:function(){var e=this,n=e.that.options,i=e.autoFit,r=e.dims,o=r.htCenter-r.htHead-r.htSum,a=r.wdCenter,l=e.$ele,s=e.freezeCols,d=e.freezeRows,c=e.$cright,u=c[0],h=e.$cleft,f=e.$clt,p=e.$ctr,s=e.getLeft(s),g=pq.cVirtual.SBDIM,m=r.wdTbl,v=Math.max(r.htTbl,30)+e.getSBHt(m),$=e.getTopSafe(d);p.css("display",d?"":"none"),h.css("display",s?"":"none"),f.css("display",s&&d?"":"none"),c.css("overflow-y",""),"flex"==e.height?(0<o&&o<v?v=Math.min(v,o):c.css("overflow-y","hidden"),e.setHtCont(v)):e.setHtCont(o),i&&e.getSBWd()&&c.css("overflow-y","scroll"),c.css("overflow-x",i?"hidden":""),"flex"==e.width?(m=parseInt(l[0].style.height)>=r.htTbl-1?m:m+g,n.maxWidth&&a<m?m=Math.min(m,a):c.css("overflow-x","hidden"),e._flexWidth=m,l.width(e._flexWidth)):l.css("width",""),e.htCont=r.htCont=c.height(),e.wdCont=r.wdCont=c.width(),r.htContClient=d=u.clientHeight,r.wdContClient=v=u.clientWidth,v<s&&(c.css("overflow-x","hidden"),s=v),h.css("width",s),f.css("width",s),p.width(v),h.height(d),o=u.offsetWidth,e.iRenderHead.setWidth(o,v),e.iRenderSum.setWidth(o,v),d<$&&(c.css("overflow-y","hidden"),$=d),f.css("height",$),p.css("height",$),e.wdContLeft=r.wdContLeft=h.width(),e.htContTop=r.htContTop=p.height()}},new pq.cVirtual)}(jQuery),function(){function e(e){this.that=e}(jQuery.paramquery.cMergeHead=e).prototype={getRootCell:function(e,n){for(var i=this.that,r=i.headerCells,o=r[e][n],n=o.rowSpan,a=o.leftPos;e&&r[e-1][a]==o;)e--;return{v_ri:e,o_ri:e,v_ci:i.getNextVisibleCI(a),o_ci:a,v_rc:n,o_rc:n,v_cc:o.colSpan,o_cc:o.o_colspan}},ismergedCell:function(e,n){var i,r=this.that,o=r.headerCells,a=o[e],a=a?a[n]:"";if(a){if(i=a.leftPos,0!=e&&o[e-1][n]===a||r.getNextVisibleCI(i)!=n){if(a.colSpan)return!0}else if(o=a.rowSpan,r=a.colSpan,o&&r&&(1<o||1<r))return{o_ri:e,o_ci:i,v_rc:o,o_rc:o,v_cc:r,o_cc:a.o_colspan}}},getClsStyle:function(){return{}}}}(),t=jQuery,pq.cRenderHS=t.extend({},new pq.cRender,{init:function(e){var n,i=this,r=i.that,o=r.options,a=i.colModel=r.colModel,l=i.isHead(),s=i.isSum(),d=l?o.autoRowHead:o.autoRowSum,c=r.headerCells;i.freezeCols=o.freezeCols||0,i.numberCell=o.numberCell,i.width=o.width,i.height="flex",i.freezeRows=0,i.dims=r.dims,l?n=i.data=o.showHeader?o.filterModel.header?c.concat([[]]):c:[]:s&&(n=i.data=o.summaryData||[]),i.maxHt=pq.cVirtual.maxHt,i.riOffset=0,i.cols=a.length,i.rows=n.length,l?1<c.length&&(i._m=function(){return!0}):o.stripeRows&&i.initStripeArr(),i.autoRow=null==d?o.autoRow:d,i.initRowHtArrSuper(),i.assignTblDims(!0),i.setPanes()},initPost:function(e){this.data.length&&(e||{}).soft?(this.setCellDims(),this.refresh()):this.refreshAllCells()},onNativeScroll:function(){this.refresh(),this.isHead()&&this.that._trigger("scrollHead")},onRefresh:function(e,n){this.initRefreshTimer(n.hChanged)},refreshHS:function(){this.init(),this.initPost()},setPanes:function(){var e=this,n=e.that,i=e.dims,r=e.$ele,o=e.freezeCols,a=e.$cright,l=a[0],s=e.$cleft,o=e.getLeft(o),d=e.isHead(),c=e.isSum(),u=e.getTopSafe(e.rows);e.data.length,s.css("display",o?"":"none"),r.height(u),d?(i.htHead=u,n._trigger("headHtChanged")):c&&(i.htSum=u,n._trigger("headHtChanged")),e.htCont=a.height(),e.wdCont=a.width(),s.css("width",o),s.height(l.clientHeight),e.wdContLeft=s.width(),e.htContTop=0},setScrollLeft:function(e){var n=this.$cright;n&&this.scrollLeft!==e&&(this.scrollLeft=n[0].scrollLeft=e)},setWidth:function(e,n){this.$spacer.width(e-n)}}),function(e){var n=e.paramquery;(pq.cRenderHead=function(e,i){var r=e.options,o=this,a=o.uuid=e.uuid;o.that=e,o.iMerge=new n.cMergeHead(e),o.$ele=i,o.height="flex",o.scrollTop=0,o.rtl=r.rtl?"right":"left",o.rowHt=r.rowHtHead||28,o.cellCls="pq-grid-col",o.setTimer=o.setTimer(!0),o.cellPrefix="pq-head-cell-u"+a+"-",o.rowPrefix="pq-head-row-u"+a+"-",o.preInit(i),(e.$head_i=i.children(".pq-grid-cont")).on("click",o.onHeaderClick.bind(o)),e.on("headerKeyDown",o.onHeaderKeyDown.bind(o)).on("refreshHeader softRefresh",o.onRefresh.bind(o))}).prototype=e.extend({},pq.cRenderHS,n.mixHeader,n.mixHeaderFilter,{getRowClsStyleAttr:function(e){var n=this.that.headerCells.length,i="";return n==e?i="pq-grid-header-search-row":e==n-1&&(i="pq-grid-title-row"),[i,"",""]},getTblCls:function(e){var n="pq-grid-header-table";return e.hwrap?n:n+" pq-no-wrap"},isHead:function(){return!0},onRefreshTimer:function(e,n){return function(){var i=e.$cright[0];e.autoRow&&e.autoHeight({timer:!1,hChanged:n}),i.scrollTop=0,i.scrollLeft=i.scrollLeft,e.onCreateHeader(),e.refreshResizeColumn(),e.refreshHeaderSortIcons(),e.that._trigger("refreshHeadAsync")}},_resizeId:function(e){return"pq-resize-div-"+this.uuid+"-"+e},_resizeCls:function(){return"pq-resize-div-"+this.uuid},_resizeDiv:function(e){return this.getById(this._resizeId(e))},refreshResizeColumn:function(){var e,n,i,r=this.initH,o=this.colModel,a=this._resizeCls(),l=this.finalH,s=this.numberCell,d=this.freezeCols,c=[],u=[],h=s.show?-1:0;for(this.$ele.find("."+a).remove();h<=l;h++){if(r<=h)e=u;else{if(!(h<d))continue;e=c}(n=0<=h?o[h]:s).hidden||!1===n.resizable||this._resizeDiv(h)||(n=this.getLeft(h+1)-5,i=this._resizeId(h),e.push("<div id='",i,"' pq-col-indx='",h,"' style='",this.rtl,":",n,"px;'"," class='pq-grid-col-resize-handle "+a+"'>&nbsp;</div>"))}c.length&&this.$cleft.append(c.join("")),u.length&&this.$cright.append(u.join(""))},renderCell:function(e){var n=e.rowData,i=e.colIndx,r=e.attr,o=e.cls,a=e.style,n=n[i];return n?(1<n.colSpan&&a.push("z-index:3;"),e.column=n,this.createHeaderCell(e)):(n=this.renderFilterCell(e.column,i,o),"<div "+r+" class='"+o.join(" ")+"' style='"+a.join("")+"'>"+n+"</div>")}})}(jQuery),function(e){var n=e.paramquery;(pq.cRenderSum=function(e,n){var i=e.options,r=this,o=r.uuid=e.uuid;r.that=e,r.rtl=i.rtl?"right":"left",r.iMerge={ismergedCell:function(){}},r.$ele=n,r.height="flex",r.scrollTop=0,r.rowHt=i.rowHtSum||27,r.cellCls="pq-grid-cell",r.setTimer=r.setTimer(!0),r.cellPrefix="pq-sum-cell-u"+o+"-",r.rowPrefix="pq-sum-row-u"+o+"-",r.preInit(n),e.on("refreshSum softRefresh",r.onRefresh.bind(r))}).prototype=e.extend({},new n.cGenerateView,pq.cRenderHS,{isSum:function(){return!0},onRefreshTimer:function(e,n){return function(){var i=e.$cright[0];e.autoRow&&e.autoHeight({timer:!1,hChanged:n}),i.scrollTop=0,i.scrollLeft=i.scrollLeft}}})}(jQuery);